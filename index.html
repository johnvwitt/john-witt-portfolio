<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>John Witt | Portfolio</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Inter', sans-serif;
      background-color: #f4f4f8;
      color: #333;
      margin: 0;
      padding: 0;
      line-height: 1.6;
    }
    header {
      background-color: #0a0a23;
      color: #fff;
      padding: 2rem;
      text-align: center;
    }
    header h1 {
      margin: 0;
    }
    nav {
      display: flex;
      justify-content: center;
      background-color: #ddd;
      padding: 1rem;
      gap: 1.5rem;
    }
    nav a {
      color: #0a0a23;
      text-decoration: none;
      font-weight: bold;
      cursor: pointer;
    }
    main {
      max-width: 1000px;
      margin: auto;
      padding: 2rem;
    }
    section {
      display: none;
      margin-bottom: 3rem;
    }
    section.active {
      display: block;
    }
    h2 {
      border-bottom: 2px solid #ccc;
      padding-bottom: 0.3rem;
      color: #0a0a23;
    }
    .project-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 1.5rem;
      margin-top: 1rem;
    }
    .project-card, .gallery-icon {
      background: #fff;
      border: 1px solid #ddd;
      padding: 1rem;
      border-radius: 8px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.05);
      cursor: pointer;
      text-align: center;
    }
    .wide-card {
      grid-column: 1 / -1;
    }
    .modal {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      overflow: auto;
      background-color: rgba(0,0,0,0.6);
    }
    .modal-content {
      background-color: #fff;
      margin: 5% auto;
      padding: 2rem;
      border-radius: 8px;
      max-width: 90%;
      max-height: 80%;
      overflow-y: auto;
      box-shadow: 0 5px 15px rgba(0,0,0,0.3);
      position: relative;
    }
    .close {
      position: absolute;
      top: 10px;
      right: 20px;
      font-size: 1.5rem;
      color: #333;
      cursor: pointer;
    }
    .footer {
      text-align: center;
      padding: 2rem;
      font-size: 0.9rem;
      background: #eaeaea;
    }
    a {
      color: #0056b3;
      text-decoration: none;
    }
    pre {
      background: #f1f1f1;
      padding: 1rem;
      border-radius: 6px;
      overflow-x: auto;
    }
    .gallery-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
      gap: 1.5rem;
      margin-top: 2rem;
    }
    .gallery-icon img {
      width: 48px;
      height: 48px;
      margin-bottom: 0.5rem;
    }
.button {
  border: none;
  color: white;
  padding: 15px 32px;
  text-align: center;
  text-decoration: none;
  display: inline-block;
  font-size: 16px;
  margin: 4px 2px;
  cursor: pointer;
}

.button1 {background-color: #04AA6D;
	  color: white !important;
  	text-decoration: none;
	 }
a.button, a.button1 {
  color: white !important;
  text-decoration: none;
}
  </style>
</head>
<body>
  <header>
    <h1>John Witt</h1>
    <p>Business Systems Analyst | Aspiring Legal Professional | Literary Publisher</p>
  </header>

  <nav>
    <a onclick="showSection('featured')">Featured Work</a>
    <a onclick="showSection('about')">About</a>
    <a onclick="showSection('experience')">Experience and Education</a>
    <a onclick="showSection('gallery')">Gallery</a>
  </nav>

  <main>
    <section id="featured" class="active">
      <h2>Featured Work</h2>
      <div class="project-grid">
        <div class="project-card" onclick="openModal('audit')">
          <h3>Organizational Leadership</h3>
          <p>A perspective on leadership resulting from years of experience in a diverse range of fields.</p>
        </div>
        <div class="project-card" onclick="openModal('pivot')">
          <h3>SQL Spotlight</h3>
          <p>Three examples of advanced SQL utilization, to include a full-length professional report.</p>
        </div>
        <div class="project-card" onclick="openModal('essay')">
          <h3>Law School Writing Samples</h3>
          <p>Responses to select questions regarding my intention to pursue a career in law.</p>
        </div>
        <div class="project-card wide-card" onclick="openModal('nocturne')">
          <h3>Nocturne Verse</h3>
          <p>A literary journal exploring poetic and fictional storytelling in a moody, evocative aesthetic.</p>
        </div>
      </div>
    </section>

    <section id="about">
      <h2>About Me</h2>
      <h3>Proffessional Summary</h3>
      <p>I am a Business Systems Analyst with a strong foundation in benefits administration, compliance, and data-driven problem solving. With nearly a decade of supervisory experience in corrections and a background in intelligence analysis from my time in the U.S. Army, I bring a rare blend of discipline, analytical rigor, and practical leadership to every role I undertake. My current focus lies in streamlining systems through SQL-based reporting, requirements analysis, and benefit file accuracy. Simultaneously, I serve as the founder and editor of Nocturne Verse, a digital literary journal devoted to poetry and fiction. I am currently completing a BA at Texas Tech University, where I concentrate in Organizational Leadership, Psychology, and Political Science with a minor in Legal Studies. My long-term goal is to transition into law, where I can merge my technical acumen with a passion for justice and strategic reasoning.</p>
    <img src="JWSelfie.jpg" alt="One cool guy">
      <h3>History</h3>
      <p>Born and raised in rural East Texas, I was drawn early on to language, logic, and leadership. My career has unfolded through a series of immersive, demanding roles—beginning with service in the U.S. Army as a Cryptologic Linguist (35P) specializing in Russian. That experience honed my ability to interpret complex data under pressure, a skill I carried forward into an eight-year tenure as a correctional supervisor. There, I navigated the practical realities of institutional leadership, ethical discretion, and public service.

Seeking to apply those skills in a broader context, I transitioned into the private sector as a Business Systems Analyst. At Empyrean Benefit Solutions, I’ve led initiatives to improve data integrity, optimize benefit file exports, and support clients through collaborative system solutions. My work spans SQL development, regulatory interpretation, and business requirement documentation.

Parallel to my technical career, I’ve nurtured a lifelong love for literature. That passion found a home in Nocturne Verse, a digital journal I founded to publish poetry and fiction exploring themes of depth, loss, and transformation. I believe language—whether in SQL scripts or sonnets—is a tool for shaping the world we inhabit.

My academic journey reflects this dual path. At Texas Tech University, I’m completing a Bachelor of Arts in General Studies, with concentrations in Organizational Leadership, Psychology, and Political Science, alongside a minor in Legal Studies. With a 4.0 institutional GPA and a multidisciplinary mindset, I am now preparing for law school, where I aim to deepen my impact by advocating for clarity, justice, and human dignity.</p>
    </section>

    <section id="experience">
	    <a class="button button1" href="https://john-witt-portfolio.netlify.app/Witt_John_Resume.pdf" download>
  Download My Résumé (PDF)
</a>
      <h2>Professional Experience</h2>
      <h3>Business Systems Analyst – Empyrean Benefit Solutions</h3>
      <ul>
        <li>Defined, reviewed, and prioritized business requirements with stakeholders</li>
        <li>Produced data-driven solutions for benefit plan accuracy</li>
      </ul>
      <h3>Cryptologic Linguist – US Army</h3>
      <ul>
        <li>Interpreted foreign signals and communications with linguistic precision</li>
        <li>Specialized in Russian and analytical translation</li>
      </ul>
<h2>Education</h2>
      <p><strong>Texas Tech University</strong><br />General Studies AS-BGS/Minor in Legal Studies, 
	<br />Concentrations: Organizational Leadership, Political Science, Psychology
      <br />Jan 2024 - Aug 2025
      <br />Grade: 4.0 (Institution GPA)
      <br />Interdisciplinary degree combining social sciences, legal reasoning, and leadership theory to prepare for complex problem-solving in both corporate and legal environments.
      <br />Activities and societies: Sigma Tau Delta, Phi Alpha Delta, National Society of Leadership and Success, Philosophy Club
      </p>
<a class="button button1" href="https://john-witt-portfolio.netlify.app/JVW Unofficial Transcript 20250516.pdf" download>
  Download My TTU Transcripts (PDF)
</a>
	    
      <p><strong>Trinity Valley Community College</strong>
	      <br />AA in Business Administration
      		<br />Jan 2021 - Dec 2023
      		<br />Grade: 3.885 | Graduated Magna cum laude
      		<br />Completed foundational coursework in business, economics, and communication with a strong academic record. Gained a broad understanding of organizational operations, critical thinking, and professional communication.
      		<br />Activities and societies: Phi Theta Kappa, National Society of Leadership and Success
      </p>
	
<a class="button button1" href="https://john-witt-portfolio.netlify.app/Witt_John_Unofficial Transcript TVCC 6_1_2024.pdf" download>
  Download My TVCC Transcripts (PDF)
</a>
	    
    </section>

  
    <section id="gallery">
      <h2>Gallery of Work</h2>

   <h3>Legal Studies</h3>
  <div class="gallery-grid">
    <div class="gallery-icon" onclick="openModal('gallery_sample_6')">
      <img src="https://cdn-icons-png.flaticon.com/512/337/337946.png" alt="Doc Icon">
      <div>Case Brief - Johnson v SPC</div>
    </div>
    <div class="gallery-icon" onclick="openModal('gallery_sample_7')">
      <img src="https://cdn-icons-png.flaticon.com/512/337/337946.png" alt="Doc Icon">
      <div>Judicial Review Brief.docx</div>
    </div>
  </div>
      
      <h3>Political Science</h3>
  <div class="gallery-grid">
    <div class="gallery-icon" onclick="openModal('gallery_sample_5')">
      <img src="https://cdn-icons-png.flaticon.com/512/337/337946.png" alt="Doc Icon">
      <div>A Brief Analysis of Partisan Polarization</div>
    </div>
    <div class="gallery-icon" onclick="openModal('gallery_sample_4')">
      <img src="https://cdn-icons-png.flaticon.com/512/337/337946.png" alt="Doc Icon">
      <div>Reforming the Filibuster</div>
    </div>
  </div>

  <h3>Psychology</h3>
      <div class="gallery-grid">
        <div class="gallery-icon" onclick="openModal('gallery_sample_1')">
  <img src="https://cdn-icons-png.flaticon.com/512/337/337946.png" alt="Doc Icon">
  <div>Movie Case Report - The Father</div>
        </div>
         <div class="gallery-icon" onclick="openModal('gallery_sample_2')">
          <img src="https://cdn-icons-png.flaticon.com/512/337/337946.png" alt="Doc Icon">
          <div>Case Study - Anxiety</div>
        </div>
        <div class="gallery-icon" onclick="openModal('gallery_sample_3')">
          <img src="https://cdn-icons-png.flaticon.com/512/337/337946.png" alt="Doc Icon">
          <div>Case Study - Mood Disorders</div>
        </div>
      </div>
    </section>
  </main>

  <div class="modal" id="modal">
    <div class="modal-content">
      <span class="close" onclick="closeModal()">&times;</span>
      <div id="modal-body"></div>
    </div>
  </div>

  <div class="footer">
    &copy; 2025 John Witt | <a href="https://linkedin.com/in/johnvwitt1836" target="_blank">LinkedIn</a> | <a href="https://nocturne-verse.netlify.app" target="_blank">Nocturne Verse</a>
  </div>

  <script>
    const modal = document.getElementById('modal');
    const modalBody = document.getElementById('modal-body');

    const content = {
      audit: `<h3>Organizational Leadership</h3><p>How do you deal with conflict in the workplace? Read my perspective on the relationship between assertiveness, confrontation, leadership, ethical communication, and results.</p>` +
             `<iframe src="https://docs.google.com/gview?url=https://john-witt-portfolio.netlify.app/Reforming the Filibuster.pdf&embedded=true" width="100%" height="600px" style="border:none;"></iframe>`,

      pivot: `<h3>SQL Pivot & Attribute Join</h3><p>This example demonstrates advanced SQL logic using a pivoted attribute table with dynamic joins to streamline benefit reporting.</p>` +
             `<pre>SELECT\n    ev.SSN,\n    ATT.STATUS,\n    ATT.ACAFTPT,\n    ATT.ORIGINALHIREDATE,\n    ATT.CURRENTSALARY,\n    ATT.ELIGGROUP\n \nFROM EMPLOYEE_VIEW ev\n \nLEFT JOIN\n    (SELECT SSN,\n            EMPLOYEE_ATTRIBUTE_ID,\n            COALESCE(STRING_VALUE, CAST(NUMBER_VALUE AS VARCHAR(50)),CAST(FORMAT(DATE_VALUE, 'MM/dd/yyyy') AS VARCHAR(50))) AS VALUE\n        FROM EMPLOYEE_ATTRIBUTE_PROCESSED_VALUE_DETAIL_VIEW\n        WHERE TO_DATE = '9999-12-31') AS TBL\n    PIVOT(MAX(VALUE)\n        FOR EMPLOYEE_ATTRIBUTE_ID IN (STATUS, ACAFTPT, ORIGINALHIREDATE, CURRENTSALARY, ELIGGROUP)) AS ATT ON ATT.SSN = ev.SSN\n\nORDER BY 1;</pre>`+ 
            `<p>This example demonstrates advanced function logic at work.</p>`+
	      `<pre>WITH RankedEmployees AS (
    SELECT 
        ev.last_name AS 'Employee Last Name',
        ev.first_name AS 'Employee First Name',
        FORMAT(ev.birthdate, 'MM/dd/yyyy') AS 'Date of Birth',
        ev.employee_id AS 'Employee ID number',
        ad.Address_1 AS 'Street Address',
        COALESCE(ad.address_2, '') AS 'Street Address 2',
        ad.city AS 'City',
        ad.state AS 'State',
        ad.postal_code AS 'Zip Code',
        DATEDIFF(YEAR, ev.birthdate, GETDATE()) AS Age,
        ROW_NUMBER() OVER (PARTITION BY ev.employee_id ORDER BY ad.to_date DESC) AS RowNum
    FROM employee_view ev
    JOIN employee_address_detail_view ad
        ON ev.employee_uuid = ad.EMPLOYEE_UUID
    WHERE ad.State = 'MN'
)
SELECT 
    [Employee Last Name],
    [Employee First Name],
    [Date of Birth],
    [Employee ID number],
    [Street Address],
    [Street Address 2],
    [City],
    [State],
    [Zip Code]
FROM RankedEmployees
WHERE RowNum = 1
ORDER BY Age DESC; -- Sorting by age (oldest to youngest)</pre>`+
	    `<p>Finally, I have included a full-length SQL report I created that utilizes multiple complex joins and unions to produce a coverage file.</p>`+
        `<pre> declare @lookback int = 9

--TODO: ADD CDB LOGIC
--TODO: ADD IN RETIREE LOGIC (STARTED WITH DENTAL)

select top 10000
	
--EMPLOYEE RECORDS

LEFT(CONCAT('E', SPACE(1)), 1) AS [Transaction Code],
LEFT(CONCAT('5393668', SPACE(7)), 7) AS [Customer Number],
LEFT(CONCAT(ev.ssn, SPACE(11)), 11) AS [Employee Number],
LEFT(CONCAT('', SPACE(11)), 11) AS [Filler],
LEFT(CONCAT(ev.ssn, SPACE(9)), 9) AS [Member Social Security Number],
LEFT(CONCAT(ev.LAST_NAME, SPACE(20)), 20) AS [Member Last Name],
LEFT(CONCAT(ev.FIRST_NAME, SPACE(12)), 12) AS [Member First Name],
LEFT(CONCAT(ev.MIDDLE_NAME, SPACE(1)), 1) AS [Member Middle Initial],
LEFT(CONCAT(format(ev.BIRTHDATE, 'MMddyyyy'), SPACE(8)), 8) AS [Member Date of Birth],
LEFT(CONCAT('U', SPACE(1)), 1) AS [Member Marital Status],
LEFT(CONCAT(ev.sex, SPACE(1)), 1) AS [Member Gender],
LEFT(CONCAT('00', SPACE(2)), 2) AS [Relationship Code],
LEFT(CONCAT(FORMAT(ATT1.DATE_VALUE, 'MMddyyyy'), SPACE(8)), 8) AS [Employee's Date of Hire],
LEFT(CONCAT('', SPACE(11)), 11) AS [Personnel Identification],
LEFT(CONCAT('', SPACE(1)), 1) AS [Employee Smoker Code],
LEFT(CONCAT('', SPACE(1)), 1) AS [Spouse Smoker Code],
LEFT(CONCAT(ev.WORK_TELEPHONE, SPACE(10)), 10) AS [Phone Number],
LEFT(CONCAT(ev.EMAIL_ADDRESS, SPACE(40)), 40) AS [Email Address],
LEFT(CONCAT('', SPACE(14)), 14) AS [Filler],
LEFT(CONCAT('D', SPACE(1)), 1) AS [Foreign Address Indicator],
LEFT(CONCAT('', SPACE(32)), 32) AS [Care of Address],
LEFT(CONCAT(ad.ADDRESS_1, SPACE(32)), 32) AS [Street Address],
LEFT(CONCAT(AD.CITY, SPACE(21)), 21) AS [City],
LEFT(CONCAT(AD.STATE, SPACE(2)), 2) AS [State],
LEFT(CONCAT(LEFT(AD.POSTAL_CODE,5), SPACE(9)), 9) AS [Zip Code],

LEFT(CONCAT(CASE WHEN DENTAL.PLAN_ID IS NOT NULL THEN  'D' ELSE '' END, SPACE(2)), 2) AS [Coverage Code - 1],
LEFT(CONCAT(FORMAT(COALESCE(RETDENTAL.OPTION_FROM_DATE, DENTAL.OPTION_FROM_DATE), 'MMddyyyy'), SPACE(8)), 8) AS [Coverage Start Date - 1],
LEFT(CONCAT(CASE WHEN DENTAL.LAST_DAY_OF_COVERAGE < '9999-12-31' THEN FORMAT(DENTAL.LAST_DAY_OF_COVERAGE, 'MMddyyyy') else '' end, SPACE(8)), 8) AS [Coverage Stop Date - 1],
LEFT(CONCAT(CASE WHEN DENTAL.PLAN_ID IS NOT NULL THEN  '5393668'  ELSE '' END, SPACE(7)), 7) AS [Group Number - 1],
LEFT(CONCAT(CASE WHEN DENTAL.PLAN_ID IS  NULL THEN '' WHEN DENTAL.PLAN_ID IS NOT NULL THEN  '0001' ELSE '' END, SPACE(4)), 4) AS [Subcode - 1],
LEFT(CONCAT(CASE WHEN DENTAL.PLAN_ID IS  NULL THEN '' WHEN COALESCE(RETDENTAL.BENEFIT_ID, DENTAL.BENEFIT_ID) = 'RETDENTAL' THEN '0002' ELSE '0001' END, SPACE(4)), 4) AS [Branch - 1],
LEFT(CONCAT('', SPACE(2)), 2) AS [Plan Code - 1],
LEFT(CONCAT(CASE WHEN DENTAL.PLAN_ID IS  NULL THEN '' WHEN COALESCE(RETDENTAL.BENEFIT_ID, DENTAL.BENEFIT_ID) = 'RETDENTAL' THEN 'R' ELSE 'A' END, SPACE(1)), 1) AS [Status Code - 1],
LEFT(CONCAT(CASE WHEN COALESCE(RETDENTAL.TIER_OPTION_ID, DENTAL.TIER_OPTION_ID) = 'EEONLY' THEN '1'
					WHEN COALESCE(RETDENTAL.TIER_OPTION_ID, DENTAL.TIER_OPTION_ID) = 'EECHILD' THEN '2'
					WHEN COALESCE(RETDENTAL.TIER_OPTION_ID, DENTAL.TIER_OPTION_ID) = 'EESPOUSE' THEN '3'
					WHEN COALESCE(RETDENTAL.TIER_OPTION_ID, DENTAL.TIER_OPTION_ID) = 'EEFAMILY' THEN '4'
					ELSE COALESCE(RETDENTAL.TIER_OPTION_ID, DENTAL.TIER_OPTION_ID)
					END, SPACE(10)), 1) AS [Members Covered Code - 1],
LEFT(CONCAT('', SPACE(2)), 2) AS [Cancel Reason - 1],
LEFT(CONCAT('', SPACE(1)), 1) AS [Filler],
LEFT(CONCAT('', SPACE(8)), 8) AS [Facility ID],
LEFT(CONCAT('', SPACE(15)), 15) AS [Filler],

LEFT(CONCAT(CASE WHEN BASICLIFE.PLAN_ID IS NULL THEN '' ELSE 'CP' END, SPACE(2)), 2) AS [Coverage Code - 2],
LEFT(CONCAT(FORMAT(BASICLIFE.AMOUNT_FROM_DATE,'MMddyyyy'), SPACE(8)), 8) AS [Coverage Start Date - 2],
LEFT(CONCAT(CASE WHEN BASICLIFE.LAST_DAY_OF_COVERAGE < '9999-12-31' THEN FORMAT(BASICLIFE.LAST_DAY_OF_COVERAGE, 'MMddyyyy') else '' end, SPACE(8)), 8) AS [Coverage Stop Date - 2],
LEFT(CONCAT(CASE WHEN BASICLIFE.PLAN_ID IS NULL THEN '' ELSE '5393668' END, SPACE(7)), 7) AS [Group Number - 2],
LEFT(CONCAT(CASE WHEN BASICLIFE.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Subcode - 2],
LEFT(CONCAT(CASE WHEN BASICLIFE.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Branch - 2],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT(CASE WHEN BASICLIFE.PLAN_ID IS NULL THEN '' ELSE  'A' END, SPACE(1)), 1) AS [Status Code - 2],
LEFT(CONCAT(CASE WHEN BASICLIFE.PLAN_ID IS NULL THEN '' ELSE  '1' END, SPACE(1)), 1) AS [Members Covered Code - 2],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
RIGHT(CONCAT('0000000000',CAST(BASICLIFE.FINAL_BENEFIT_AMOUNT AS INT), CASE WHEN BASICLIFE.PLAN_ID IS NULL THEN '          ' ELSE '' END), 8) AS [Annual Benefit Amount - 2],
LEFT(CONCAT(CASE WHEN BASICLIFE.PLAN_ID IS NULL THEN '' ELSE  'A' END, SPACE(1)), 1) AS [Salary Mode - 2],
RIGHT(CONCAT('0000000000',CAST(ATT2.NUMBER_VALUE AS INT), CASE WHEN BASICLIFE.PLAN_ID IS NULL THEN '          ' ELSE '' END), 7) AS [Salary Amount - 2],

LEFT(CONCAT(CASE WHEN BASICADD.PLAN_ID IS NULL THEN '' ELSE  'AD' END, SPACE(2)), 2) AS [Coverage Code - 3],
LEFT(CONCAT(FORMAT(BASICADD.AMOUNT_FROM_DATE,'MMddyyyy'), SPACE(8)), 8) AS [Coverage Start Date - 3],
LEFT(CONCAT(CASE WHEN BASICADD.LAST_DAY_OF_COVERAGE < '9999-12-31' THEN FORMAT(BASICADD.LAST_DAY_OF_COVERAGE, 'MMddyyyy') else '' end, SPACE(8)), 8) AS [Coverage Stop Date - 3],
LEFT(CONCAT(CASE WHEN BASICADD.PLAN_ID IS NULL THEN '' ELSE '5393668' END, SPACE(7)), 7) AS [Group Number - 3],
LEFT(CONCAT(CASE WHEN BASICADD.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Subcode - 3],
LEFT(CONCAT(CASE WHEN BASICADD.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Branch - 3],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT(CASE WHEN BASICADD.PLAN_ID IS NULL THEN '' ELSE 'A' END, SPACE(1)), 1) AS [Status Code - 3],
LEFT(CONCAT(CASE WHEN BASICADD.PLAN_ID IS NULL THEN '' ELSE '1' END, SPACE(1)), 1) AS [Members Covered Code - 3],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
RIGHT(CONCAT('0000000000',CAST(BASICADD.FINAL_BENEFIT_AMOUNT AS INT), CASE WHEN BASICADD.PLAN_ID IS NULL THEN '          ' ELSE '' END), 8) AS [Annual Benefit Amount - 3],
LEFT(CONCAT(CASE WHEN BASICADD.PLAN_ID IS NULL THEN '' ELSE 'A' END, SPACE(1)), 1) AS [Salary Mode - 3],
RIGHT(CONCAT('0000000000',CAST(ATT2.NUMBER_VALUE AS INT), CASE WHEN BASICADD.PLAN_ID IS NULL THEN '          ' ELSE '' END), 7) AS [Salary Amount - 3],

LEFT(CONCAT(CASE WHEN LTD.PLAN_ID IS NULL THEN '' ELSE 'LT' END, SPACE(2)), 2) AS [Coverage Code - 4], --LTD
LEFT(CONCAT(FORMAT(LTD.PLAN_FROM_DATE,'MMddyyyy'), SPACE(8)), 8) AS [Coverage Start Date - 4],
LEFT(CONCAT(CASE WHEN LTD.LAST_DAY_OF_COVERAGE < '9999-12-31' THEN FORMAT(LTD.LAST_DAY_OF_COVERAGE, 'MMddyyyy') else '' end, SPACE(8)), 8) AS [Coverage Stop Date - 4],
LEFT(CONCAT(CASE WHEN LTD.PLAN_ID IS NULL THEN '' ELSE '5393668' END, SPACE(7)), 7) AS [Group Number - 4],
LEFT(CONCAT(CASE WHEN LTD.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Subcode - 4],
LEFT(CONCAT(CASE WHEN LTD.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Branch - 4],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT(CASE WHEN LTD.PLAN_ID IS NULL THEN '' ELSE 'A' END, SPACE(1)), 1) AS [Status Code - 4],
LEFT(CONCAT(CASE WHEN LTD.PLAN_ID IS NULL THEN '' ELSE '1' END, SPACE(1)), 1) AS [Members Covered Code - 4],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
RIGHT(CONCAT('0000000000',CAST(LTD.FINAL_BENEFIT_AMOUNT AS INT), CASE WHEN LTD.PLAN_ID IS NULL THEN '          ' ELSE '' END), 8) AS [Monthly Benefit Amount - 4],
LEFT(CONCAT(CASE WHEN LTD.PLAN_ID IS NULL THEN '' ELSE 'A' END, SPACE(1)), 1) AS [Salary Mode - 4],
RIGHT(CONCAT('0000000000',CAST(ATT2.NUMBER_VALUE AS INT), CASE WHEN LTD.PLAN_ID IS NULL THEN '          ' ELSE '' END), 7) AS [Salary Amount - 4],




LEFT(CONCAT(CASE WHEN STD.PLAN_ID IS NULL THEN '' ELSE 'AS' END, SPACE(2)), 2) AS [Coverage Code - 5], --STD
LEFT(CONCAT(FORMAT(STD.PLAN_FROM_DATE,'MMddyyyy'), SPACE(8)), 8) AS [Coverage Start Date - 5],
LEFT(CONCAT(CASE WHEN STD.LAST_DAY_OF_COVERAGE < '9999-12-31' THEN FORMAT(STD.LAST_DAY_OF_COVERAGE, 'MMddyyyy') else '' end, SPACE(8)), 8) AS [Coverage Stop Date - 5],
LEFT(CONCAT(CASE WHEN STD.PLAN_ID IS NULL THEN '' ELSE '318031' END, SPACE(7)), 7) AS [Group Number - 5],
LEFT(CONCAT(CASE WHEN STD.PLAN_ID IS NULL THEN '' ELSE '0002' END, SPACE(4)), 4) AS [Subcode - 5],
LEFT(CONCAT(CASE WHEN STD.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Branch - 5],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT(CASE WHEN STD.PLAN_ID IS NULL THEN '' ELSE 'A' END, SPACE(1)), 1) AS [Status Code - 5],
LEFT(CONCAT(CASE WHEN STD.PLAN_ID IS NULL THEN '' ELSE '1' END, SPACE(1)), 1) AS [Members Covered Code - 5],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
RIGHT(CONCAT('0000000000',CAST(ATT2.NUMBER_VALUE/52*.6 AS INT), CASE WHEN STD.PLAN_ID IS NULL THEN '          ' ELSE '' END), 8) AS [Weekly Benefit Amount - 5],--#todo: std benefit amount
LEFT(CONCAT(CASE WHEN STD.PLAN_ID IS NULL THEN '' ELSE 'A' END, SPACE(1)), 1) AS [Salary Mode - 5],
RIGHT(CONCAT( '0000000000',CASE WHEN STD.PLAN_ID IS NULL THEN '' ELSE CAST(ATT2.NUMBER_VALUE AS INT) END, CASE WHEN STD.PLAN_ID IS NULL THEN '          ' ELSE '' END), 7) AS [Salary Amount - 5],


LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 6],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 6],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 6],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 6],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 6],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 6],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT('', SPACE(1)), 1) AS [Status Code - 6],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 6],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
LEFT(CONCAT('', SPACE(8)), 8) AS [Annual Benefit Amount - 6],
LEFT(CONCAT('', SPACE(8)), 8) AS [Filler],

LEFT(CONCAT(CASE WHEN SUPPLIFE.PLAN_ID IS NULL THEN '' ELSE 'OP' END, SPACE(2)), 2) AS [Coverage Code - 7], --SUPPLIFE
LEFT(CONCAT(FORMAT(SUPPLIFE.PLAN_FROM_DATE,'MMddyyyy'), SPACE(8)), 8) AS [Coverage Start Date - 7],
LEFT(CONCAT(CASE WHEN SUPPLIFE.LAST_DAY_OF_COVERAGE < '9999-12-31' THEN FORMAT(SUPPLIFE.LAST_DAY_OF_COVERAGE, 'MMddyyyy') else '' end, SPACE(8)), 8) AS [Coverage Stop Date - 7],
LEFT(CONCAT(CASE WHEN SUPPLIFE.PLAN_ID IS NULL THEN '' ELSE '5393668' END, SPACE(7)), 7) AS [Group Number - 7],
LEFT(CONCAT(CASE WHEN SUPPLIFE.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Subcode - 7],
LEFT(CONCAT(CASE WHEN SUPPLIFE.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Branch - 7],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT(CASE WHEN SUPPLIFE.PLAN_ID IS NULL THEN '' ELSE 'A' END, SPACE(1)), 1) AS [Status Code - 7],
LEFT(CONCAT(CASE WHEN SUPPLIFE.PLAN_ID IS NULL THEN '' ELSE '1' END, SPACE(1)), 1) AS [Members Covered Code - 7],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
RIGHT(CONCAT('0000000000',CAST(SUPPLIFE.FINAL_BENEFIT_AMOUNT AS INT), CASE WHEN SUPPLIFE.PLAN_ID IS NULL THEN '          ' ELSE '' END), 8) AS [Annual Benefit Amount - 7],
LEFT(CONCAT(CASE WHEN SUPPLIFE.PLAN_ID IS NULL THEN '' ELSE 'A' END, SPACE(1)), 1) AS [Salary Mode - 7],
RIGHT(CONCAT('0000000000',CAST(ATT2.NUMBER_VALUE AS INT), CASE WHEN SUPPLIFE.PLAN_ID IS NULL THEN '          ' ELSE '' END), 7) AS [Salary Amount - 7],

LEFT(CONCAT(CASE WHEN SPOUSELIFE.PLAN_ID IS NULL THEN '' ELSE 'LZ' END, SPACE(2)), 2) AS [Coverage Code - 8], --SPOUSELIFE
LEFT(CONCAT(FORMAT(SPOUSELIFE.PLAN_FROM_DATE,'MMddyyyy'), SPACE(8)), 8) AS [Coverage Start Date - 8],
LEFT(CONCAT(CASE WHEN SPOUSELIFE.LAST_DAY_OF_COVERAGE < '9999-12-31' THEN FORMAT(SPOUSELIFE.LAST_DAY_OF_COVERAGE, 'MMddyyyy') else '' end, SPACE(8)), 8) AS [Coverage Stop Date - 8],
LEFT(CONCAT(CASE WHEN SPOUSELIFE.PLAN_ID IS NULL THEN '' ELSE '5393668' END, SPACE(7)), 7) AS [Group Number - 8],
LEFT(CONCAT(CASE WHEN SPOUSELIFE.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Subcode - 8],
LEFT(CONCAT(CASE WHEN SPOUSELIFE.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Branch - 8],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT(CASE WHEN SPOUSELIFE.PLAN_ID IS NULL THEN '' ELSE 'A' END, SPACE(1)), 1) AS [Status Code - 8],
LEFT(CONCAT(CASE WHEN SPOUSELIFE.PLAN_ID IS NULL THEN '' ELSE 'A' END, SPACE(1)), 1) AS [Members Covered Code - 8],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
RIGHT(CONCAT('0000000000',CAST(SPOUSELIFE.FINAL_BENEFIT_AMOUNT AS INT), CASE WHEN SPOUSELIFE.PLAN_ID IS NULL THEN '          ' ELSE '' END), 8) AS [Annual Benefit Amount - 8],
LEFT(CONCAT('', SPACE(8)), 8) AS [Filler],

LEFT(CONCAT(CASE WHEN CHILDLIFE.PLAN_ID IS NULL THEN '' ELSE 'LF' END, SPACE(2)), 2) AS [Coverage Code - 9], --CHILDLIFE
LEFT(CONCAT(FORMAT(CHILDLIFE.PLAN_FROM_DATE,'MMddyyyy'), SPACE(8)), 8) AS [Coverage Start Date - 9],
LEFT(CONCAT(CASE WHEN CHILDLIFE.LAST_DAY_OF_COVERAGE < '9999-12-31' THEN FORMAT(CHILDLIFE.LAST_DAY_OF_COVERAGE, 'MMddyyyy') else '' end, SPACE(8)), 8) AS [Coverage Stop Date - 9],
LEFT(CONCAT(CASE WHEN CHILDLIFE.PLAN_ID IS NULL THEN '' ELSE '5393668' END, SPACE(7)), 7) AS [Group Number - 9],
LEFT(CONCAT(CASE WHEN CHILDLIFE.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Subcode - 9],
LEFT(CONCAT(CASE WHEN CHILDLIFE.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Branch - 9],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT(CASE WHEN CHILDLIFE.PLAN_ID IS NULL THEN '' ELSE 'A' END, SPACE(1)), 1) AS [Status Code - 9],
LEFT(CONCAT(CASE WHEN CHILDLIFE.PLAN_ID IS NULL THEN '' ELSE 'C' END, SPACE(1)), 1) AS [Members Covered Code - 9],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
RIGHT(CONCAT('0000000000',CAST(CHILDLIFE.FINAL_BENEFIT_AMOUNT AS INT), CASE WHEN CHILDLIFE.PLAN_ID IS NULL THEN '          ' ELSE '' END), 8) AS [Annual Benefit Amount - 9],
LEFT(CONCAT('', SPACE(8)), 8) AS [Filler],

LEFT(CONCAT(CASE WHEN SUPPADD.PLAN_ID IS NULL THEN '' ELSE 'OD' END, SPACE(2)), 2) AS [Coverage Code - 10], --SUPPADD
LEFT(CONCAT(FORMAT(SUPPADD.PLAN_FROM_DATE,'MMddyyyy'), SPACE(8)), 8) AS [Coverage Start Date - 10],
LEFT(CONCAT(CASE WHEN SUPPADD.LAST_DAY_OF_COVERAGE < '9999-12-31' THEN FORMAT(SUPPADD.LAST_DAY_OF_COVERAGE, 'MMddyyyy') else '' end, SPACE(8)), 8) AS [Coverage Stop Date - 10],
LEFT(CONCAT(CASE WHEN SUPPADD.PLAN_ID IS NULL THEN '' ELSE '5393668' END, SPACE(7)), 7) AS [Group Number - 10],
LEFT(CONCAT(CASE WHEN SUPPADD.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Subcode - 10],
LEFT(CONCAT(CASE WHEN SUPPADD.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Branch - 10],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT(CASE WHEN SUPPADD.PLAN_ID IS NULL THEN '' ELSE 'A' END, SPACE(1)), 1) AS [Status Code - 10],
LEFT(CONCAT(CASE WHEN SUPPADD.PLAN_ID IS NULL THEN '' ELSE '1' END, SPACE(1)), 1) AS [Members Covered Code - 10],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
RIGHT(CONCAT('0000000000',CAST(SUPPADD.FINAL_BENEFIT_AMOUNT AS INT), CASE WHEN SUPPADD.PLAN_ID IS NULL THEN '          ' ELSE '' END), 8) AS [Annual Benefit Amount - 10],
LEFT(CONCAT(CASE WHEN SUPPADD.PLAN_ID IS NULL THEN '' ELSE 'A' END, SPACE(1)), 1) AS [Salary Mode - 10],
RIGHT(CONCAT('0000000000',CAST(ATT2.NUMBER_VALUE AS INT), CASE WHEN SUPPADD.PLAN_ID IS NULL THEN '          ' ELSE '' END), 7) AS [Salary Amount - 10],

LEFT(CONCAT(CASE WHEN SPSUPPADD.PLAN_ID IS NULL THEN '' ELSE 'AE' END, SPACE(2)), 2) AS [Coverage Code - 11], --SPSUPPADD
LEFT(CONCAT(FORMAT(SPSUPPADD.PLAN_FROM_DATE,'MMddyyyy'), SPACE(8)), 8) AS [Coverage Start Date - 11],
LEFT(CONCAT(CASE WHEN SPSUPPADD.LAST_DAY_OF_COVERAGE < '9999-12-31' THEN FORMAT(SPSUPPADD.LAST_DAY_OF_COVERAGE, 'MMddyyyy') else '' end, SPACE(8)), 8) AS [Coverage Stop Date - 11],
LEFT(CONCAT(CASE WHEN SPSUPPADD.PLAN_ID IS NULL THEN '' ELSE '5393668' END, SPACE(7)), 7) AS [Group Number - 11],
LEFT(CONCAT(CASE WHEN SPSUPPADD.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Subcode - 11],
LEFT(CONCAT(CASE WHEN SPSUPPADD.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Branch - 11],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT(CASE WHEN SPSUPPADD.PLAN_ID IS NULL THEN '' ELSE 'A' END, SPACE(1)), 1) AS [Status Code - 11],
LEFT(CONCAT(CASE WHEN SPSUPPADD.PLAN_ID IS NULL THEN '' ELSE 'A' END, SPACE(1)), 1) AS [Members Covered Code - 11],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
RIGHT(CONCAT('0000000000',CAST(SPSUPPADD.FINAL_BENEFIT_AMOUNT AS INT), CASE WHEN SPSUPPADD.PLAN_ID IS NULL THEN '          ' ELSE '' END), 8) AS [Annual Benefit Amount - 11],
LEFT(CONCAT('', SPACE(8)), 8) AS [Filler],

LEFT(CONCAT(CASE WHEN CHILDADD.PLAN_ID IS NULL THEN '' ELSE 'AT' END, SPACE(2)), 2) AS [Coverage Code - 12], -- CHILDADD
LEFT(CONCAT(FORMAT(CHILDADD.PLAN_FROM_DATE,'MMddyyyy'), SPACE(8)), 8) AS [Coverage Start Date - 12],
LEFT(CONCAT(CASE WHEN CHILDADD.LAST_DAY_OF_COVERAGE < '9999-12-31' THEN FORMAT(CHILDADD.LAST_DAY_OF_COVERAGE, 'MMddyyyy') else '' end, SPACE(8)), 8) AS [Coverage Stop Date - 12],
LEFT(CONCAT(CASE WHEN CHILDADD.PLAN_ID IS NULL THEN '' ELSE '5393668' END, SPACE(7)), 7) AS [Group Number - 12],
LEFT(CONCAT(CASE WHEN CHILDADD.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Subcode - 12],
LEFT(CONCAT(CASE WHEN CHILDADD.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Branch - 12],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT(CASE WHEN CHILDADD.PLAN_ID IS NULL THEN '' ELSE 'A' END, SPACE(1)), 1) AS [Status Code - 12],
LEFT(CONCAT(CASE WHEN CHILDADD.PLAN_ID IS NULL THEN '' ELSE 'C' END, SPACE(1)), 1) AS [Members Covered Code - 12],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
RIGHT(CONCAT('0000000000',CAST(CHILDADD.FINAL_BENEFIT_AMOUNT AS INT), CASE WHEN CHILDADD.PLAN_ID IS NULL THEN '          ' ELSE '' END), 8) AS [Annual Benefit Amount - 12],
LEFT(CONCAT('', SPACE(8)), 8) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 13],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 13],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 13],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 13],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 13],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 13],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT('', SPACE(1)), 1) AS [Status Code - 13],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 13],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
LEFT(CONCAT('', SPACE(8)), 8) AS [Annual Benefit Amount - 13],
LEFT(CONCAT('', SPACE(8)), 8) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 14],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 14],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 14],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 14],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 14],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 14],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT('', SPACE(1)), 1) AS [Status Code - 14],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 14],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
LEFT(CONCAT('', SPACE(8)), 8) AS [Annual Benefit Amount - 14],
LEFT(CONCAT('', SPACE(11)), 11) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 15],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 15],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 15],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 15],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 15],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 15],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT('', SPACE(1)), 1) AS [Status Code - 15],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 15],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
LEFT(CONCAT('', SPACE(8)), 8) AS [Annual Benefit Amount - 15],
LEFT(CONCAT('', SPACE(8)), 8) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 16],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 16],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 16],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 16],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 16],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 16],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT('', SPACE(1)), 1) AS [Status Code - 16],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 16],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
LEFT(CONCAT('', SPACE(8)), 8) AS [Annual Benefit Amount - 16],
LEFT(CONCAT('', SPACE(8)), 8) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 17],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 17],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 17],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 17],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 17],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 17],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT('', SPACE(1)), 1) AS [Status Code - 17],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 17],
LEFT(CONCAT('', SPACE(2)), 2) AS [Cancel Reason - 17],
LEFT(CONCAT('', SPACE(23)), 23) AS [Filler],

LEFT(CONCAT('', SPACE(1)), 1) AS [Employee Status Code],
LEFT(CONCAT('', SPACE(8)), 8) AS [Status Code Effective Date],
LEFT(CONCAT('', SPACE(10)), 10) AS [Department Code],
LEFT(CONCAT('', SPACE(10)), 10) AS [Group ID],
LEFT(CONCAT('', SPACE(5)), 5) AS [Location ID],
LEFT(CONCAT('', SPACE(10)), 10) AS [Schedule ID],
LEFT(CONCAT('', SPACE(2)), 2) AS [Pay Frequency],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 18],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 18],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 18],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 18],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 18],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 18],
LEFT(CONCAT('', SPACE(1)), 1) AS [Status Code - 18],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 18],
LEFT(CONCAT('', SPACE(1)), 1) AS [Enrollment Status - 18],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 19],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 19],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 19],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 19],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 19],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 19],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 19],
LEFT(CONCAT('', SPACE(1)), 1) AS [Enrollment Status - 19],
LEFT(CONCAT('', SPACE(8)), 8) AS [Benefit Amount - 19],
LEFT(CONCAT('', SPACE(2)), 2) AS [Voluntary Cancellation Ind - 19],
LEFT(CONCAT('', SPACE(1)), 1) AS [Taveover Indicator - 19],
LEFT(CONCAT('', SPACE(9)), 9) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 20],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 20],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 20],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 20],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 20],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 20],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 20],
LEFT(CONCAT('', SPACE(1)), 1) AS [Enrollment Status - 20],
LEFT(CONCAT('', SPACE(8)), 8) AS [Benefit Amount - 20],
LEFT(CONCAT('', SPACE(2)), 2) AS [Voluntary Cancellation Ind - 20],
LEFT(CONCAT('', SPACE(8)), 8) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 21],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 21],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 21],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 21],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 21],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 21],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 21],
LEFT(CONCAT('', SPACE(1)), 1) AS [Enrollment Status - 21],
LEFT(CONCAT('', SPACE(3)), 3) AS [GPC Code],
LEFT(CONCAT('', SPACE(2)), 2) AS [Paypoint],
LEFT(CONCAT('', SPACE(3)), 3) AS [Payroll Deduction],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 22],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 22],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 22],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 22],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 22],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 22],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 22],
LEFT(CONCAT('', SPACE(1)), 1) AS [Enrollment Status - 22],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 23],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 23],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 23],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 23],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 23],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 23],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 23],
LEFT(CONCAT('', SPACE(1)), 1) AS [Enrollment Status - 23],
LEFT(CONCAT('', SPACE(2)), 2) AS [Voluntary Cancellation Ind - 23],
LEFT(CONCAT('', SPACE(1)), 1) AS [Takeover Indicator - 23],
LEFT(CONCAT('', SPACE(9)), 9) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 24],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 24],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 24],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 24],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 24],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 24],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 24],
LEFT(CONCAT('', SPACE(1)), 1) AS [Enrollment Status - 24],
LEFT(CONCAT('', SPACE(2)), 2) AS [Voluntary Cancellation Ind - 24],
LEFT(CONCAT('', SPACE(1)), 1) AS [Takeover Indicator - 24],
LEFT(CONCAT('', SPACE(9)), 9) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 25],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 25],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 25],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 25],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 25],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 25],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 25],
LEFT(CONCAT('', SPACE(1)), 1) AS [Enrollment Status - 25],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],

LEFT(CONCAT('', SPACE(95)), 95) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 27],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 27],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 27],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 27],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 27],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 27],
LEFT(CONCAT('', SPACE(1)), 1) AS [Status Code - 27],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 27],
LEFT(CONCAT('', SPACE(8)), 8) AS [Benefit Amount - 27],
LEFT(CONCAT('', SPACE(1)), 1) AS [Takeover Indicator - 27],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 28],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 28],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 28],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 28],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 28],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 28],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 28],
LEFT(CONCAT('', SPACE(1)), 1) AS [Enrollment Status - 28],
LEFT(CONCAT('', SPACE(8)), 8) AS [Benefit Amount - 28],
LEFT(CONCAT('', SPACE(2)), 2) AS [Voluntary Cancellation Ind - 28],
LEFT(CONCAT('', SPACE(1)), 1) AS [Takeover Indicator - 28],
LEFT(CONCAT('', SPACE(9)), 9) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 29],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 29],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 29],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 29],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 29],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 29],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 29],
LEFT(CONCAT('', SPACE(1)), 1) AS [Enrollment Status - 29],
LEFT(CONCAT('', SPACE(8)), 8) AS [Benefit Amount - 29],
LEFT(CONCAT('', SPACE(2)), 2) AS [Voluntary Cancellation Ind - 29],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 30],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 30],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 30],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 30],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 30],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 30],
LEFT(CONCAT('', SPACE(2)), 2) AS [Work State - 30],
LEFT(CONCAT('', SPACE(1)), 1) AS [Job Status Code (full time/part time indicator)],
LEFT(CONCAT('', SPACE(8)), 8) AS [Job Status (full time/part time) As of Date ]


FROM EMPLOYEE_VIEW EV
INNER JOIN EMPLOYEE_ADDRESS_DETAIL_VIEW AD
	ON AD.IS_PRIMARY = 'Y'
	AND AD.TO_DATE = '9999-12-31'
	AND AD.EMPLOYEE_UUID = EV.EMPLOYEE_UUID
LEFT JOIN EMPLOYEE_COVERAGE_COMBINED_VIEW DENTAL
	on ev.EMPLOYEE_UUID = DENTAL.EMPLOYEE_UUID
	AND DENTAL.BENEFIT_ID = 'DENTAL'
	AND DENTAL.PLAN_ID NOT IN  ('WAIVE' , 'OPTOUT')
	AND (DENTAL.TO_DATE = '9999-12-31'
		OR (DENTAL.OPTION_CREATE_TRANSACTION_DATE > getdate() - @lookback
			AND (DENTAL.TO_DATE = (SELECT MAX(TO_DATE) FROM EMPLOYEE_COVERAGE_COMBINED_VIEW SUBCOV WHERE SUBCOV.EMPLOYEE_UUID = EV.EMPLOYEE_UUID AND SUBCOV.BENEFIT_UUID = DENTAL.BENEFIT_UUID))))
LEFT JOIN EMPLOYEE_COVERAGE_COMBINED_VIEW RETDENTAL
	on ev.EMPLOYEE_UUID = RETDENTAL.EMPLOYEE_UUID
	AND RETDENTAL.BENEFIT_ID = 'XXXX'
	AND RETDENTAL.PLAN_ID != 'WAIVE' 
	AND (RETDENTAL.TO_DATE = '1999-12-31'
		OR (RETDENTAL.OPTION_CREATE_TRANSACTION_DATE > getdate() - @lookback
			AND (RETDENTAL.TO_DATE = (SELECT MAX(TO_DATE) FROM EMPLOYEE_COVERAGE_COMBINED_VIEW SUBCOV WHERE SUBCOV.EMPLOYEE_UUID = EV.EMPLOYEE_UUID AND SUBCOV.BENEFIT_UUID = RETDENTAL.BENEFIT_UUID))))
LEFT JOIN EMPLOYEE_COVERAGE_COMBINED_VIEW BASICADD
	on ev.EMPLOYEE_UUID = BASICADD.EMPLOYEE_UUID
	AND BASICADD.BENEFIT_ID = 'BASICADD'
	AND BASICADD.PLAN_ID != 'WAIVE' 
	AND (BASICADD.TO_DATE = '9999-12-31'
		OR (BASICADD.OPTION_CREATE_TRANSACTION_DATE > getdate() - @lookback
			AND (BASICADD.TO_DATE = (SELECT MAX(TO_DATE) FROM EMPLOYEE_COVERAGE_COMBINED_VIEW SUBCOV WHERE SUBCOV.EMPLOYEE_UUID = EV.EMPLOYEE_UUID AND SUBCOV.BENEFIT_UUID = BASICADD.BENEFIT_UUID))))
LEFT JOIN EMPLOYEE_COVERAGE_COMBINED_VIEW SPSUPPADD
	on ev.EMPLOYEE_UUID = SPSUPPADD.EMPLOYEE_UUID
	AND SPSUPPADD.BENEFIT_ID = 'SPSUPPADD'
	AND SPSUPPADD.PLAN_ID != 'WAIVE' 
	AND (SPSUPPADD.TO_DATE = '9999-12-31'
		OR (SPSUPPADD.OPTION_CREATE_TRANSACTION_DATE > getdate() - @lookback
			AND (SPSUPPADD.TO_DATE = (SELECT MAX(TO_DATE) FROM EMPLOYEE_COVERAGE_COMBINED_VIEW SUBCOV WHERE SUBCOV.EMPLOYEE_UUID = EV.EMPLOYEE_UUID AND SUBCOV.BENEFIT_UUID = SPSUPPADD.BENEFIT_UUID))))
LEFT JOIN EMPLOYEE_COVERAGE_COMBINED_VIEW CHILDADD
	on ev.EMPLOYEE_UUID = CHILDADD.EMPLOYEE_UUID
	AND CHILDADD.BENEFIT_ID = 'CHILDADD'
	AND CHILDADD.PLAN_ID != 'WAIVE' 
	AND (CHILDADD.TO_DATE = '9999-12-31'
		OR (CHILDADD.OPTION_CREATE_TRANSACTION_DATE > getdate() - @lookback
			AND (CHILDADD.TO_DATE = (SELECT MAX(TO_DATE) FROM EMPLOYEE_COVERAGE_COMBINED_VIEW SUBCOV WHERE SUBCOV.EMPLOYEE_UUID = EV.EMPLOYEE_UUID AND SUBCOV.BENEFIT_UUID = CHILDADD.BENEFIT_UUID))))
LEFT JOIN EMPLOYEE_COVERAGE_COMBINED_VIEW SUPPADD
	on ev.EMPLOYEE_UUID = SUPPADD.EMPLOYEE_UUID
	AND SUPPADD.BENEFIT_ID = 'SUPPADD'
	AND SUPPADD.PLAN_ID != 'WAIVE' 
	AND (SUPPADD.TO_DATE = '9999-12-31'
		OR (SUPPADD.OPTION_CREATE_TRANSACTION_DATE > getdate() - @lookback
			AND (SUPPADD.TO_DATE = (SELECT MAX(TO_DATE) FROM EMPLOYEE_COVERAGE_COMBINED_VIEW SUBCOV WHERE SUBCOV.EMPLOYEE_UUID = EV.EMPLOYEE_UUID AND SUBCOV.BENEFIT_UUID = SUPPADD.BENEFIT_UUID))))
LEFT JOIN EMPLOYEE_COVERAGE_COMBINED_VIEW LTD
	on ev.EMPLOYEE_UUID = LTD.EMPLOYEE_UUID
	AND LTD.BENEFIT_ID = 'LTD'
	AND LTD.PLAN_ID != 'WAIVE' 
	AND (LTD.TO_DATE = '9999-12-31'
		OR (LTD.OPTION_CREATE_TRANSACTION_DATE > getdate() - @lookback
			AND (LTD.TO_DATE = (SELECT MAX(TO_DATE) FROM EMPLOYEE_COVERAGE_COMBINED_VIEW SUBCOV WHERE SUBCOV.EMPLOYEE_UUID = EV.EMPLOYEE_UUID AND SUBCOV.BENEFIT_UUID = LTD.BENEFIT_UUID))))
LEFT JOIN EMPLOYEE_COVERAGE_COMBINED_VIEW BASICLIFE
	on ev.EMPLOYEE_UUID = BASICLIFE.EMPLOYEE_UUID
	AND BASICLIFE.BENEFIT_ID = 'BASICLIFE'
	AND BASICLIFE.PLAN_ID != 'WAIVE' 
	AND (BASICLIFE.TO_DATE = '9999-12-31' OR (BASICLIFE.TO_DATE != '9999-12-31' and BASICLIFE.OPTION_CREATE_TRANSACTION_DATE > getdate() - @lookback))
	AND (BASICLIFE.TO_DATE = (SELECT MAX(TO_DATE) FROM EMPLOYEE_COVERAGE_COMBINED_VIEW SUBCOV WHERE SUBCOV.EMPLOYEE_UUID = EV.EMPLOYEE_UUID AND SUBCOV.BENEFIT_UUID = BASICLIFE.BENEFIT_UUID))
LEFT JOIN EMPLOYEE_COVERAGE_COMBINED_VIEW SPOUSELIFE
	on ev.EMPLOYEE_UUID = SPOUSELIFE.EMPLOYEE_UUID
	AND SPOUSELIFE.BENEFIT_ID = 'SPOUSELIFE'
	AND SPOUSELIFE.PLAN_ID != 'WAIVE' 
	AND (SPOUSELIFE.TO_DATE = '9999-12-31' OR (SPOUSELIFE.OPTION_CREATE_TRANSACTION_DATE > getdate() - @lookback))
	AND (SPOUSELIFE.TO_DATE = (SELECT MAX(TO_DATE) FROM EMPLOYEE_COVERAGE_COMBINED_VIEW SUBCOV WHERE SUBCOV.EMPLOYEE_UUID = EV.EMPLOYEE_UUID AND SUBCOV.BENEFIT_UUID = SPOUSELIFE.BENEFIT_UUID))
LEFT JOIN EMPLOYEE_COVERAGE_COMBINED_VIEW CHILDLIFE
	on ev.EMPLOYEE_UUID = CHILDLIFE.EMPLOYEE_UUID
	AND CHILDLIFE.BENEFIT_ID = 'CHILDLIFE'
	AND CHILDLIFE.PLAN_ID != 'WAIVE' 
	AND (CHILDLIFE.TO_DATE = '9999-12-31'
		OR (CHILDLIFE.OPTION_CREATE_TRANSACTION_DATE > getdate() - @lookback
			AND (CHILDLIFE.TO_DATE = (SELECT MAX(TO_DATE) FROM EMPLOYEE_COVERAGE_COMBINED_VIEW SUBCOV WHERE SUBCOV.EMPLOYEE_UUID = EV.EMPLOYEE_UUID AND SUBCOV.BENEFIT_UUID = CHILDLIFE.BENEFIT_UUID))))
LEFT JOIN EMPLOYEE_COVERAGE_COMBINED_VIEW SUPPLIFE
	on ev.EMPLOYEE_UUID = SUPPLIFE.EMPLOYEE_UUID
	AND SUPPLIFE.BENEFIT_ID = 'SUPPLIFE'
	AND SUPPLIFE.PLAN_ID != 'WAIVE' 
	AND (SUPPLIFE.TO_DATE = '9999-12-31'
		OR (SUPPLIFE.OPTION_CREATE_TRANSACTION_DATE > getdate() - @lookback
			AND (SUPPLIFE.TO_DATE = (SELECT MAX(TO_DATE) FROM EMPLOYEE_COVERAGE_COMBINED_VIEW SUBCOV WHERE SUBCOV.EMPLOYEE_UUID = EV.EMPLOYEE_UUID AND SUBCOV.BENEFIT_UUID = SUPPLIFE.BENEFIT_UUID))))
LEFT JOIN EMPLOYEE_COVERAGE_COMBINED_VIEW STD
	on ev.EMPLOYEE_UUID = STD.EMPLOYEE_UUID
	AND STD.BENEFIT_ID = 'STD'
	AND STD.PLAN_ID != 'WAIVE' 
	AND (STD.TO_DATE = '9999-12-31'
		OR (STD.OPTION_CREATE_TRANSACTION_DATE > getdate() - @lookback
			AND (STD.TO_DATE = (SELECT MAX(TO_DATE) FROM EMPLOYEE_COVERAGE_COMBINED_VIEW SUBCOV WHERE SUBCOV.EMPLOYEE_UUID = EV.EMPLOYEE_UUID AND SUBCOV.BENEFIT_UUID = STD.BENEFIT_UUID))))

LEFT JOIN EMPLOYEE_ATTRIBUTE_PROCESSED_VALUE_DETAIL_VIEW ATT1
	ON ATT1.EMPLOYEE_UUID = EV.EMPLOYEE_UUID
	AND ATT1.EMPLOYEE_ATTRIBUTE_ID = 'latesthredate'
	AND ATT1.TO_DATE = '9999-12-31'

LEFT JOIN EMPLOYEE_ATTRIBUTE_PROCESSED_VALUE_DETAIL_VIEW ATT2
	ON ATT2.EMPLOYEE_UUID = EV.EMPLOYEE_UUID
	AND ATT2.EMPLOYEE_ATTRIBUTE_ID = 'CURRENTSALARY'
	AND ATT2.TO_DATE = '9999-12-31'

LEFT JOIN EMPLOYEE_ATTRIBUTE_PROCESSED_VALUE_DETAIL_VIEW ATT3
	ON ATT3.EMPLOYEE_UUID = EV.EMPLOYEE_UUID
	AND ATT3.EMPLOYEE_ATTRIBUTE_ID = ''
	AND ATT3.TO_DATE = '9999-12-31'

LEFT JOIN EMPLOYEE_ATTRIBUTE_PROCESSED_VALUE_DETAIL_VIEW ATT4
	ON ATT4.EMPLOYEE_UUID = EV.EMPLOYEE_UUID
	AND ATT4.EMPLOYEE_ATTRIBUTE_ID = ''
	AND ATT4.TO_DATE = '9999-12-31'

LEFT JOIN EMPLOYEE_ATTRIBUTE_PROCESSED_VALUE_DETAIL_VIEW ATT5
	ON ATT5.EMPLOYEE_UUID = EV.EMPLOYEE_UUID
	AND ATT5.EMPLOYEE_ATTRIBUTE_ID = ''
	AND ATT5.TO_DATE = '9999-12-31'

LEFT JOIN EMPLOYEE_ATTRIBUTE_PROCESSED_VALUE_DETAIL_VIEW ATT6
	ON ATT6.EMPLOYEE_UUID = EV.EMPLOYEE_UUID
	AND ATT6.EMPLOYEE_ATTRIBUTE_ID = ''
	AND ATT6.TO_DATE = '9999-12-31'



where 1=1
and (dental.ssn is not null
	or RETDENTAL.ssn is not null
	or SPSUPPADD.ssn is not null
	or basicadd.ssn is not null
	or childadd.ssn is not null
	or suppadd.SSN is not null
	or ltd.SSN is not null
	or basiclife.SSN is not null
	or spouselife.SSN is not null
	or childlife.SSN is not null
	or supplife.SSN is not null
	or std.SSN is not null
)
and ev.EMPLOYEE_UUID not in (select EMPLOYEE_UUID from EMPLOYEE_ATTRIBUTE_PROCESSED_VALUE_DETAIL_VIEW where to_date = '9999-12-31' and EMPLOYEE_ATTRIBUTE_ID = 'retiree' and STRING_VALUE = 'y')

union all

select DISTINCT top 10000
	
--DEPENDENT RECORDS

LEFT(CONCAT('D', SPACE(1)), 1) AS [Transaction Code],
LEFT(CONCAT('5393668', SPACE(7)), 7) AS [Customer Number],
LEFT(CONCAT(ev.ssn, SPACE(11)), 11) AS [Employee Number],
LEFT(CONCAT('', SPACE(11)), 11) AS [Filler],
LEFT(CONCAT(eDv.DEPENDENT_SSN, SPACE(9)), 9) AS [Member Social Security Number],
LEFT(CONCAT(edv.LAST_NAME, SPACE(20)), 20) AS [Member Last Name],
LEFT(CONCAT(edv.FIRST_NAME, SPACE(12)), 12) AS [Member First Name],
LEFT(CONCAT(edv.MIDDLE_NAME, SPACE(1)), 1) AS [Member Middle Initial],
LEFT(CONCAT(format(edv.BIRTHDATE, 'MMddyyyy'), SPACE(8)), 8) AS [Member Date of Birth],
LEFT(CONCAT('U', SPACE(1)), 1) AS [Member Marital Status],
LEFT(CONCAT(edv.sex, SPACE(1)), 1) AS [Member Gender],
LEFT(CONCAT(CASE WHEN EDV.DEPENDENT_RELATIONSHIP_ID IN ('S','DP') THEN '01' ELSE '02' END, SPACE(2)), 2) AS [Relationship Code],
LEFT(CONCAT(FORMAT(ATT1.DATE_VALUE, 'MMddyyyy'), SPACE(8)), 8) AS [Employee's Date of Hire],
LEFT(CONCAT('', SPACE(11)), 11) AS [Personnel Identification],
LEFT(CONCAT('', SPACE(1)), 1) AS [Employee Smoker Code],
LEFT(CONCAT('', SPACE(1)), 1) AS [Spouse Smoker Code],
LEFT(CONCAT(ev.WORK_TELEPHONE, SPACE(10)), 10) AS [Phone Number],
LEFT(CONCAT(ev.EMAIL_ADDRESS, SPACE(40)), 40) AS [Email Address],
LEFT(CONCAT('', SPACE(14)), 14) AS [Filler],
LEFT(CONCAT('D', SPACE(1)), 1) AS [Foreign Address Indicator],
LEFT(CONCAT('', SPACE(32)), 32) AS [Care of Address],
LEFT(CONCAT(ad.ADDRESS_1, SPACE(32)), 32) AS [Street Address],
LEFT(CONCAT(AD.CITY, SPACE(21)), 21) AS [City],
LEFT(CONCAT(AD.STATE, SPACE(2)), 2) AS [State],
LEFT(CONCAT(LEFT(AD.POSTAL_CODE,5), SPACE(9)), 9) AS [Zip Code],

LEFT(CONCAT(CASE WHEN DENTAL.PLAN_ID IS NOT NULL THEN  'D' ELSE '' END, SPACE(2)), 2) AS [Coverage Code - 1],
LEFT(CONCAT(FORMAT(COALESCE(RETDENTAL.OPTION_FROM_DATE, DENTAL.OPTION_FROM_DATE), 'MMddyyyy'), SPACE(8)), 8) AS [Coverage Start Date - 1],
LEFT(CONCAT(CASE WHEN DENTAL.LAST_DAY_OF_COVERAGE < '9999-12-31' THEN FORMAT(DENTAL.LAST_DAY_OF_COVERAGE, 'MMddyyyy') else '' end, SPACE(8)), 8) AS [Coverage Stop Date - 1],
LEFT(CONCAT(CASE WHEN DENTAL.PLAN_ID IS NOT NULL THEN  '5393668'  ELSE '' END, SPACE(7)), 7) AS [Group Number - 1],
LEFT(CONCAT(CASE WHEN DENTAL.PLAN_ID IS  NULL THEN '' WHEN DENTAL.PLAN_ID IS NOT NULL THEN  '0001' ELSE '' END, SPACE(4)), 4) AS [Subcode - 1],
LEFT(CONCAT(CASE WHEN DENTAL.PLAN_ID IS  NULL THEN '' WHEN COALESCE(RETDENTAL.BENEFIT_ID, DENTAL.BENEFIT_ID) = 'RETDENTAL' THEN '0002' ELSE '0001' END, SPACE(4)), 4) AS [Branch - 1],
LEFT(CONCAT('', SPACE(2)), 2) AS [Plan Code - 1],
LEFT(CONCAT(CASE WHEN DENTAL.PLAN_ID IS  NULL THEN '' WHEN COALESCE(RETDENTAL.BENEFIT_ID, DENTAL.BENEFIT_ID) = 'RETDENTAL' THEN 'R' ELSE 'A' END, SPACE(1)), 1) AS [Status Code - 1],
LEFT(CONCAT(CASE WHEN COALESCE(RETDENTAL.TIER_OPTION_ID, DENTAL.TIER_OPTION_ID) = 'EEONLY' THEN '1'
					WHEN COALESCE(RETDENTAL.TIER_OPTION_ID, DENTAL.TIER_OPTION_ID) = 'EECHILD' THEN '2'
					WHEN COALESCE(RETDENTAL.TIER_OPTION_ID, DENTAL.TIER_OPTION_ID) = 'EESPOUSE' THEN '3'
					WHEN COALESCE(RETDENTAL.TIER_OPTION_ID, DENTAL.TIER_OPTION_ID) = 'EEFAMILY' THEN '4'
					ELSE COALESCE(RETDENTAL.TIER_OPTION_ID, DENTAL.TIER_OPTION_ID)
					END, SPACE(10)), 1) AS [Members Covered Code - 1],
LEFT(CONCAT('', SPACE(2)), 2) AS [Cancel Reason - 1],
LEFT(CONCAT('', SPACE(1)), 1) AS [Filler],
LEFT(CONCAT('', SPACE(8)), 8) AS [Facility ID],
LEFT(CONCAT('', SPACE(15)), 15) AS [Filler],

LEFT(CONCAT(CASE WHEN BASICLIFE.PLAN_ID IS NULL THEN '' ELSE 'CP' END, SPACE(2)), 2) AS [Coverage Code - 2],
LEFT(CONCAT(FORMAT(BASICLIFE.AMOUNT_FROM_DATE,'MMddyyyy'), SPACE(8)), 8) AS [Coverage Start Date - 2],
LEFT(CONCAT(CASE WHEN BASICLIFE.LAST_DAY_OF_COVERAGE < '9999-12-31' THEN FORMAT(BASICLIFE.LAST_DAY_OF_COVERAGE, 'MMddyyyy') else '' end, SPACE(8)), 8) AS [Coverage Stop Date - 2],
LEFT(CONCAT(CASE WHEN BASICLIFE.PLAN_ID IS NULL THEN '' ELSE '5393668' END, SPACE(7)), 7) AS [Group Number - 2],
LEFT(CONCAT(CASE WHEN BASICLIFE.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Subcode - 2],
LEFT(CONCAT(CASE WHEN BASICLIFE.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Branch - 2],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT(CASE WHEN BASICLIFE.PLAN_ID IS NULL THEN '' ELSE  'A' END, SPACE(1)), 1) AS [Status Code - 2],
LEFT(CONCAT(CASE WHEN BASICLIFE.PLAN_ID IS NULL THEN '' ELSE  '1' END, SPACE(1)), 1) AS [Members Covered Code - 2],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
RIGHT(CONCAT(space(8),''), 8) AS [Annual Benefit Amount - 2],
LEFT(CONCAT(CASE WHEN BASICLIFE.PLAN_ID IS NULL THEN '' ELSE  'A' END, SPACE(1)), 1) AS [Salary Mode - 2],
RIGHT(CONCAT(space(8),''), 7) AS [Salary Amount - 2],

LEFT(CONCAT(CASE WHEN BASICADD.PLAN_ID IS NULL THEN '' ELSE  'AD' END, SPACE(2)), 2) AS [Coverage Code - 3],
LEFT(CONCAT(FORMAT(BASICADD.AMOUNT_FROM_DATE,'MMddyyyy'), SPACE(8)), 8) AS [Coverage Start Date - 3],
LEFT(CONCAT(CASE WHEN BASICADD.LAST_DAY_OF_COVERAGE < '9999-12-31' THEN FORMAT(BASICADD.LAST_DAY_OF_COVERAGE, 'MMddyyyy') else '' end, SPACE(8)), 8) AS [Coverage Stop Date - 3],
LEFT(CONCAT(CASE WHEN BASICADD.PLAN_ID IS NULL THEN '' ELSE '5393668' END, SPACE(7)), 7) AS [Group Number - 3],
LEFT(CONCAT(CASE WHEN BASICADD.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Subcode - 3],
LEFT(CONCAT(CASE WHEN BASICADD.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Branch - 3],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT(CASE WHEN BASICADD.PLAN_ID IS NULL THEN '' ELSE 'A' END, SPACE(1)), 1) AS [Status Code - 3],
LEFT(CONCAT(CASE WHEN BASICADD.PLAN_ID IS NULL THEN '' ELSE '1' END, SPACE(1)), 1) AS [Members Covered Code - 3],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
RIGHT(CONCAT(space(8),''), 8) AS [Annual Benefit Amount - 3],
LEFT(CONCAT(CASE WHEN BASICADD.PLAN_ID IS NULL THEN '' ELSE 'A' END, SPACE(1)), 1) AS [Salary Mode - 3],
RIGHT(CONCAT(space(8),''), 7) AS [Salary Amount - 3],

LEFT(CONCAT(CASE WHEN LTD.PLAN_ID IS NULL THEN '' ELSE 'LT' END, SPACE(2)), 2) AS [Coverage Code - 4], --LTD
LEFT(CONCAT(FORMAT(LTD.PLAN_FROM_DATE,'MMddyyyy'), SPACE(8)), 8) AS [Coverage Start Date - 4],
LEFT(CONCAT(CASE WHEN LTD.LAST_DAY_OF_COVERAGE < '9999-12-31' THEN FORMAT(LTD.LAST_DAY_OF_COVERAGE, 'MMddyyyy') else '' end, SPACE(8)), 8) AS [Coverage Stop Date - 4],
LEFT(CONCAT(CASE WHEN LTD.PLAN_ID IS NULL THEN '' ELSE '5393668' END, SPACE(7)), 7) AS [Group Number - 4],
LEFT(CONCAT(CASE WHEN LTD.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Subcode - 4],
LEFT(CONCAT(CASE WHEN LTD.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Branch - 4],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT(CASE WHEN LTD.PLAN_ID IS NULL THEN '' ELSE 'A' END, SPACE(1)), 1) AS [Status Code - 4],
LEFT(CONCAT(CASE WHEN LTD.PLAN_ID IS NULL THEN '' ELSE '1' END, SPACE(1)), 1) AS [Members Covered Code - 4],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
RIGHT(CONCAT(space(8),''), 8) AS [Monthly Benefit Amount - 4],
LEFT(CONCAT(CASE WHEN LTD.PLAN_ID IS NULL THEN '' ELSE 'A' END, SPACE(1)), 1) AS [Salary Mode - 4],
RIGHT(CONCAT(space(8),''), 7) AS [Salary Amount - 4],

LEFT(CONCAT(CASE WHEN STD.PLAN_ID IS NULL THEN '' ELSE 'AS' END, SPACE(2)), 2) AS [Coverage Code - 5], --STD
LEFT(CONCAT(FORMAT(STD.PLAN_FROM_DATE,'MMddyyyy'), SPACE(8)), 8) AS [Coverage Start Date - 5],
LEFT(CONCAT(CASE WHEN STD.LAST_DAY_OF_COVERAGE < '9999-12-31' THEN FORMAT(STD.LAST_DAY_OF_COVERAGE, 'MMddyyyy') else '' end, SPACE(8)), 8) AS [Coverage Stop Date - 5],
LEFT(CONCAT(CASE WHEN STD.PLAN_ID IS NULL THEN '' ELSE '318031' END, SPACE(7)), 7) AS [Group Number - 5],
LEFT(CONCAT(CASE WHEN STD.PLAN_ID IS NULL THEN '' ELSE '0002' END, SPACE(4)), 4) AS [Subcode - 5],
LEFT(CONCAT(CASE WHEN STD.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Branch - 5],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT(CASE WHEN STD.PLAN_ID IS NULL THEN '' ELSE 'A' END, SPACE(1)), 1) AS [Status Code - 5],
LEFT(CONCAT(CASE WHEN STD.PLAN_ID IS NULL THEN '' ELSE 'I' END, SPACE(1)), 1) AS [Members Covered Code - 5],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
RIGHT(CONCAT(space(8),''), 8) AS [Weekly Benefit Amount - 5],--#todo: std benefit amount
LEFT(CONCAT(CASE WHEN STD.PLAN_ID IS NULL THEN '' ELSE 'A' END, SPACE(1)), 1) AS [Salary Mode - 5],
RIGHT(CONCAT(space(8),''), 7) AS [Salary Amount - 5],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 6],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 6],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 6],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 6],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 6],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 6],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT('', SPACE(1)), 1) AS [Status Code - 6],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 6],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
LEFT(CONCAT('', SPACE(8)), 8) AS [Annual Benefit Amount - 6],
LEFT(CONCAT('', SPACE(8)), 8) AS [Filler],

LEFT(CONCAT(CASE WHEN SUPPLIFE.PLAN_ID IS NULL THEN '' ELSE 'OP' END, SPACE(2)), 2) AS [Coverage Code - 7], --SUPPLIFE
LEFT(CONCAT(FORMAT(SUPPLIFE.PLAN_FROM_DATE,'MMddyyyy'), SPACE(8)), 8) AS [Coverage Start Date - 7],
LEFT(CONCAT(CASE WHEN SUPPLIFE.LAST_DAY_OF_COVERAGE < '9999-12-31' THEN FORMAT(SUPPLIFE.LAST_DAY_OF_COVERAGE, 'MMddyyyy') else '' end, SPACE(8)), 8) AS [Coverage Stop Date - 7],
LEFT(CONCAT(CASE WHEN SUPPLIFE.PLAN_ID IS NULL THEN '' ELSE '5393668' END, SPACE(7)), 7) AS [Group Number - 7],
LEFT(CONCAT(CASE WHEN SUPPLIFE.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Subcode - 7],
LEFT(CONCAT(CASE WHEN SUPPLIFE.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Branch - 7],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT(CASE WHEN SUPPLIFE.PLAN_ID IS NULL THEN '' ELSE 'A' END, SPACE(1)), 1) AS [Status Code - 7],
LEFT(CONCAT(CASE WHEN SUPPLIFE.PLAN_ID IS NULL THEN '' ELSE 'I' END, SPACE(1)), 1) AS [Members Covered Code - 7],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
RIGHT(CONCAT(space(8),''), 8) AS [Annual Benefit Amount - 7],
LEFT(CONCAT(CASE WHEN SUPPLIFE.PLAN_ID IS NULL THEN '' ELSE 'A' END, SPACE(1)), 1) AS [Salary Mode - 7],
RIGHT(CONCAT(space(8),''), 7) AS [Salary Amount - 7],

LEFT(CONCAT(CASE WHEN SPOUSELIFE.PLAN_ID IS NULL THEN '' ELSE 'LZ' END, SPACE(2)), 2) AS [Coverage Code - 8], --SPOUSELIFE
LEFT(CONCAT(FORMAT(SPOUSELIFE.PLAN_FROM_DATE,'MMddyyyy'), SPACE(8)), 8) AS [Coverage Start Date - 8],
LEFT(CONCAT(CASE WHEN SPOUSELIFE.LAST_DAY_OF_COVERAGE < '9999-12-31' THEN FORMAT(SPOUSELIFE.LAST_DAY_OF_COVERAGE, 'MMddyyyy') else '' end, SPACE(8)), 8) AS [Coverage Stop Date - 8],
LEFT(CONCAT(CASE WHEN SPOUSELIFE.PLAN_ID IS NULL THEN '' ELSE '5393668' END, SPACE(7)), 7) AS [Group Number - 8],
LEFT(CONCAT(CASE WHEN SPOUSELIFE.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Subcode - 8],
LEFT(CONCAT(CASE WHEN SPOUSELIFE.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Branch - 8],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT(CASE WHEN SPOUSELIFE.PLAN_ID IS NULL THEN '' ELSE 'A' END, SPACE(1)), 1) AS [Status Code - 8],
LEFT(CONCAT(CASE WHEN SPOUSELIFE.PLAN_ID IS NULL THEN '' ELSE 'A' END, SPACE(1)), 1) AS [Members Covered Code - 8],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
RIGHT(CONCAT('0000000000',CAST(SPOUSELIFE.FINAL_BENEFIT_AMOUNT AS INT), CASE WHEN SPOUSELIFE.PLAN_ID IS NULL THEN '          ' ELSE '' END), 8) AS [Annual Benefit Amount - 8],
LEFT(CONCAT('', SPACE(8)), 8) AS [Filler],

LEFT(CONCAT(CASE WHEN CHILDLIFE.PLAN_ID IS NULL THEN '' ELSE 'LF' END, SPACE(2)), 2) AS [Coverage Code - 9], --CHILDLIFE
LEFT(CONCAT(FORMAT(CHILDLIFE.PLAN_FROM_DATE,'MMddyyyy'), SPACE(8)), 8) AS [Coverage Start Date - 9],
LEFT(CONCAT(CASE WHEN CHILDLIFE.LAST_DAY_OF_COVERAGE < '9999-12-31' THEN FORMAT(CHILDLIFE.LAST_DAY_OF_COVERAGE, 'MMddyyyy') else '' end, SPACE(8)), 8) AS [Coverage Stop Date - 9],
LEFT(CONCAT(CASE WHEN CHILDLIFE.PLAN_ID IS NULL THEN '' ELSE '5393668' END, SPACE(7)), 7) AS [Group Number - 9],
LEFT(CONCAT(CASE WHEN CHILDLIFE.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Subcode - 9],
LEFT(CONCAT(CASE WHEN CHILDLIFE.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Branch - 9],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT(CASE WHEN CHILDLIFE.PLAN_ID IS NULL THEN '' ELSE 'A' END, SPACE(1)), 1) AS [Status Code - 9],
LEFT(CONCAT(CASE WHEN CHILDLIFE.PLAN_ID IS NULL THEN '' ELSE 'C' END, SPACE(1)), 1) AS [Members Covered Code - 9],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
RIGHT(CONCAT('0000000000',CAST(CHILDLIFE.FINAL_BENEFIT_AMOUNT AS INT), CASE WHEN CHILDLIFE.PLAN_ID IS NULL THEN '          ' ELSE '' END), 8) AS [Annual Benefit Amount - 9],
LEFT(CONCAT('', SPACE(8)), 8) AS [Filler],

LEFT(CONCAT(CASE WHEN SUPPADD.PLAN_ID IS NULL THEN '' ELSE 'OD' END, SPACE(2)), 2) AS [Coverage Code - 10], --SUPPADD
LEFT(CONCAT(FORMAT(SUPPADD.PLAN_FROM_DATE,'MMddyyyy'), SPACE(8)), 8) AS [Coverage Start Date - 10],
LEFT(CONCAT(CASE WHEN SUPPADD.LAST_DAY_OF_COVERAGE < '9999-12-31' THEN FORMAT(SUPPADD.LAST_DAY_OF_COVERAGE, 'MMddyyyy') else '' end, SPACE(8)), 8) AS [Coverage Stop Date - 10],
LEFT(CONCAT(CASE WHEN SUPPADD.PLAN_ID IS NULL THEN '' ELSE '5393668' END, SPACE(7)), 7) AS [Group Number - 10],
LEFT(CONCAT(CASE WHEN SUPPADD.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Subcode - 10],
LEFT(CONCAT(CASE WHEN SUPPADD.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Branch - 10],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT(CASE WHEN SUPPADD.PLAN_ID IS NULL THEN '' ELSE 'A' END, SPACE(1)), 1) AS [Status Code - 10],
LEFT(CONCAT(CASE WHEN SUPPADD.PLAN_ID IS NULL THEN '' ELSE 'I' END, SPACE(1)), 1) AS [Members Covered Code - 10],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
RIGHT(CONCAT(space(8),''), 8) AS [Annual Benefit Amount - 10],
LEFT(CONCAT(CASE WHEN SUPPADD.PLAN_ID IS NULL THEN '' ELSE 'A' END, SPACE(1)), 1) AS [Salary Mode - 10],
RIGHT(CONCAT(space(8),''), 7) AS [Salary Amount - 10],

LEFT(CONCAT(CASE WHEN SPSUPPADD.PLAN_ID IS NULL THEN '' ELSE 'AE' END, SPACE(2)), 2) AS [Coverage Code - 11], --SPSUPPADD
LEFT(CONCAT(FORMAT(SPSUPPADD.PLAN_FROM_DATE,'MMddyyyy'), SPACE(8)), 8) AS [Coverage Start Date - 11],
LEFT(CONCAT(CASE WHEN SPSUPPADD.LAST_DAY_OF_COVERAGE < '9999-12-31' THEN FORMAT(SPSUPPADD.LAST_DAY_OF_COVERAGE, 'MMddyyyy') else '' end, SPACE(8)), 8) AS [Coverage Stop Date - 11],
LEFT(CONCAT(CASE WHEN SPSUPPADD.PLAN_ID IS NULL THEN '' ELSE '5393668' END, SPACE(7)), 7) AS [Group Number - 11],
LEFT(CONCAT(CASE WHEN SPSUPPADD.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Subcode - 11],
LEFT(CONCAT(CASE WHEN SPSUPPADD.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Branch - 11],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT(CASE WHEN SPSUPPADD.PLAN_ID IS NULL THEN '' ELSE 'A' END, SPACE(1)), 1) AS [Status Code - 11],
LEFT(CONCAT(CASE WHEN SPSUPPADD.PLAN_ID IS NULL THEN '' ELSE 'A' END, SPACE(1)), 1) AS [Members Covered Code - 11],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
RIGHT(CONCAT('0000000000',CAST(SPSUPPADD.FINAL_BENEFIT_AMOUNT AS INT), CASE WHEN SPSUPPADD.PLAN_ID IS NULL THEN '          ' ELSE '' END), 8) AS [Annual Benefit Amount - 11],
LEFT(CONCAT('', SPACE(8)), 8) AS [Filler],

LEFT(CONCAT(CASE WHEN CHILDADD.PLAN_ID IS NULL THEN '' ELSE 'AT' END, SPACE(2)), 2) AS [Coverage Code - 12], -- CHILDADD
LEFT(CONCAT(FORMAT(CHILDADD.PLAN_FROM_DATE,'MMddyyyy'), SPACE(8)), 8) AS [Coverage Start Date - 12],
LEFT(CONCAT(CASE WHEN CHILDADD.LAST_DAY_OF_COVERAGE < '9999-12-31' THEN FORMAT(CHILDADD.LAST_DAY_OF_COVERAGE, 'MMddyyyy') else '' end, SPACE(8)), 8) AS [Coverage Stop Date - 12],
LEFT(CONCAT(CASE WHEN CHILDADD.PLAN_ID IS NULL THEN '' ELSE '5393668' END, SPACE(7)), 7) AS [Group Number - 12],
LEFT(CONCAT(CASE WHEN CHILDADD.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Subcode - 12],
LEFT(CONCAT(CASE WHEN CHILDADD.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Branch - 12],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT(CASE WHEN CHILDADD.PLAN_ID IS NULL THEN '' ELSE 'A' END, SPACE(1)), 1) AS [Status Code - 12],
LEFT(CONCAT(CASE WHEN CHILDADD.PLAN_ID IS NULL THEN '' ELSE 'C' END, SPACE(1)), 1) AS [Members Covered Code - 12],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
RIGHT(CONCAT('0000000000',CAST(CHILDADD.FINAL_BENEFIT_AMOUNT AS INT), CASE WHEN CHILDADD.PLAN_ID IS NULL THEN '          ' ELSE '' END), 8) AS [Annual Benefit Amount - 12],
LEFT(CONCAT('', SPACE(8)), 8) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 13],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 13],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 13],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 13],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 13],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 13],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT('', SPACE(1)), 1) AS [Status Code - 13],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 13],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
LEFT(CONCAT('', SPACE(8)), 8) AS [Annual Benefit Amount - 13],
LEFT(CONCAT('', SPACE(8)), 8) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 14],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 14],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 14],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 14],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 14],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 14],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT('', SPACE(1)), 1) AS [Status Code - 14],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 14],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
LEFT(CONCAT('', SPACE(8)), 8) AS [Annual Benefit Amount - 14],
LEFT(CONCAT('', SPACE(11)), 11) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 15],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 15],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 15],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 15],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 15],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 15],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT('', SPACE(1)), 1) AS [Status Code - 15],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 15],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
LEFT(CONCAT('', SPACE(8)), 8) AS [Annual Benefit Amount - 15],
LEFT(CONCAT('', SPACE(8)), 8) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 16],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 16],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 16],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 16],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 16],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 16],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT('', SPACE(1)), 1) AS [Status Code - 16],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 16],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
LEFT(CONCAT('', SPACE(8)), 8) AS [Annual Benefit Amount - 16],
LEFT(CONCAT('', SPACE(8)), 8) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 17],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 17],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 17],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 17],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 17],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 17],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT('', SPACE(1)), 1) AS [Status Code - 17],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 17],
LEFT(CONCAT('', SPACE(2)), 2) AS [Cancel Reason - 17],
LEFT(CONCAT('', SPACE(23)), 23) AS [Filler],

LEFT(CONCAT('', SPACE(1)), 1) AS [Employee Status Code],
LEFT(CONCAT('', SPACE(8)), 8) AS [Status Code Effective Date],
LEFT(CONCAT('', SPACE(10)), 10) AS [Department Code],
LEFT(CONCAT('', SPACE(10)), 10) AS [Group ID],
LEFT(CONCAT('', SPACE(5)), 5) AS [Location ID],
LEFT(CONCAT('', SPACE(10)), 10) AS [Schedule ID],
LEFT(CONCAT('', SPACE(2)), 2) AS [Pay Frequency],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 18],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 18],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 18],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 18],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 18],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 18],
LEFT(CONCAT('', SPACE(1)), 1) AS [Status Code - 18],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 18],
LEFT(CONCAT('', SPACE(1)), 1) AS [Enrollment Status - 18],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 19],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 19],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 19],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 19],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 19],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 19],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 19],
LEFT(CONCAT('', SPACE(1)), 1) AS [Enrollment Status - 19],
LEFT(CONCAT('', SPACE(8)), 8) AS [Benefit Amount - 19],
LEFT(CONCAT('', SPACE(2)), 2) AS [Voluntary Cancellation Ind - 19],
LEFT(CONCAT('', SPACE(1)), 1) AS [Taveover Indicator - 19],
LEFT(CONCAT('', SPACE(9)), 9) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 20],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 20],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 20],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 20],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 20],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 20],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 20],
LEFT(CONCAT('', SPACE(1)), 1) AS [Enrollment Status - 20],
LEFT(CONCAT('', SPACE(8)), 8) AS [Benefit Amount - 20],
LEFT(CONCAT('', SPACE(2)), 2) AS [Voluntary Cancellation Ind - 20],
LEFT(CONCAT('', SPACE(8)), 8) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 21],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 21],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 21],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 21],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 21],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 21],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 21],
LEFT(CONCAT('', SPACE(1)), 1) AS [Enrollment Status - 21],
LEFT(CONCAT('', SPACE(3)), 3) AS [GPC Code],
LEFT(CONCAT('', SPACE(2)), 2) AS [Paypoint],
LEFT(CONCAT('', SPACE(3)), 3) AS [Payroll Deduction],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 22],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 22],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 22],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 22],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 22],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 22],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 22],
LEFT(CONCAT('', SPACE(1)), 1) AS [Enrollment Status - 22],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 23],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 23],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 23],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 23],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 23],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 23],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 23],
LEFT(CONCAT('', SPACE(1)), 1) AS [Enrollment Status - 23],
LEFT(CONCAT('', SPACE(2)), 2) AS [Voluntary Cancellation Ind - 23],
LEFT(CONCAT('', SPACE(1)), 1) AS [Takeover Indicator - 23],
LEFT(CONCAT('', SPACE(9)), 9) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 24],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 24],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 24],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 24],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 24],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 24],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 24],
LEFT(CONCAT('', SPACE(1)), 1) AS [Enrollment Status - 24],
LEFT(CONCAT('', SPACE(2)), 2) AS [Voluntary Cancellation Ind - 24],
LEFT(CONCAT('', SPACE(1)), 1) AS [Takeover Indicator - 24],
LEFT(CONCAT('', SPACE(9)), 9) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 25],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 25],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 25],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 25],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 25],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 25],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 25],
LEFT(CONCAT('', SPACE(1)), 1) AS [Enrollment Status - 25],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],

LEFT(CONCAT('', SPACE(95)), 95) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 27],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 27],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 27],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 27],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 27],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 27],
LEFT(CONCAT('', SPACE(1)), 1) AS [Status Code - 27],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 27],
LEFT(CONCAT('', SPACE(8)), 8) AS [Benefit Amount - 27],
LEFT(CONCAT('', SPACE(1)), 1) AS [Takeover Indicator - 27],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 28],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 28],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 28],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 28],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 28],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 28],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 28],
LEFT(CONCAT('', SPACE(1)), 1) AS [Enrollment Status - 28],
LEFT(CONCAT('', SPACE(8)), 8) AS [Benefit Amount - 28],
LEFT(CONCAT('', SPACE(2)), 2) AS [Voluntary Cancellation Ind - 28],
LEFT(CONCAT('', SPACE(1)), 1) AS [Takeover Indicator - 28],
LEFT(CONCAT('', SPACE(9)), 9) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 29],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 29],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 29],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 29],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 29],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 29],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 29],
LEFT(CONCAT('', SPACE(1)), 1) AS [Enrollment Status - 29],
LEFT(CONCAT('', SPACE(8)), 8) AS [Benefit Amount - 29],
LEFT(CONCAT('', SPACE(2)), 2) AS [Voluntary Cancellation Ind - 29],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 30],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 30],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 30],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 30],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 30],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 30],
LEFT(CONCAT('', SPACE(2)), 2) AS [Work State - 30],
LEFT(CONCAT('', SPACE(1)), 1) AS [Job Status Code (full time/part time indicator)],
LEFT(CONCAT('', SPACE(8)), 8) AS [Job Status (full time/part time) As of Date ]


FROM EMPLOYEE_VIEW EV
INNER JOIN EMPLOYEE_DEPENDENT_VIEW EDV
	ON EV.EMPLOYEE_UUID = EDV.EMPLOYEE_UUID
INNER JOIN EMPLOYEE_ADDRESS_DETAIL_VIEW AD
	ON AD.IS_PRIMARY = 'Y'
	AND AD.TO_DATE = '9999-12-31'
	AND AD.EMPLOYEE_UUID = EV.EMPLOYEE_UUID
LEFT JOIN EMPLOYEE_COVERAGE_DEPENDENT_COMBINED_VIEW DENTAL
	on ev.EMPLOYEE_UUID = DENTAL.EMPLOYEE_UUID
	AND DENTAL.EMPLOYEE_DEPENDENT_UUID = EDV.EMPLOYEE_DEPENDENT_UUID
	AND DENTAL.BENEFIT_ID = 'DENTAL'
	AND DENTAL.PLAN_ID NOT IN  ('WAIVE' , 'OPTOUT')
	AND (DENTAL.TO_DATE = '9999-12-31'
		OR (DENTAL.OPTION_CREATE_TRANSACTION_DATE > getdate() - @lookback
			AND (DENTAL.TO_DATE = (SELECT MAX(TO_DATE) FROM EMPLOYEE_COVERAGE_DEPENDENT_COMBINED_VIEW SUBCOV WHERE SUBCOV.EMPLOYEE_UUID = EV.EMPLOYEE_UUID AND SUBCOV.BENEFIT_UUID = DENTAL.BENEFIT_UUID))))
LEFT JOIN EMPLOYEE_COVERAGE_DEPENDENT_COMBINED_VIEW RETDENTAL
	on ev.EMPLOYEE_UUID = RETDENTAL.EMPLOYEE_UUID
	AND RETDENTAL.EMPLOYEE_DEPENDENT_UUID = EDV.EMPLOYEE_DEPENDENT_UUID
	AND RETDENTAL.BENEFIT_ID = 'xxx'
	AND RETDENTAL.PLAN_ID != 'WAIVE' 
	AND (RETDENTAL.TO_DATE = '1999-12-31'
		OR (RETDENTAL.OPTION_CREATE_TRANSACTION_DATE > getdate() - @lookback
			AND (RETDENTAL.TO_DATE = (SELECT MAX(TO_DATE) FROM EMPLOYEE_COVERAGE_DEPENDENT_COMBINED_VIEW SUBCOV WHERE SUBCOV.EMPLOYEE_UUID = EV.EMPLOYEE_UUID AND SUBCOV.BENEFIT_UUID = RETDENTAL.BENEFIT_UUID))))
LEFT JOIN EMPLOYEE_COVERAGE_DEPENDENT_COMBINED_VIEW BASICADD
	on ev.EMPLOYEE_UUID = BASICADD.EMPLOYEE_UUID
	AND BASICADD.EMPLOYEE_DEPENDENT_UUID = EDV.EMPLOYEE_DEPENDENT_UUID
	AND BASICADD.BENEFIT_ID = 'BASICADD'
	AND BASICADD.PLAN_ID != 'WAIVE' 
	AND (BASICADD.TO_DATE = '9999-12-31'
		OR (BASICADD.OPTION_CREATE_TRANSACTION_DATE > getdate() - @lookback
			AND (BASICADD.TO_DATE = (SELECT MAX(TO_DATE) FROM EMPLOYEE_COVERAGE_DEPENDENT_COMBINED_VIEW SUBCOV WHERE SUBCOV.EMPLOYEE_UUID = EV.EMPLOYEE_UUID AND SUBCOV.BENEFIT_UUID = BASICADD.BENEFIT_UUID))))
LEFT JOIN EMPLOYEE_COVERAGE_COMBINED_VIEW SPSUPPADD
	on ev.EMPLOYEE_UUID = SPSUPPADD.EMPLOYEE_UUID
	AND edv.DEPENDENT_RELATIONSHIP_ID IN ('S','DP')	AND 
	SPSUPPADD.BENEFIT_ID = 'SPSUPPADD'
	AND SPSUPPADD.PLAN_ID != 'WAIVE' 
	AND (SPSUPPADD.TO_DATE = '9999-12-31'
		OR (SPSUPPADD.OPTION_CREATE_TRANSACTION_DATE > getdate() - @lookback
			AND (SPSUPPADD.TO_DATE = (SELECT MAX(TO_DATE) FROM EMPLOYEE_COVERAGE_COMBINED_VIEW SUBCOV WHERE SUBCOV.EMPLOYEE_UUID = EV.EMPLOYEE_UUID AND SUBCOV.BENEFIT_UUID = SPSUPPADD.BENEFIT_UUID))))
LEFT JOIN EMPLOYEE_COVERAGE_COMBINED_VIEW CHILDADD
	on ev.EMPLOYEE_UUID = CHILDADD.EMPLOYEE_UUID
	AND edv.DEPENDENT_RELATIONSHIP_ID IN ('C','DPC')
	AND CHILDADD.BENEFIT_ID = 'CHILDADD'
	AND CHILDADD.PLAN_ID != 'WAIVE' 
	AND (CHILDADD.TO_DATE = '9999-12-31'
		OR (CHILDADD.OPTION_CREATE_TRANSACTION_DATE > getdate() - @lookback
			AND (CHILDADD.TO_DATE = (SELECT MAX(TO_DATE) FROM EMPLOYEE_COVERAGE_COMBINED_VIEW SUBCOV WHERE SUBCOV.EMPLOYEE_UUID = EV.EMPLOYEE_UUID AND SUBCOV.BENEFIT_UUID = CHILDADD.BENEFIT_UUID))))
LEFT JOIN EMPLOYEE_COVERAGE_DEPENDENT_COMBINED_VIEW SUPPADD
	on ev.EMPLOYEE_UUID = SUPPADD.EMPLOYEE_UUID
	AND SUPPADD.EMPLOYEE_DEPENDENT_UUID = EDV.EMPLOYEE_DEPENDENT_UUID
	AND SUPPADD.BENEFIT_ID = 'SUPPADD'
	AND SUPPADD.PLAN_ID != 'WAIVE' 
	AND (SUPPADD.TO_DATE = '9999-12-31'
		OR (SUPPADD.OPTION_CREATE_TRANSACTION_DATE > getdate() - @lookback
			AND (SUPPADD.TO_DATE = (SELECT MAX(TO_DATE) FROM EMPLOYEE_COVERAGE_DEPENDENT_COMBINED_VIEW SUBCOV WHERE SUBCOV.EMPLOYEE_UUID = EV.EMPLOYEE_UUID AND SUBCOV.BENEFIT_UUID = SUPPADD.BENEFIT_UUID))))
LEFT JOIN EMPLOYEE_COVERAGE_DEPENDENT_COMBINED_VIEW LTD
	on ev.EMPLOYEE_UUID = LTD.EMPLOYEE_UUID
	AND LTD.EMPLOYEE_DEPENDENT_UUID = EDV.EMPLOYEE_DEPENDENT_UUID
	AND LTD.BENEFIT_ID = 'LTD'
	AND LTD.PLAN_ID != 'WAIVE' 
	AND (LTD.TO_DATE = '9999-12-31'
		OR (LTD.OPTION_CREATE_TRANSACTION_DATE > getdate() - @lookback
			AND (LTD.TO_DATE = (SELECT MAX(TO_DATE) FROM EMPLOYEE_COVERAGE_DEPENDENT_COMBINED_VIEW SUBCOV WHERE SUBCOV.EMPLOYEE_UUID = EV.EMPLOYEE_UUID AND SUBCOV.BENEFIT_UUID = LTD.BENEFIT_UUID))))
LEFT JOIN EMPLOYEE_COVERAGE_DEPENDENT_COMBINED_VIEW BASICLIFE
	on ev.EMPLOYEE_UUID = BASICLIFE.EMPLOYEE_UUID
	AND BASICLIFE.EMPLOYEE_DEPENDENT_UUID = EDV.EMPLOYEE_DEPENDENT_UUID
	AND BASICLIFE.BENEFIT_ID = 'BASICLIFE'
	AND BASICLIFE.PLAN_ID != 'WAIVE' 
	AND (BASICLIFE.TO_DATE = '9999-12-31'
		OR (BASICLIFE.OPTION_CREATE_TRANSACTION_DATE > getdate() - @lookback))
	AND (BASICLIFE.TO_DATE = (SELECT MAX(TO_DATE) FROM EMPLOYEE_COVERAGE_DEPENDENT_COMBINED_VIEW SUBCOV WHERE SUBCOV.EMPLOYEE_UUID = EV.EMPLOYEE_UUID AND SUBCOV.BENEFIT_UUID = BASICLIFE.BENEFIT_UUID))
LEFT JOIN EMPLOYEE_COVERAGE_COMBINED_VIEW SPOUSELIFE
	on ev.EMPLOYEE_UUID = SPOUSELIFE.EMPLOYEE_UUID
	AND edv.DEPENDENT_RELATIONSHIP_ID IN ('S','DP')
	AND SPOUSELIFE.BENEFIT_ID = 'SPOUSELIFE'
	AND SPOUSELIFE.PLAN_ID != 'WAIVE' 
	AND (SPOUSELIFE.TO_DATE = '9999-12-31'
		OR (SPOUSELIFE.OPTION_CREATE_TRANSACTION_DATE > getdate() - @lookback
			AND (SPOUSELIFE.TO_DATE = (SELECT MAX(TO_DATE) FROM EMPLOYEE_COVERAGE_COMBINED_VIEW SUBCOV WHERE SUBCOV.EMPLOYEE_UUID = EV.EMPLOYEE_UUID AND SUBCOV.BENEFIT_UUID = SPOUSELIFE.BENEFIT_UUID))))
LEFT JOIN EMPLOYEE_COVERAGE_COMBINED_VIEW CHILDLIFE
	on ev.EMPLOYEE_UUID = CHILDLIFE.EMPLOYEE_UUID
	AND edv.DEPENDENT_RELATIONSHIP_ID IN ('C','DPC')
	AND CHILDLIFE.BENEFIT_ID = 'CHILDLIFE'
	AND CHILDLIFE.PLAN_ID != 'WAIVE' 
	AND (CHILDLIFE.TO_DATE = '9999-12-31'
		OR (CHILDLIFE.OPTION_CREATE_TRANSACTION_DATE > getdate() - @lookback
			AND (CHILDLIFE.TO_DATE = (SELECT MAX(TO_DATE) FROM EMPLOYEE_COVERAGE_COMBINED_VIEW SUBCOV WHERE SUBCOV.EMPLOYEE_UUID = EV.EMPLOYEE_UUID AND SUBCOV.BENEFIT_UUID = CHILDLIFE.BENEFIT_UUID))))
LEFT JOIN EMPLOYEE_COVERAGE_DEPENDENT_COMBINED_VIEW SUPPLIFE
	on ev.EMPLOYEE_UUID = SUPPLIFE.EMPLOYEE_UUID
	AND SUPPLIFE.EMPLOYEE_DEPENDENT_UUID = EDV.EMPLOYEE_DEPENDENT_UUID
	AND SUPPLIFE.BENEFIT_ID = 'SUPPLIFE'
	AND SUPPLIFE.PLAN_ID != 'WAIVE' 
	AND (SUPPLIFE.TO_DATE = '9999-12-31'
		OR (SUPPLIFE.OPTION_CREATE_TRANSACTION_DATE > getdate() - @lookback
			AND (SUPPLIFE.TO_DATE = (SELECT MAX(TO_DATE) FROM EMPLOYEE_COVERAGE_DEPENDENT_COMBINED_VIEW SUBCOV WHERE SUBCOV.EMPLOYEE_UUID = EV.EMPLOYEE_UUID AND SUBCOV.BENEFIT_UUID = SUPPLIFE.BENEFIT_UUID))))
LEFT JOIN EMPLOYEE_COVERAGE_DEPENDENT_COMBINED_VIEW STD
	on ev.EMPLOYEE_UUID = STD.EMPLOYEE_UUID
	AND STD.EMPLOYEE_DEPENDENT_UUID = EDV.EMPLOYEE_DEPENDENT_UUID
	AND STD.BENEFIT_ID = 'STD'
	AND STD.PLAN_ID != 'WAIVE' 
	AND (STD.TO_DATE = '9999-12-31'
		OR (STD.OPTION_CREATE_TRANSACTION_DATE > getdate() - @lookback
			AND (STD.TO_DATE = (SELECT MAX(TO_DATE) FROM EMPLOYEE_COVERAGE_DEPENDENT_COMBINED_VIEW SUBCOV WHERE SUBCOV.EMPLOYEE_UUID = EV.EMPLOYEE_UUID AND SUBCOV.BENEFIT_UUID = STD.BENEFIT_UUID))))

LEFT JOIN EMPLOYEE_ATTRIBUTE_PROCESSED_VALUE_DETAIL_VIEW ATT1
	ON ATT1.EMPLOYEE_UUID = EV.EMPLOYEE_UUID
	AND ATT1.EMPLOYEE_ATTRIBUTE_ID = 'latesthredate'
	AND ATT1.TO_DATE = '9999-12-31'

LEFT JOIN EMPLOYEE_ATTRIBUTE_PROCESSED_VALUE_DETAIL_VIEW ATT2
	ON ATT2.EMPLOYEE_UUID = EV.EMPLOYEE_UUID
	AND ATT2.EMPLOYEE_ATTRIBUTE_ID = 'CURRENTSALARY'
	AND ATT2.TO_DATE = '9999-12-31'

LEFT JOIN EMPLOYEE_ATTRIBUTE_PROCESSED_VALUE_DETAIL_VIEW ATT3
	ON ATT3.EMPLOYEE_UUID = EV.EMPLOYEE_UUID
	AND ATT3.EMPLOYEE_ATTRIBUTE_ID = ''
	AND ATT3.TO_DATE = '9999-12-31'

LEFT JOIN EMPLOYEE_ATTRIBUTE_PROCESSED_VALUE_DETAIL_VIEW ATT4
	ON ATT4.EMPLOYEE_UUID = EV.EMPLOYEE_UUID
	AND ATT4.EMPLOYEE_ATTRIBUTE_ID = ''
	AND ATT4.TO_DATE = '9999-12-31'

LEFT JOIN EMPLOYEE_ATTRIBUTE_PROCESSED_VALUE_DETAIL_VIEW ATT5
	ON ATT5.EMPLOYEE_UUID = EV.EMPLOYEE_UUID
	AND ATT5.EMPLOYEE_ATTRIBUTE_ID = ''
	AND ATT5.TO_DATE = '9999-12-31'

LEFT JOIN EMPLOYEE_ATTRIBUTE_PROCESSED_VALUE_DETAIL_VIEW ATT6
	ON ATT6.EMPLOYEE_UUID = EV.EMPLOYEE_UUID
	AND ATT6.EMPLOYEE_ATTRIBUTE_ID = ''
	AND ATT6.TO_DATE = '9999-12-31'


where 1=1
and (dental.ssn is not null
	or RETDENTAL.ssn is not null
	or SPSUPPADD.ssn is not null
	or basicadd.ssn is not null
	or childadd.ssn is not null
	or suppadd.SSN is not null
	or ltd.SSN is not null
	or basiclife.SSN is not null
	or spouselife.SSN is not null
	or childlife.SSN is not null
	or supplife.SSN is not null
	or std.SSN is not null
)
and ev.EMPLOYEE_UUID not in (select EMPLOYEE_UUID from EMPLOYEE_ATTRIBUTE_PROCESSED_VALUE_DETAIL_VIEW where to_date = '9999-12-31' and EMPLOYEE_ATTRIBUTE_ID = 'retiree' and STRING_VALUE = 'y')

	union all

--RETIREE logic:

select top 10000
	
--EMPLOYEE RECORDS

LEFT(CONCAT('E', SPACE(1)), 1) AS [Transaction Code],
LEFT(CONCAT('5393668', SPACE(7)), 7) AS [Customer Number],
LEFT(CONCAT(ev.ssn, SPACE(11)), 11) AS [Employee Number],
LEFT(CONCAT('', SPACE(11)), 11) AS [Filler],
LEFT(CONCAT(ev.ssn, SPACE(9)), 9) AS [Member Social Security Number],
LEFT(CONCAT(ev.LAST_NAME, SPACE(20)), 20) AS [Member Last Name],
LEFT(CONCAT(ev.FIRST_NAME, SPACE(12)), 12) AS [Member First Name],
LEFT(CONCAT(ev.MIDDLE_NAME, SPACE(1)), 1) AS [Member Middle Initial],
LEFT(CONCAT(format(ev.BIRTHDATE, 'MMddyyyy'), SPACE(8)), 8) AS [Member Date of Birth],
LEFT(CONCAT('U', SPACE(1)), 1) AS [Member Marital Status],
LEFT(CONCAT(ev.sex, SPACE(1)), 1) AS [Member Gender],
LEFT(CONCAT('00', SPACE(2)), 2) AS [Relationship Code],
LEFT(CONCAT(FORMAT(ATT1.DATE_VALUE, 'MMddyyyy'), SPACE(8)), 8) AS [Employee's Date of Hire],
LEFT(CONCAT('', SPACE(11)), 11) AS [Personnel Identification],
LEFT(CONCAT('', SPACE(1)), 1) AS [Employee Smoker Code],
LEFT(CONCAT('', SPACE(1)), 1) AS [Spouse Smoker Code],
LEFT(CONCAT(ev.WORK_TELEPHONE, SPACE(10)), 10) AS [Phone Number],
LEFT(CONCAT(ev.EMAIL_ADDRESS, SPACE(40)), 40) AS [Email Address],
LEFT(CONCAT('', SPACE(14)), 14) AS [Filler],
LEFT(CONCAT('D', SPACE(1)), 1) AS [Foreign Address Indicator],
LEFT(CONCAT('', SPACE(32)), 32) AS [Care of Address],
LEFT(CONCAT(ad.ADDRESS_1, SPACE(32)), 32) AS [Street Address],
LEFT(CONCAT(AD.CITY, SPACE(21)), 21) AS [City],
LEFT(CONCAT(AD.STATE, SPACE(2)), 2) AS [State],
LEFT(CONCAT(LEFT(AD.POSTAL_CODE,5), SPACE(9)), 9) AS [Zip Code],

LEFT(CONCAT(CASE WHEN DENTAL.PLAN_ID IS NOT NULL THEN  'D' ELSE '' END, SPACE(2)), 2) AS [Coverage Code - 1],
LEFT(CONCAT(FORMAT(COALESCE(RETDENTAL.OPTION_FROM_DATE, DENTAL.OPTION_FROM_DATE), 'MMddyyyy'), SPACE(8)), 8) AS [Coverage Start Date - 1],
LEFT(CONCAT(CASE WHEN DENTAL.LAST_DAY_OF_COVERAGE < '9999-12-31' THEN FORMAT(DENTAL.LAST_DAY_OF_COVERAGE, 'MMddyyyy') else '' end, SPACE(8)), 8) AS [Coverage Stop Date - 1],
LEFT(CONCAT(CASE WHEN DENTAL.PLAN_ID IS NOT NULL THEN  '5393668'  ELSE '' END, SPACE(7)), 7) AS [Group Number - 1],
LEFT(CONCAT(CASE WHEN DENTAL.PLAN_ID IS  NULL THEN '' WHEN DENTAL.PLAN_ID IS NOT NULL THEN  '0001' ELSE '' END, SPACE(4)), 4) AS [Subcode - 1],
LEFT(CONCAT(CASE WHEN DENTAL.PLAN_ID IS  NULL THEN '' WHEN COALESCE(RETDENTAL.BENEFIT_ID, DENTAL.BENEFIT_ID) = 'RETDENTAL' THEN '0002' ELSE '0001' END, SPACE(4)), 4) AS [Branch - 1],
LEFT(CONCAT('', SPACE(2)), 2) AS [Plan Code - 1],
LEFT(CONCAT(CASE WHEN DENTAL.PLAN_ID IS  NULL THEN '' WHEN COALESCE(RETDENTAL.BENEFIT_ID, DENTAL.BENEFIT_ID) = 'RETDENTAL' THEN 'R' ELSE 'A' END, SPACE(1)), 1) AS [Status Code - 1],
LEFT(CONCAT(CASE WHEN COALESCE(RETDENTAL.TIER_OPTION_ID, DENTAL.TIER_OPTION_ID) = 'EEONLY' THEN '1'
					WHEN COALESCE(RETDENTAL.TIER_OPTION_ID, DENTAL.TIER_OPTION_ID) = 'EECHILD' THEN '2'
					WHEN COALESCE(RETDENTAL.TIER_OPTION_ID, DENTAL.TIER_OPTION_ID) = 'EESPOUSE' THEN '3'
					WHEN COALESCE(RETDENTAL.TIER_OPTION_ID, DENTAL.TIER_OPTION_ID) = 'EEFAMILY' THEN '4'
					WHEN COALESCE(RETDENTAL.TIER_OPTION_ID, DENTAL.TIER_OPTION_ID) = 'SPONLY' THEN 'A'
					WHEN COALESCE(RETDENTAL.TIER_OPTION_ID, DENTAL.TIER_OPTION_ID) = 'CHONLY' THEN 'C'
					WHEN COALESCE(RETDENTAL.TIER_OPTION_ID, DENTAL.TIER_OPTION_ID) = 'SPCHILD' THEN '6'
					ELSE COALESCE(RETDENTAL.TIER_OPTION_ID, DENTAL.TIER_OPTION_ID)
					END, SPACE(10)), 1) AS [Members Covered Code - 1],
LEFT(CONCAT('', SPACE(2)), 2) AS [Cancel Reason - 1],
LEFT(CONCAT('', SPACE(1)), 1) AS [Filler],
LEFT(CONCAT('', SPACE(8)), 8) AS [Facility ID],
LEFT(CONCAT('', SPACE(15)), 15) AS [Filler],

LEFT(CONCAT(CASE WHEN BASICLIFE.PLAN_ID IS NULL THEN '' ELSE 'CP' END, SPACE(2)), 2) AS [Coverage Code - 2],
LEFT(CONCAT(FORMAT(BASICLIFE.AMOUNT_FROM_DATE,'MMddyyyy'), SPACE(8)), 8) AS [Coverage Start Date - 2],
LEFT(CONCAT(CASE WHEN BASICLIFE.LAST_DAY_OF_COVERAGE < '9999-12-31' THEN FORMAT(BASICLIFE.LAST_DAY_OF_COVERAGE, 'MMddyyyy') else '' end, SPACE(8)), 8) AS [Coverage Stop Date - 2],
LEFT(CONCAT(CASE WHEN BASICLIFE.PLAN_ID IS NULL THEN '' ELSE '5393668' END, SPACE(7)), 7) AS [Group Number - 2],
LEFT(CONCAT(CASE WHEN BASICLIFE.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Subcode - 2],
LEFT(CONCAT(CASE WHEN BASICLIFE.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Branch - 2],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT(CASE WHEN BASICLIFE.PLAN_ID IS NULL THEN '' ELSE  'A' END, SPACE(1)), 1) AS [Status Code - 2],
LEFT(CONCAT(CASE WHEN BASICLIFE.PLAN_ID IS NULL THEN '' ELSE  '1' END, SPACE(1)), 1) AS [Members Covered Code - 2],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
RIGHT(CONCAT('0000000000',CAST(BASICLIFE.FINAL_BENEFIT_AMOUNT AS INT), CASE WHEN BASICLIFE.PLAN_ID IS NULL THEN '          ' ELSE '' END), 8) AS [Annual Benefit Amount - 2],
LEFT(CONCAT(CASE WHEN BASICLIFE.PLAN_ID IS NULL THEN '' ELSE  'A' END, SPACE(1)), 1) AS [Salary Mode - 2],
RIGHT(CONCAT('0000000000',CAST(ATT2.NUMBER_VALUE AS INT), CASE WHEN BASICLIFE.PLAN_ID IS NULL THEN '          ' ELSE '' END), 7) AS [Salary Amount - 2],

LEFT(CONCAT(CASE WHEN BASICADD.PLAN_ID IS NULL THEN '' ELSE  'AD' END, SPACE(2)), 2) AS [Coverage Code - 3],
LEFT(CONCAT(FORMAT(BASICADD.AMOUNT_FROM_DATE,'MMddyyyy'), SPACE(8)), 8) AS [Coverage Start Date - 3],
LEFT(CONCAT(CASE WHEN BASICADD.LAST_DAY_OF_COVERAGE < '9999-12-31' THEN FORMAT(BASICADD.LAST_DAY_OF_COVERAGE, 'MMddyyyy') else '' end, SPACE(8)), 8) AS [Coverage Stop Date - 3],
LEFT(CONCAT(CASE WHEN BASICADD.PLAN_ID IS NULL THEN '' ELSE '5393668' END, SPACE(7)), 7) AS [Group Number - 3],
LEFT(CONCAT(CASE WHEN BASICADD.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Subcode - 3],
LEFT(CONCAT(CASE WHEN BASICADD.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Branch - 3],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT(CASE WHEN BASICADD.PLAN_ID IS NULL THEN '' ELSE 'A' END, SPACE(1)), 1) AS [Status Code - 3],
LEFT(CONCAT(CASE WHEN BASICADD.PLAN_ID IS NULL THEN '' ELSE '1' END, SPACE(1)), 1) AS [Members Covered Code - 3],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
RIGHT(CONCAT('0000000000',CAST(BASICADD.FINAL_BENEFIT_AMOUNT AS INT), CASE WHEN BASICADD.PLAN_ID IS NULL THEN '          ' ELSE '' END), 8) AS [Annual Benefit Amount - 3],
LEFT(CONCAT(CASE WHEN BASICADD.PLAN_ID IS NULL THEN '' ELSE 'A' END, SPACE(1)), 1) AS [Salary Mode - 3],
RIGHT(CONCAT('0000000000',CAST(ATT2.NUMBER_VALUE AS INT), CASE WHEN BASICADD.PLAN_ID IS NULL THEN '          ' ELSE '' END), 7) AS [Salary Amount - 3],

LEFT(CONCAT(CASE WHEN LTD.PLAN_ID IS NULL THEN '' ELSE 'LT' END, SPACE(2)), 2) AS [Coverage Code - 4], --LTD
LEFT(CONCAT(FORMAT(LTD.PLAN_FROM_DATE,'MMddyyyy'), SPACE(8)), 8) AS [Coverage Start Date - 4],
LEFT(CONCAT(CASE WHEN LTD.LAST_DAY_OF_COVERAGE < '9999-12-31' THEN FORMAT(LTD.LAST_DAY_OF_COVERAGE, 'MMddyyyy') else '' end, SPACE(8)), 8) AS [Coverage Stop Date - 4],
LEFT(CONCAT(CASE WHEN LTD.PLAN_ID IS NULL THEN '' ELSE '5393668' END, SPACE(7)), 7) AS [Group Number - 4],
LEFT(CONCAT(CASE WHEN LTD.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Subcode - 4],
LEFT(CONCAT(CASE WHEN LTD.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Branch - 4],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT(CASE WHEN LTD.PLAN_ID IS NULL THEN '' ELSE 'A' END, SPACE(1)), 1) AS [Status Code - 4],
LEFT(CONCAT(CASE WHEN LTD.PLAN_ID IS NULL THEN '' ELSE '1' END, SPACE(1)), 1) AS [Members Covered Code - 4],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
RIGHT(CONCAT('0000000000',CAST(LTD.FINAL_BENEFIT_AMOUNT AS INT), CASE WHEN LTD.PLAN_ID IS NULL THEN '          ' ELSE '' END), 8) AS [Monthly Benefit Amount - 4],
LEFT(CONCAT(CASE WHEN LTD.PLAN_ID IS NULL THEN '' ELSE 'A' END, SPACE(1)), 1) AS [Salary Mode - 4],
RIGHT(CONCAT('0000000000',CAST(ATT2.NUMBER_VALUE AS INT), CASE WHEN LTD.PLAN_ID IS NULL THEN '          ' ELSE '' END), 7) AS [Salary Amount - 4],

LEFT(CONCAT(CASE WHEN STD.PLAN_ID IS NULL THEN '' ELSE 'AS' END, SPACE(2)), 2) AS [Coverage Code - 5], --STD
LEFT(CONCAT(FORMAT(STD.PLAN_FROM_DATE,'MMddyyyy'), SPACE(8)), 8) AS [Coverage Start Date - 5],
LEFT(CONCAT(CASE WHEN STD.LAST_DAY_OF_COVERAGE < '9999-12-31' THEN FORMAT(STD.LAST_DAY_OF_COVERAGE, 'MMddyyyy') else '' end, SPACE(8)), 8) AS [Coverage Stop Date - 5],
LEFT(CONCAT(CASE WHEN STD.PLAN_ID IS NULL THEN '' ELSE '318031' END, SPACE(7)), 7) AS [Group Number - 5],
LEFT(CONCAT(CASE WHEN STD.PLAN_ID IS NULL THEN '' ELSE '0002' END, SPACE(4)), 4) AS [Subcode - 5],
LEFT(CONCAT(CASE WHEN STD.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Branch - 5],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT(CASE WHEN STD.PLAN_ID IS NULL THEN '' ELSE 'A' END, SPACE(1)), 1) AS [Status Code - 5],
LEFT(CONCAT(CASE WHEN STD.PLAN_ID IS NULL THEN '' ELSE '1' END, SPACE(1)), 1) AS [Members Covered Code - 5],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
RIGHT(CONCAT('0000000000',CAST(ATT2.NUMBER_VALUE/52*.6 AS INT), CASE WHEN STD.PLAN_ID IS NULL THEN '          ' ELSE '' END), 8) AS [Weekly Benefit Amount - 5],--#todo: std benefit amount
LEFT(CONCAT(CASE WHEN STD.PLAN_ID IS NULL THEN '' ELSE 'A' END, SPACE(1)), 1) AS [Salary Mode - 5],
RIGHT(CONCAT( '0000000000',CASE WHEN STD.PLAN_ID IS NULL THEN '' ELSE CAST(ATT2.NUMBER_VALUE AS INT) END, CASE WHEN STD.PLAN_ID IS NULL THEN '          ' ELSE '' END), 7) AS [Salary Amount - 5],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 6],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 6],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 6],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 6],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 6],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 6],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT('', SPACE(1)), 1) AS [Status Code - 6],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 6],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
LEFT(CONCAT('', SPACE(8)), 8) AS [Annual Benefit Amount - 6],
LEFT(CONCAT('', SPACE(8)), 8) AS [Filler],

LEFT(CONCAT(CASE WHEN SUPPLIFE.PLAN_ID IS NULL THEN '' ELSE 'OP' END, SPACE(2)), 2) AS [Coverage Code - 7], --SUPPLIFE
LEFT(CONCAT(FORMAT(SUPPLIFE.PLAN_FROM_DATE,'MMddyyyy'), SPACE(8)), 8) AS [Coverage Start Date - 7],
LEFT(CONCAT(CASE WHEN SUPPLIFE.LAST_DAY_OF_COVERAGE < '9999-12-31' THEN FORMAT(SUPPLIFE.LAST_DAY_OF_COVERAGE, 'MMddyyyy') else '' end, SPACE(8)), 8) AS [Coverage Stop Date - 7],
LEFT(CONCAT(CASE WHEN SUPPLIFE.PLAN_ID IS NULL THEN '' ELSE '5393668' END, SPACE(7)), 7) AS [Group Number - 7],
LEFT(CONCAT(CASE WHEN SUPPLIFE.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Subcode - 7],
LEFT(CONCAT(CASE WHEN SUPPLIFE.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Branch - 7],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT(CASE WHEN SUPPLIFE.PLAN_ID IS NULL THEN '' ELSE 'A' END, SPACE(1)), 1) AS [Status Code - 7],
LEFT(CONCAT(CASE WHEN SUPPLIFE.PLAN_ID IS NULL THEN '' ELSE '1' END, SPACE(1)), 1) AS [Members Covered Code - 7],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
RIGHT(CONCAT('0000000000',CAST(SUPPLIFE.FINAL_BENEFIT_AMOUNT AS INT), CASE WHEN SUPPLIFE.PLAN_ID IS NULL THEN '          ' ELSE '' END), 8) AS [Annual Benefit Amount - 7],
LEFT(CONCAT(CASE WHEN SUPPLIFE.PLAN_ID IS NULL THEN '' ELSE 'A' END, SPACE(1)), 1) AS [Salary Mode - 7],
RIGHT(CONCAT('0000000000',CAST(ATT2.NUMBER_VALUE AS INT), CASE WHEN SUPPLIFE.PLAN_ID IS NULL THEN '          ' ELSE '' END), 7) AS [Salary Amount - 7],

LEFT(CONCAT(CASE WHEN SPOUSELIFE.PLAN_ID IS NULL THEN '' ELSE 'LZ' END, SPACE(2)), 2) AS [Coverage Code - 8], --SPOUSELIFE
LEFT(CONCAT(FORMAT(SPOUSELIFE.PLAN_FROM_DATE,'MMddyyyy'), SPACE(8)), 8) AS [Coverage Start Date - 8],
LEFT(CONCAT(CASE WHEN SPOUSELIFE.LAST_DAY_OF_COVERAGE < '9999-12-31' THEN FORMAT(SPOUSELIFE.LAST_DAY_OF_COVERAGE, 'MMddyyyy') else '' end, SPACE(8)), 8) AS [Coverage Stop Date - 8],
LEFT(CONCAT(CASE WHEN SPOUSELIFE.PLAN_ID IS NULL THEN '' ELSE '5393668' END, SPACE(7)), 7) AS [Group Number - 8],
LEFT(CONCAT(CASE WHEN SPOUSELIFE.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Subcode - 8],
LEFT(CONCAT(CASE WHEN SPOUSELIFE.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Branch - 8],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT(CASE WHEN SPOUSELIFE.PLAN_ID IS NULL THEN '' ELSE 'A' END, SPACE(1)), 1) AS [Status Code - 8],
LEFT(CONCAT(CASE WHEN SPOUSELIFE.PLAN_ID IS NULL THEN '' ELSE 'A' END, SPACE(1)), 1) AS [Members Covered Code - 8],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
RIGHT(CONCAT('0000000000',CAST(SPOUSELIFE.FINAL_BENEFIT_AMOUNT AS INT), CASE WHEN SPOUSELIFE.PLAN_ID IS NULL THEN '          ' ELSE '' END), 8) AS [Annual Benefit Amount - 8],
LEFT(CONCAT('', SPACE(8)), 8) AS [Filler],

LEFT(CONCAT(CASE WHEN CHILDLIFE.PLAN_ID IS NULL THEN '' ELSE 'LF' END, SPACE(2)), 2) AS [Coverage Code - 9], --CHILDLIFE
LEFT(CONCAT(FORMAT(CHILDLIFE.PLAN_FROM_DATE,'MMddyyyy'), SPACE(8)), 8) AS [Coverage Start Date - 9],
LEFT(CONCAT(CASE WHEN CHILDLIFE.LAST_DAY_OF_COVERAGE < '9999-12-31' THEN FORMAT(CHILDLIFE.LAST_DAY_OF_COVERAGE, 'MMddyyyy') else '' end, SPACE(8)), 8) AS [Coverage Stop Date - 9],
LEFT(CONCAT(CASE WHEN CHILDLIFE.PLAN_ID IS NULL THEN '' ELSE '5393668' END, SPACE(7)), 7) AS [Group Number - 9],
LEFT(CONCAT(CASE WHEN CHILDLIFE.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Subcode - 9],
LEFT(CONCAT(CASE WHEN CHILDLIFE.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Branch - 9],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT(CASE WHEN CHILDLIFE.PLAN_ID IS NULL THEN '' ELSE 'A' END, SPACE(1)), 1) AS [Status Code - 9],
LEFT(CONCAT(CASE WHEN CHILDLIFE.PLAN_ID IS NULL THEN '' ELSE 'C' END, SPACE(1)), 1) AS [Members Covered Code - 9],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
RIGHT(CONCAT('0000000000',CAST(CHILDLIFE.FINAL_BENEFIT_AMOUNT AS INT), CASE WHEN CHILDLIFE.PLAN_ID IS NULL THEN '          ' ELSE '' END), 8) AS [Annual Benefit Amount - 9],
LEFT(CONCAT('', SPACE(8)), 8) AS [Filler],

LEFT(CONCAT(CASE WHEN SUPPADD.PLAN_ID IS NULL THEN '' ELSE 'OD' END, SPACE(2)), 2) AS [Coverage Code - 10], --SUPPADD
LEFT(CONCAT(FORMAT(SUPPADD.PLAN_FROM_DATE,'MMddyyyy'), SPACE(8)), 8) AS [Coverage Start Date - 10],
LEFT(CONCAT(CASE WHEN SUPPADD.LAST_DAY_OF_COVERAGE < '9999-12-31' THEN FORMAT(SUPPADD.LAST_DAY_OF_COVERAGE, 'MMddyyyy') else '' end, SPACE(8)), 8) AS [Coverage Stop Date - 10],
LEFT(CONCAT(CASE WHEN SUPPADD.PLAN_ID IS NULL THEN '' ELSE '5393668' END, SPACE(7)), 7) AS [Group Number - 10],
LEFT(CONCAT(CASE WHEN SUPPADD.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Subcode - 10],
LEFT(CONCAT(CASE WHEN SUPPADD.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Branch - 10],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT(CASE WHEN SUPPADD.PLAN_ID IS NULL THEN '' ELSE 'A' END, SPACE(1)), 1) AS [Status Code - 10],
LEFT(CONCAT(CASE WHEN SUPPADD.PLAN_ID IS NULL THEN '' ELSE '1' END, SPACE(1)), 1) AS [Members Covered Code - 10],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
RIGHT(CONCAT('0000000000',CAST(SUPPADD.FINAL_BENEFIT_AMOUNT AS INT), CASE WHEN SUPPADD.PLAN_ID IS NULL THEN '          ' ELSE '' END), 8) AS [Annual Benefit Amount - 10],
LEFT(CONCAT(CASE WHEN SUPPADD.PLAN_ID IS NULL THEN '' ELSE 'A' END, SPACE(1)), 1) AS [Salary Mode - 10],
RIGHT(CONCAT('0000000000',CAST(ATT2.NUMBER_VALUE AS INT), CASE WHEN SUPPADD.PLAN_ID IS NULL THEN '          ' ELSE '' END), 7) AS [Salary Amount - 10],

LEFT(CONCAT(CASE WHEN SPSUPPADD.PLAN_ID IS NULL THEN '' ELSE 'AE' END, SPACE(2)), 2) AS [Coverage Code - 11], --SPSUPPADD
LEFT(CONCAT(FORMAT(SPSUPPADD.PLAN_FROM_DATE,'MMddyyyy'), SPACE(8)), 8) AS [Coverage Start Date - 11],
LEFT(CONCAT(CASE WHEN SPSUPPADD.LAST_DAY_OF_COVERAGE < '9999-12-31' THEN FORMAT(SPSUPPADD.LAST_DAY_OF_COVERAGE, 'MMddyyyy') else '' end, SPACE(8)), 8) AS [Coverage Stop Date - 11],
LEFT(CONCAT(CASE WHEN SPSUPPADD.PLAN_ID IS NULL THEN '' ELSE '5393668' END, SPACE(7)), 7) AS [Group Number - 11],
LEFT(CONCAT(CASE WHEN SPSUPPADD.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Subcode - 11],
LEFT(CONCAT(CASE WHEN SPSUPPADD.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Branch - 11],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT(CASE WHEN SPSUPPADD.PLAN_ID IS NULL THEN '' ELSE 'A' END, SPACE(1)), 1) AS [Status Code - 11],
LEFT(CONCAT(CASE WHEN SPSUPPADD.PLAN_ID IS NULL THEN '' ELSE 'A' END, SPACE(1)), 1) AS [Members Covered Code - 11],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
RIGHT(CONCAT('0000000000',CAST(SPSUPPADD.FINAL_BENEFIT_AMOUNT AS INT), CASE WHEN SPSUPPADD.PLAN_ID IS NULL THEN '          ' ELSE '' END), 8) AS [Annual Benefit Amount - 11],
LEFT(CONCAT('', SPACE(8)), 8) AS [Filler],

LEFT(CONCAT(CASE WHEN CHILDADD.PLAN_ID IS NULL THEN '' ELSE 'AT' END, SPACE(2)), 2) AS [Coverage Code - 12], -- CHILDADD
LEFT(CONCAT(FORMAT(CHILDADD.PLAN_FROM_DATE,'MMddyyyy'), SPACE(8)), 8) AS [Coverage Start Date - 12],
LEFT(CONCAT(CASE WHEN CHILDADD.LAST_DAY_OF_COVERAGE < '9999-12-31' THEN FORMAT(CHILDADD.LAST_DAY_OF_COVERAGE, 'MMddyyyy') else '' end, SPACE(8)), 8) AS [Coverage Stop Date - 12],
LEFT(CONCAT(CASE WHEN CHILDADD.PLAN_ID IS NULL THEN '' ELSE '5393668' END, SPACE(7)), 7) AS [Group Number - 12],
LEFT(CONCAT(CASE WHEN CHILDADD.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Subcode - 12],
LEFT(CONCAT(CASE WHEN CHILDADD.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Branch - 12],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT(CASE WHEN CHILDADD.PLAN_ID IS NULL THEN '' ELSE 'A' END, SPACE(1)), 1) AS [Status Code - 12],
LEFT(CONCAT(CASE WHEN CHILDADD.PLAN_ID IS NULL THEN '' ELSE 'C' END, SPACE(1)), 1) AS [Members Covered Code - 12],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
RIGHT(CONCAT('0000000000',CAST(CHILDADD.FINAL_BENEFIT_AMOUNT AS INT), CASE WHEN CHILDADD.PLAN_ID IS NULL THEN '          ' ELSE '' END), 8) AS [Annual Benefit Amount - 12],
LEFT(CONCAT('', SPACE(8)), 8) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 13],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 13],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 13],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 13],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 13],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 13],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT('', SPACE(1)), 1) AS [Status Code - 13],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 13],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
LEFT(CONCAT('', SPACE(8)), 8) AS [Annual Benefit Amount - 13],
LEFT(CONCAT('', SPACE(8)), 8) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 14],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 14],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 14],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 14],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 14],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 14],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT('', SPACE(1)), 1) AS [Status Code - 14],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 14],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
LEFT(CONCAT('', SPACE(8)), 8) AS [Annual Benefit Amount - 14],
LEFT(CONCAT('', SPACE(11)), 11) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 15],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 15],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 15],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 15],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 15],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 15],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT('', SPACE(1)), 1) AS [Status Code - 15],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 15],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
LEFT(CONCAT('', SPACE(8)), 8) AS [Annual Benefit Amount - 15],
LEFT(CONCAT('', SPACE(8)), 8) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 16],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 16],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 16],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 16],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 16],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 16],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT('', SPACE(1)), 1) AS [Status Code - 16],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 16],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
LEFT(CONCAT('', SPACE(8)), 8) AS [Annual Benefit Amount - 16],
LEFT(CONCAT('', SPACE(8)), 8) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 17],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 17],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 17],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 17],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 17],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 17],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT('', SPACE(1)), 1) AS [Status Code - 17],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 17],
LEFT(CONCAT('', SPACE(2)), 2) AS [Cancel Reason - 17],
LEFT(CONCAT('', SPACE(23)), 23) AS [Filler],

LEFT(CONCAT('', SPACE(1)), 1) AS [Employee Status Code],
LEFT(CONCAT('', SPACE(8)), 8) AS [Status Code Effective Date],
LEFT(CONCAT('', SPACE(10)), 10) AS [Department Code],
LEFT(CONCAT('', SPACE(10)), 10) AS [Group ID],
LEFT(CONCAT('', SPACE(5)), 5) AS [Location ID],
LEFT(CONCAT('', SPACE(10)), 10) AS [Schedule ID],
LEFT(CONCAT('', SPACE(2)), 2) AS [Pay Frequency],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 18],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 18],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 18],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 18],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 18],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 18],
LEFT(CONCAT('', SPACE(1)), 1) AS [Status Code - 18],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 18],
LEFT(CONCAT('', SPACE(1)), 1) AS [Enrollment Status - 18],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 19],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 19],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 19],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 19],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 19],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 19],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 19],
LEFT(CONCAT('', SPACE(1)), 1) AS [Enrollment Status - 19],
LEFT(CONCAT('', SPACE(8)), 8) AS [Benefit Amount - 19],
LEFT(CONCAT('', SPACE(2)), 2) AS [Voluntary Cancellation Ind - 19],
LEFT(CONCAT('', SPACE(1)), 1) AS [Taveover Indicator - 19],
LEFT(CONCAT('', SPACE(9)), 9) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 20],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 20],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 20],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 20],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 20],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 20],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 20],
LEFT(CONCAT('', SPACE(1)), 1) AS [Enrollment Status - 20],
LEFT(CONCAT('', SPACE(8)), 8) AS [Benefit Amount - 20],
LEFT(CONCAT('', SPACE(2)), 2) AS [Voluntary Cancellation Ind - 20],
LEFT(CONCAT('', SPACE(8)), 8) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 21],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 21],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 21],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 21],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 21],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 21],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 21],
LEFT(CONCAT('', SPACE(1)), 1) AS [Enrollment Status - 21],
LEFT(CONCAT('', SPACE(3)), 3) AS [GPC Code],
LEFT(CONCAT('', SPACE(2)), 2) AS [Paypoint],
LEFT(CONCAT('', SPACE(3)), 3) AS [Payroll Deduction],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 22],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 22],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 22],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 22],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 22],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 22],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 22],
LEFT(CONCAT('', SPACE(1)), 1) AS [Enrollment Status - 22],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 23],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 23],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 23],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 23],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 23],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 23],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 23],
LEFT(CONCAT('', SPACE(1)), 1) AS [Enrollment Status - 23],
LEFT(CONCAT('', SPACE(2)), 2) AS [Voluntary Cancellation Ind - 23],
LEFT(CONCAT('', SPACE(1)), 1) AS [Takeover Indicator - 23],
LEFT(CONCAT('', SPACE(9)), 9) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 24],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 24],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 24],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 24],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 24],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 24],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 24],
LEFT(CONCAT('', SPACE(1)), 1) AS [Enrollment Status - 24],
LEFT(CONCAT('', SPACE(2)), 2) AS [Voluntary Cancellation Ind - 24],
LEFT(CONCAT('', SPACE(1)), 1) AS [Takeover Indicator - 24],
LEFT(CONCAT('', SPACE(9)), 9) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 25],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 25],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 25],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 25],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 25],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 25],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 25],
LEFT(CONCAT('', SPACE(1)), 1) AS [Enrollment Status - 25],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],

LEFT(CONCAT('', SPACE(95)), 95) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 27],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 27],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 27],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 27],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 27],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 27],
LEFT(CONCAT('', SPACE(1)), 1) AS [Status Code - 27],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 27],
LEFT(CONCAT('', SPACE(8)), 8) AS [Benefit Amount - 27],
LEFT(CONCAT('', SPACE(1)), 1) AS [Takeover Indicator - 27],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 28],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 28],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 28],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 28],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 28],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 28],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 28],
LEFT(CONCAT('', SPACE(1)), 1) AS [Enrollment Status - 28],
LEFT(CONCAT('', SPACE(8)), 8) AS [Benefit Amount - 28],
LEFT(CONCAT('', SPACE(2)), 2) AS [Voluntary Cancellation Ind - 28],
LEFT(CONCAT('', SPACE(1)), 1) AS [Takeover Indicator - 28],
LEFT(CONCAT('', SPACE(9)), 9) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 29],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 29],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 29],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 29],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 29],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 29],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 29],
LEFT(CONCAT('', SPACE(1)), 1) AS [Enrollment Status - 29],
LEFT(CONCAT('', SPACE(8)), 8) AS [Benefit Amount - 29],
LEFT(CONCAT('', SPACE(2)), 2) AS [Voluntary Cancellation Ind - 29],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 30],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 30],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 30],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 30],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 30],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 30],
LEFT(CONCAT('', SPACE(2)), 2) AS [Work State - 30],
LEFT(CONCAT('', SPACE(1)), 1) AS [Job Status Code (full time/part time indicator)],
LEFT(CONCAT('', SPACE(8)), 8) AS [Job Status (full time/part time) As of Date ]

FROM EMPLOYEE_VIEW EV
INNER JOIN EMPLOYEE_ADDRESS_DETAIL_VIEW AD
	ON AD.IS_PRIMARY = 'Y'
	AND AD.TO_DATE = '9999-12-31'
	AND AD.EMPLOYEE_UUID = EV.EMPLOYEE_UUID
LEFT JOIN EMPLOYEE_COVERAGE_COMBINED_VIEW DENTAL
	on ev.EMPLOYEE_UUID = DENTAL.EMPLOYEE_UUID
	AND DENTAL.BENEFIT_ID = 'RETDENTAL'
	AND DENTAL.PLAN_ID NOT IN  ('WAIVE' , 'OPTOUT')
	AND (DENTAL.TO_DATE = '9999-12-31'
		OR (DENTAL.OPTION_CREATE_TRANSACTION_DATE > getdate() - @lookback
			AND (DENTAL.TO_DATE = (SELECT MAX(TO_DATE) FROM EMPLOYEE_COVERAGE_COMBINED_VIEW SUBCOV WHERE SUBCOV.EMPLOYEE_UUID = EV.EMPLOYEE_UUID AND SUBCOV.BENEFIT_UUID = DENTAL.BENEFIT_UUID))))
LEFT JOIN EMPLOYEE_COVERAGE_COMBINED_VIEW RETDENTAL
	on ev.EMPLOYEE_UUID = RETDENTAL.EMPLOYEE_UUID
	AND RETDENTAL.BENEFIT_ID = 'RETDENTAL'
	AND RETDENTAL.PLAN_ID != 'WAIVE' 
	AND (RETDENTAL.TO_DATE = '1999-12-31'
		OR (RETDENTAL.OPTION_CREATE_TRANSACTION_DATE > getdate() - @lookback
			AND (RETDENTAL.TO_DATE = (SELECT MAX(TO_DATE) FROM EMPLOYEE_COVERAGE_COMBINED_VIEW SUBCOV WHERE SUBCOV.EMPLOYEE_UUID = EV.EMPLOYEE_UUID AND SUBCOV.BENEFIT_UUID = RETDENTAL.BENEFIT_UUID))))
LEFT JOIN EMPLOYEE_COVERAGE_COMBINED_VIEW BASICADD
	on ev.EMPLOYEE_UUID = BASICADD.EMPLOYEE_UUID
	AND BASICADD.BENEFIT_ID = 'BASICADD'
	AND BASICADD.PLAN_ID != 'WAIVE' 
	AND (BASICADD.TO_DATE = '9999-12-31'
		OR (BASICADD.OPTION_CREATE_TRANSACTION_DATE > getdate() - @lookback
			AND (BASICADD.TO_DATE = (SELECT MAX(TO_DATE) FROM EMPLOYEE_COVERAGE_COMBINED_VIEW SUBCOV WHERE SUBCOV.EMPLOYEE_UUID = EV.EMPLOYEE_UUID AND SUBCOV.BENEFIT_UUID = BASICADD.BENEFIT_UUID))))
LEFT JOIN EMPLOYEE_COVERAGE_COMBINED_VIEW SPSUPPADD
	on ev.EMPLOYEE_UUID = SPSUPPADD.EMPLOYEE_UUID
	AND SPSUPPADD.BENEFIT_ID = 'SPSUPPADD'
	AND SPSUPPADD.PLAN_ID != 'WAIVE' 
	AND (SPSUPPADD.TO_DATE = '9999-12-31'
		OR (SPSUPPADD.OPTION_CREATE_TRANSACTION_DATE > getdate() - @lookback
			AND (SPSUPPADD.TO_DATE = (SELECT MAX(TO_DATE) FROM EMPLOYEE_COVERAGE_COMBINED_VIEW SUBCOV WHERE SUBCOV.EMPLOYEE_UUID = EV.EMPLOYEE_UUID AND SUBCOV.BENEFIT_UUID = SPSUPPADD.BENEFIT_UUID))))
LEFT JOIN EMPLOYEE_COVERAGE_COMBINED_VIEW CHILDADD
	on ev.EMPLOYEE_UUID = CHILDADD.EMPLOYEE_UUID
	AND CHILDADD.BENEFIT_ID = 'CHILDADD'
	AND CHILDADD.PLAN_ID != 'WAIVE' 
	AND (CHILDADD.TO_DATE = '9999-12-31'
		OR (CHILDADD.OPTION_CREATE_TRANSACTION_DATE > getdate() - @lookback
			AND (CHILDADD.TO_DATE = (SELECT MAX(TO_DATE) FROM EMPLOYEE_COVERAGE_COMBINED_VIEW SUBCOV WHERE SUBCOV.EMPLOYEE_UUID = EV.EMPLOYEE_UUID AND SUBCOV.BENEFIT_UUID = CHILDADD.BENEFIT_UUID))))
LEFT JOIN EMPLOYEE_COVERAGE_COMBINED_VIEW SUPPADD
	on ev.EMPLOYEE_UUID = SUPPADD.EMPLOYEE_UUID
	AND SUPPADD.BENEFIT_ID = 'SUPPADD'
	AND SUPPADD.PLAN_ID != 'WAIVE' 
	AND (SUPPADD.TO_DATE = '9999-12-31'
		OR (SUPPADD.OPTION_CREATE_TRANSACTION_DATE > getdate() - @lookback
			AND (SUPPADD.TO_DATE = (SELECT MAX(TO_DATE) FROM EMPLOYEE_COVERAGE_COMBINED_VIEW SUBCOV WHERE SUBCOV.EMPLOYEE_UUID = EV.EMPLOYEE_UUID AND SUBCOV.BENEFIT_UUID = SUPPADD.BENEFIT_UUID))))
LEFT JOIN EMPLOYEE_COVERAGE_COMBINED_VIEW LTD
	on ev.EMPLOYEE_UUID = LTD.EMPLOYEE_UUID
	AND LTD.BENEFIT_ID = 'LTD'
	AND LTD.PLAN_ID != 'WAIVE' 
	AND (LTD.TO_DATE = '9999-12-31'
		OR (LTD.OPTION_CREATE_TRANSACTION_DATE > getdate() - @lookback
			AND (LTD.TO_DATE = (SELECT MAX(TO_DATE) FROM EMPLOYEE_COVERAGE_COMBINED_VIEW SUBCOV WHERE SUBCOV.EMPLOYEE_UUID = EV.EMPLOYEE_UUID AND SUBCOV.BENEFIT_UUID = LTD.BENEFIT_UUID))))
LEFT JOIN EMPLOYEE_COVERAGE_COMBINED_VIEW BASICLIFE
	on ev.EMPLOYEE_UUID = BASICLIFE.EMPLOYEE_UUID
	AND BASICLIFE.BENEFIT_ID = 'RBASICLIFE'
	AND BASICLIFE.PLAN_ID != 'WAIVE' 
	AND (BASICLIFE.TO_DATE = '9999-12-31'
		OR (BASICLIFE.OPTION_CREATE_TRANSACTION_DATE > getdate() - @lookback
			AND (BASICLIFE.TO_DATE = (SELECT MAX(TO_DATE) FROM EMPLOYEE_COVERAGE_COMBINED_VIEW SUBCOV WHERE SUBCOV.EMPLOYEE_UUID = EV.EMPLOYEE_UUID AND SUBCOV.BENEFIT_UUID = BASICLIFE.BENEFIT_UUID))))
LEFT JOIN EMPLOYEE_COVERAGE_COMBINED_VIEW SPOUSELIFE
	on ev.EMPLOYEE_UUID = SPOUSELIFE.EMPLOYEE_UUID
	AND SPOUSELIFE.BENEFIT_ID = 'SPOUSELIFE'
	AND SPOUSELIFE.PLAN_ID != 'WAIVE' 
	AND (SPOUSELIFE.TO_DATE = '9999-12-31'
		OR (SPOUSELIFE.OPTION_CREATE_TRANSACTION_DATE > getdate() - @lookback
			AND (SPOUSELIFE.TO_DATE = (SELECT MAX(TO_DATE) FROM EMPLOYEE_COVERAGE_COMBINED_VIEW SUBCOV WHERE SUBCOV.EMPLOYEE_UUID = EV.EMPLOYEE_UUID AND SUBCOV.BENEFIT_UUID = SPOUSELIFE.BENEFIT_UUID))))
LEFT JOIN EMPLOYEE_COVERAGE_COMBINED_VIEW CHILDLIFE
	on ev.EMPLOYEE_UUID = CHILDLIFE.EMPLOYEE_UUID
	AND CHILDLIFE.BENEFIT_ID = 'CHILDLIFE'
	AND CHILDLIFE.PLAN_ID != 'WAIVE' 
	AND (CHILDLIFE.TO_DATE = '9999-12-31'
		OR (CHILDLIFE.OPTION_CREATE_TRANSACTION_DATE > getdate() - @lookback
			AND (CHILDLIFE.TO_DATE = (SELECT MAX(TO_DATE) FROM EMPLOYEE_COVERAGE_COMBINED_VIEW SUBCOV WHERE SUBCOV.EMPLOYEE_UUID = EV.EMPLOYEE_UUID AND SUBCOV.BENEFIT_UUID = CHILDLIFE.BENEFIT_UUID))))
LEFT JOIN EMPLOYEE_COVERAGE_COMBINED_VIEW SUPPLIFE
	on ev.EMPLOYEE_UUID = SUPPLIFE.EMPLOYEE_UUID
	AND SUPPLIFE.BENEFIT_ID = 'SUPPLIFE'
	AND SUPPLIFE.PLAN_ID != 'WAIVE' 
	AND (SUPPLIFE.TO_DATE = '9999-12-31'
		OR (SUPPLIFE.OPTION_CREATE_TRANSACTION_DATE > getdate() - @lookback
			AND (SUPPLIFE.TO_DATE = (SELECT MAX(TO_DATE) FROM EMPLOYEE_COVERAGE_COMBINED_VIEW SUBCOV WHERE SUBCOV.EMPLOYEE_UUID = EV.EMPLOYEE_UUID AND SUBCOV.BENEFIT_UUID = SUPPLIFE.BENEFIT_UUID))))
LEFT JOIN EMPLOYEE_COVERAGE_COMBINED_VIEW STD
	on ev.EMPLOYEE_UUID = STD.EMPLOYEE_UUID
	AND STD.BENEFIT_ID = 'STD'
	AND STD.PLAN_ID != 'WAIVE' 
	AND (STD.TO_DATE = '9999-12-31'
		OR (STD.OPTION_CREATE_TRANSACTION_DATE > getdate() - @lookback
			AND (STD.TO_DATE = (SELECT MAX(TO_DATE) FROM EMPLOYEE_COVERAGE_COMBINED_VIEW SUBCOV WHERE SUBCOV.EMPLOYEE_UUID = EV.EMPLOYEE_UUID AND SUBCOV.BENEFIT_UUID = STD.BENEFIT_UUID))))

LEFT JOIN EMPLOYEE_ATTRIBUTE_PROCESSED_VALUE_DETAIL_VIEW ATT1
	ON ATT1.EMPLOYEE_UUID = EV.EMPLOYEE_UUID
	AND ATT1.EMPLOYEE_ATTRIBUTE_ID = 'latesthredate'
	AND ATT1.TO_DATE = '9999-12-31'

LEFT JOIN EMPLOYEE_ATTRIBUTE_PROCESSED_VALUE_DETAIL_VIEW ATT2
	ON ATT2.EMPLOYEE_UUID = EV.EMPLOYEE_UUID
	AND ATT2.EMPLOYEE_ATTRIBUTE_ID = 'CURRENTSALARY'
	AND ATT2.TO_DATE = '9999-12-31'

LEFT JOIN EMPLOYEE_ATTRIBUTE_PROCESSED_VALUE_DETAIL_VIEW ATT3
	ON ATT3.EMPLOYEE_UUID = EV.EMPLOYEE_UUID
	AND ATT3.EMPLOYEE_ATTRIBUTE_ID = ''
	AND ATT3.TO_DATE = '9999-12-31'

LEFT JOIN EMPLOYEE_ATTRIBUTE_PROCESSED_VALUE_DETAIL_VIEW ATT4
	ON ATT4.EMPLOYEE_UUID = EV.EMPLOYEE_UUID
	AND ATT4.EMPLOYEE_ATTRIBUTE_ID = ''
	AND ATT4.TO_DATE = '9999-12-31'

LEFT JOIN EMPLOYEE_ATTRIBUTE_PROCESSED_VALUE_DETAIL_VIEW ATT5
	ON ATT5.EMPLOYEE_UUID = EV.EMPLOYEE_UUID
	AND ATT5.EMPLOYEE_ATTRIBUTE_ID = ''
	AND ATT5.TO_DATE = '9999-12-31'

LEFT JOIN EMPLOYEE_ATTRIBUTE_PROCESSED_VALUE_DETAIL_VIEW ATT6
	ON ATT6.EMPLOYEE_UUID = EV.EMPLOYEE_UUID
	AND ATT6.EMPLOYEE_ATTRIBUTE_ID = ''
	AND ATT6.TO_DATE = '9999-12-31'
where 1=1
and (dental.ssn is not null
	or RETDENTAL.ssn is not null
	or SPSUPPADD.ssn is not null
	or basicadd.ssn is not null
	or childadd.ssn is not null
	or suppadd.SSN is not null
	or ltd.SSN is not null
	or basiclife.SSN is not null
	or spouselife.SSN is not null
	or childlife.SSN is not null
	or supplife.SSN is not null
	or std.SSN is not null
)
and ev.EMPLOYEE_UUID in (select EMPLOYEE_UUID from EMPLOYEE_ATTRIBUTE_PROCESSED_VALUE_DETAIL_VIEW where to_date = '9999-12-31' and EMPLOYEE_ATTRIBUTE_ID = 'retiree' and STRING_VALUE = 'y')

union all

select DISTINCT top 10000
	
--DEPENDENT RECORDS

LEFT(CONCAT('D', SPACE(1)), 1) AS [Transaction Code],
LEFT(CONCAT('5393668', SPACE(7)), 7) AS [Customer Number],
LEFT(CONCAT(ev.ssn, SPACE(11)), 11) AS [Employee Number],
LEFT(CONCAT('', SPACE(11)), 11) AS [Filler],
LEFT(CONCAT(eDv.DEPENDENT_SSN, SPACE(9)), 9) AS [Member Social Security Number],
LEFT(CONCAT(edv.LAST_NAME, SPACE(20)), 20) AS [Member Last Name],
LEFT(CONCAT(edv.FIRST_NAME, SPACE(12)), 12) AS [Member First Name],
LEFT(CONCAT(edv.MIDDLE_NAME, SPACE(1)), 1) AS [Member Middle Initial],
LEFT(CONCAT(format(edv.BIRTHDATE, 'MMddyyyy'), SPACE(8)), 8) AS [Member Date of Birth],
LEFT(CONCAT('U', SPACE(1)), 1) AS [Member Marital Status],
LEFT(CONCAT(edv.sex, SPACE(1)), 1) AS [Member Gender],
LEFT(CONCAT(CASE WHEN EDV.DEPENDENT_RELATIONSHIP_ID IN ('S','DP') THEN '01' ELSE '02' END, SPACE(2)), 2) AS [Relationship Code],
LEFT(CONCAT(FORMAT(ATT1.DATE_VALUE, 'MMddyyyy'), SPACE(8)), 8) AS [Employee's Date of Hire],
LEFT(CONCAT('', SPACE(11)), 11) AS [Personnel Identification],
LEFT(CONCAT('', SPACE(1)), 1) AS [Employee Smoker Code],
LEFT(CONCAT('', SPACE(1)), 1) AS [Spouse Smoker Code],
LEFT(CONCAT(ev.WORK_TELEPHONE, SPACE(10)), 10) AS [Phone Number],
LEFT(CONCAT(ev.EMAIL_ADDRESS, SPACE(40)), 40) AS [Email Address],
LEFT(CONCAT('', SPACE(14)), 14) AS [Filler],
LEFT(CONCAT('D', SPACE(1)), 1) AS [Foreign Address Indicator],
LEFT(CONCAT('', SPACE(32)), 32) AS [Care of Address],
LEFT(CONCAT(ad.ADDRESS_1, SPACE(32)), 32) AS [Street Address],
LEFT(CONCAT(AD.CITY, SPACE(21)), 21) AS [City],
LEFT(CONCAT(AD.STATE, SPACE(2)), 2) AS [State],
LEFT(CONCAT(LEFT(AD.POSTAL_CODE,5), SPACE(9)), 9) AS [Zip Code],

LEFT(CONCAT(CASE WHEN DENTAL.PLAN_ID IS NOT NULL THEN  'D' ELSE '' END, SPACE(2)), 2) AS [Coverage Code - 1],
LEFT(CONCAT(FORMAT(COALESCE(RETDENTAL.OPTION_FROM_DATE, DENTAL.OPTION_FROM_DATE), 'MMddyyyy'), SPACE(8)), 8) AS [Coverage Start Date - 1],
LEFT(CONCAT(CASE WHEN DENTAL.LAST_DAY_OF_COVERAGE < '9999-12-31' THEN FORMAT(DENTAL.LAST_DAY_OF_COVERAGE, 'MMddyyyy') else '' end, SPACE(8)), 8) AS [Coverage Stop Date - 1],
LEFT(CONCAT(CASE WHEN DENTAL.PLAN_ID IS NOT NULL THEN  '5393668'  ELSE '' END, SPACE(7)), 7) AS [Group Number - 1],
LEFT(CONCAT(CASE WHEN DENTAL.PLAN_ID IS  NULL THEN '' WHEN DENTAL.PLAN_ID IS NOT NULL THEN  '0001' ELSE '' END, SPACE(4)), 4) AS [Subcode - 1],
LEFT(CONCAT(CASE WHEN DENTAL.PLAN_ID IS  NULL THEN '' WHEN COALESCE(RETDENTAL.BENEFIT_ID, DENTAL.BENEFIT_ID) = 'RETDENTAL' THEN '0002' ELSE '0001' END, SPACE(4)), 4) AS [Branch - 1],
LEFT(CONCAT('', SPACE(2)), 2) AS [Plan Code - 1],
LEFT(CONCAT(CASE WHEN DENTAL.PLAN_ID IS  NULL THEN '' WHEN COALESCE(RETDENTAL.BENEFIT_ID, DENTAL.BENEFIT_ID) = 'RETDENTAL' THEN 'R' ELSE 'A' END, SPACE(1)), 1) AS [Status Code - 1],
LEFT(CONCAT(CASE WHEN COALESCE(RETDENTAL.TIER_OPTION_ID, DENTAL.TIER_OPTION_ID) = 'EEONLY' THEN '1'
					WHEN COALESCE(RETDENTAL.TIER_OPTION_ID, DENTAL.TIER_OPTION_ID) = 'EECHILD' THEN '2'
					WHEN COALESCE(RETDENTAL.TIER_OPTION_ID, DENTAL.TIER_OPTION_ID) = 'EESPOUSE' THEN '3'
					WHEN COALESCE(RETDENTAL.TIER_OPTION_ID, DENTAL.TIER_OPTION_ID) = 'EEFAMILY' THEN '4'
					WHEN COALESCE(RETDENTAL.TIER_OPTION_ID, DENTAL.TIER_OPTION_ID) = 'SPONLY' THEN 'A'
					WHEN COALESCE(RETDENTAL.TIER_OPTION_ID, DENTAL.TIER_OPTION_ID) = 'CHONLY' THEN 'C'
					WHEN COALESCE(RETDENTAL.TIER_OPTION_ID, DENTAL.TIER_OPTION_ID) = 'SPCHILD' THEN '6'
					ELSE COALESCE(RETDENTAL.TIER_OPTION_ID, DENTAL.TIER_OPTION_ID)
					END, SPACE(10)), 1) AS [Members Covered Code - 1],
LEFT(CONCAT('', SPACE(2)), 2) AS [Cancel Reason - 1],
LEFT(CONCAT('', SPACE(1)), 1) AS [Filler],
LEFT(CONCAT('', SPACE(8)), 8) AS [Facility ID],
LEFT(CONCAT('', SPACE(15)), 15) AS [Filler],

LEFT(CONCAT(CASE WHEN BASICLIFE.PLAN_ID IS NULL THEN '' ELSE 'CP' END, SPACE(2)), 2) AS [Coverage Code - 2],
LEFT(CONCAT(FORMAT(BASICLIFE.AMOUNT_FROM_DATE,'MMddyyyy'), SPACE(8)), 8) AS [Coverage Start Date - 2],
LEFT(CONCAT(CASE WHEN BASICLIFE.LAST_DAY_OF_COVERAGE < '9999-12-31' THEN FORMAT(BASICLIFE.LAST_DAY_OF_COVERAGE, 'MMddyyyy') else '' end, SPACE(8)), 8) AS [Coverage Stop Date - 2],
LEFT(CONCAT(CASE WHEN BASICLIFE.PLAN_ID IS NULL THEN '' ELSE '5393668' END, SPACE(7)), 7) AS [Group Number - 2],
LEFT(CONCAT(CASE WHEN BASICLIFE.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Subcode - 2],
LEFT(CONCAT(CASE WHEN BASICLIFE.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Branch - 2],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT(CASE WHEN BASICLIFE.PLAN_ID IS NULL THEN '' ELSE  'A' END, SPACE(1)), 1) AS [Status Code - 2],
LEFT(CONCAT(CASE WHEN BASICLIFE.PLAN_ID IS NULL THEN '' ELSE  '1' END, SPACE(1)), 1) AS [Members Covered Code - 2],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
RIGHT(CONCAT(space(8),''), 8) AS [Annual Benefit Amount - 2],
LEFT(CONCAT(CASE WHEN BASICLIFE.PLAN_ID IS NULL THEN '' ELSE  'A' END, SPACE(1)), 1) AS [Salary Mode - 2],
RIGHT(CONCAT(space(8),''), 7) AS [Salary Amount - 2],

LEFT(CONCAT(CASE WHEN BASICADD.PLAN_ID IS NULL THEN '' ELSE  'AD' END, SPACE(2)), 2) AS [Coverage Code - 3],
LEFT(CONCAT(FORMAT(BASICADD.AMOUNT_FROM_DATE,'MMddyyyy'), SPACE(8)), 8) AS [Coverage Start Date - 3],
LEFT(CONCAT(CASE WHEN BASICADD.LAST_DAY_OF_COVERAGE < '9999-12-31' THEN FORMAT(BASICADD.LAST_DAY_OF_COVERAGE, 'MMddyyyy') else '' end, SPACE(8)), 8) AS [Coverage Stop Date - 3],
LEFT(CONCAT(CASE WHEN BASICADD.PLAN_ID IS NULL THEN '' ELSE '5393668' END, SPACE(7)), 7) AS [Group Number - 3],
LEFT(CONCAT(CASE WHEN BASICADD.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Subcode - 3],
LEFT(CONCAT(CASE WHEN BASICADD.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Branch - 3],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT(CASE WHEN BASICADD.PLAN_ID IS NULL THEN '' ELSE 'A' END, SPACE(1)), 1) AS [Status Code - 3],
LEFT(CONCAT(CASE WHEN BASICADD.PLAN_ID IS NULL THEN '' ELSE '1' END, SPACE(1)), 1) AS [Members Covered Code - 3],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
RIGHT(CONCAT(space(8),''), 8) AS [Annual Benefit Amount - 3],
LEFT(CONCAT(CASE WHEN BASICADD.PLAN_ID IS NULL THEN '' ELSE 'A' END, SPACE(1)), 1) AS [Salary Mode - 3],
RIGHT(CONCAT(space(8),''), 7) AS [Salary Amount - 3],

LEFT(CONCAT(CASE WHEN LTD.PLAN_ID IS NULL THEN '' ELSE 'LT' END, SPACE(2)), 2) AS [Coverage Code - 4], --LTD
LEFT(CONCAT(FORMAT(LTD.PLAN_FROM_DATE,'MMddyyyy'), SPACE(8)), 8) AS [Coverage Start Date - 4],
LEFT(CONCAT(CASE WHEN LTD.LAST_DAY_OF_COVERAGE < '9999-12-31' THEN FORMAT(LTD.LAST_DAY_OF_COVERAGE, 'MMddyyyy') else '' end, SPACE(8)), 8) AS [Coverage Stop Date - 4],
LEFT(CONCAT(CASE WHEN LTD.PLAN_ID IS NULL THEN '' ELSE '5393668' END, SPACE(7)), 7) AS [Group Number - 4],
LEFT(CONCAT(CASE WHEN LTD.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Subcode - 4],
LEFT(CONCAT(CASE WHEN LTD.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Branch - 4],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT(CASE WHEN LTD.PLAN_ID IS NULL THEN '' ELSE 'A' END, SPACE(1)), 1) AS [Status Code - 4],
LEFT(CONCAT(CASE WHEN LTD.PLAN_ID IS NULL THEN '' ELSE '1' END, SPACE(1)), 1) AS [Members Covered Code - 4],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
RIGHT(CONCAT(space(8),''), 8) AS [Monthly Benefit Amount - 4],
LEFT(CONCAT(CASE WHEN LTD.PLAN_ID IS NULL THEN '' ELSE 'A' END, SPACE(1)), 1) AS [Salary Mode - 4],
RIGHT(CONCAT(space(8),''), 7) AS [Salary Amount - 4],




LEFT(CONCAT(CASE WHEN STD.PLAN_ID IS NULL THEN '' ELSE 'AS' END, SPACE(2)), 2) AS [Coverage Code - 5], --STD
LEFT(CONCAT(FORMAT(STD.PLAN_FROM_DATE,'MMddyyyy'), SPACE(8)), 8) AS [Coverage Start Date - 5],
LEFT(CONCAT(CASE WHEN STD.LAST_DAY_OF_COVERAGE < '9999-12-31' THEN FORMAT(STD.LAST_DAY_OF_COVERAGE, 'MMddyyyy') else '' end, SPACE(8)), 8) AS [Coverage Stop Date - 5],
LEFT(CONCAT(CASE WHEN STD.PLAN_ID IS NULL THEN '' ELSE '318031' END, SPACE(7)), 7) AS [Group Number - 5],
LEFT(CONCAT(CASE WHEN STD.PLAN_ID IS NULL THEN '' ELSE '0002' END, SPACE(4)), 4) AS [Subcode - 5],
LEFT(CONCAT(CASE WHEN STD.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Branch - 5],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT(CASE WHEN STD.PLAN_ID IS NULL THEN '' ELSE 'A' END, SPACE(1)), 1) AS [Status Code - 5],
LEFT(CONCAT(CASE WHEN STD.PLAN_ID IS NULL THEN '' ELSE 'I' END, SPACE(1)), 1) AS [Members Covered Code - 5],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
RIGHT(CONCAT(space(8),''), 8) AS [Weekly Benefit Amount - 5],--#todo: std benefit amount
LEFT(CONCAT(CASE WHEN STD.PLAN_ID IS NULL THEN '' ELSE 'A' END, SPACE(1)), 1) AS [Salary Mode - 5],
RIGHT(CONCAT(space(8),''), 7) AS [Salary Amount - 5],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 6],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 6],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 6],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 6],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 6],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 6],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT('', SPACE(1)), 1) AS [Status Code - 6],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 6],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
LEFT(CONCAT('', SPACE(8)), 8) AS [Annual Benefit Amount - 6],
LEFT(CONCAT('', SPACE(8)), 8) AS [Filler],

LEFT(CONCAT(CASE WHEN SUPPLIFE.PLAN_ID IS NULL THEN '' ELSE 'OP' END, SPACE(2)), 2) AS [Coverage Code - 7], --SUPPLIFE
LEFT(CONCAT(FORMAT(SUPPLIFE.PLAN_FROM_DATE,'MMddyyyy'), SPACE(8)), 8) AS [Coverage Start Date - 7],
LEFT(CONCAT(CASE WHEN SUPPLIFE.LAST_DAY_OF_COVERAGE < '9999-12-31' THEN FORMAT(SUPPLIFE.LAST_DAY_OF_COVERAGE, 'MMddyyyy') else '' end, SPACE(8)), 8) AS [Coverage Stop Date - 7],
LEFT(CONCAT(CASE WHEN SUPPLIFE.PLAN_ID IS NULL THEN '' ELSE '5393668' END, SPACE(7)), 7) AS [Group Number - 7],
LEFT(CONCAT(CASE WHEN SUPPLIFE.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Subcode - 7],
LEFT(CONCAT(CASE WHEN SUPPLIFE.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Branch - 7],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT(CASE WHEN SUPPLIFE.PLAN_ID IS NULL THEN '' ELSE 'A' END, SPACE(1)), 1) AS [Status Code - 7],
LEFT(CONCAT(CASE WHEN SUPPLIFE.PLAN_ID IS NULL THEN '' ELSE 'I' END, SPACE(1)), 1) AS [Members Covered Code - 7],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
RIGHT(CONCAT(space(8),''), 8) AS [Annual Benefit Amount - 7],
LEFT(CONCAT(CASE WHEN SUPPLIFE.PLAN_ID IS NULL THEN '' ELSE 'A' END, SPACE(1)), 1) AS [Salary Mode - 7],
RIGHT(CONCAT(space(8),''), 7) AS [Salary Amount - 7],

LEFT(CONCAT(CASE WHEN SPOUSELIFE.PLAN_ID IS NULL THEN '' ELSE 'LZ' END, SPACE(2)), 2) AS [Coverage Code - 8], --SPOUSELIFE
LEFT(CONCAT(FORMAT(SPOUSELIFE.PLAN_FROM_DATE,'MMddyyyy'), SPACE(8)), 8) AS [Coverage Start Date - 8],
LEFT(CONCAT(CASE WHEN SPOUSELIFE.LAST_DAY_OF_COVERAGE < '9999-12-31' THEN FORMAT(SPOUSELIFE.LAST_DAY_OF_COVERAGE, 'MMddyyyy') else '' end, SPACE(8)), 8) AS [Coverage Stop Date - 8],
LEFT(CONCAT(CASE WHEN SPOUSELIFE.PLAN_ID IS NULL THEN '' ELSE '5393668' END, SPACE(7)), 7) AS [Group Number - 8],
LEFT(CONCAT(CASE WHEN SPOUSELIFE.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Subcode - 8],
LEFT(CONCAT(CASE WHEN SPOUSELIFE.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Branch - 8],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT(CASE WHEN SPOUSELIFE.PLAN_ID IS NULL THEN '' ELSE 'A' END, SPACE(1)), 1) AS [Status Code - 8],
LEFT(CONCAT(CASE WHEN SPOUSELIFE.PLAN_ID IS NULL THEN '' ELSE 'A' END, SPACE(1)), 1) AS [Members Covered Code - 8],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
RIGHT(CONCAT('0000000000',CAST(SPOUSELIFE.FINAL_BENEFIT_AMOUNT AS INT), CASE WHEN SPOUSELIFE.PLAN_ID IS NULL THEN '          ' ELSE '' END), 8) AS [Annual Benefit Amount - 8],
LEFT(CONCAT('', SPACE(8)), 8) AS [Filler],

LEFT(CONCAT(CASE WHEN CHILDLIFE.PLAN_ID IS NULL THEN '' ELSE 'LF' END, SPACE(2)), 2) AS [Coverage Code - 9], --CHILDLIFE
LEFT(CONCAT(FORMAT(CHILDLIFE.PLAN_FROM_DATE,'MMddyyyy'), SPACE(8)), 8) AS [Coverage Start Date - 9],
LEFT(CONCAT(CASE WHEN CHILDLIFE.LAST_DAY_OF_COVERAGE < '9999-12-31' THEN FORMAT(CHILDLIFE.LAST_DAY_OF_COVERAGE, 'MMddyyyy') else '' end, SPACE(8)), 8) AS [Coverage Stop Date - 9],
LEFT(CONCAT(CASE WHEN CHILDLIFE.PLAN_ID IS NULL THEN '' ELSE '5393668' END, SPACE(7)), 7) AS [Group Number - 9],
LEFT(CONCAT(CASE WHEN CHILDLIFE.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Subcode - 9],
LEFT(CONCAT(CASE WHEN CHILDLIFE.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Branch - 9],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT(CASE WHEN CHILDLIFE.PLAN_ID IS NULL THEN '' ELSE 'A' END, SPACE(1)), 1) AS [Status Code - 9],
LEFT(CONCAT(CASE WHEN CHILDLIFE.PLAN_ID IS NULL THEN '' ELSE 'C' END, SPACE(1)), 1) AS [Members Covered Code - 9],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
RIGHT(CONCAT('0000000000',CAST(CHILDLIFE.FINAL_BENEFIT_AMOUNT AS INT), CASE WHEN CHILDLIFE.PLAN_ID IS NULL THEN '          ' ELSE '' END), 8) AS [Annual Benefit Amount - 9],
LEFT(CONCAT('', SPACE(8)), 8) AS [Filler],

LEFT(CONCAT(CASE WHEN SUPPADD.PLAN_ID IS NULL THEN '' ELSE 'OD' END, SPACE(2)), 2) AS [Coverage Code - 10], --SUPPADD
LEFT(CONCAT(FORMAT(SUPPADD.PLAN_FROM_DATE,'MMddyyyy'), SPACE(8)), 8) AS [Coverage Start Date - 10],
LEFT(CONCAT(CASE WHEN SUPPADD.LAST_DAY_OF_COVERAGE < '9999-12-31' THEN FORMAT(SUPPADD.LAST_DAY_OF_COVERAGE, 'MMddyyyy') else '' end, SPACE(8)), 8) AS [Coverage Stop Date - 10],
LEFT(CONCAT(CASE WHEN SUPPADD.PLAN_ID IS NULL THEN '' ELSE '5393668' END, SPACE(7)), 7) AS [Group Number - 10],
LEFT(CONCAT(CASE WHEN SUPPADD.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Subcode - 10],
LEFT(CONCAT(CASE WHEN SUPPADD.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Branch - 10],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT(CASE WHEN SUPPADD.PLAN_ID IS NULL THEN '' ELSE 'A' END, SPACE(1)), 1) AS [Status Code - 10],
LEFT(CONCAT(CASE WHEN SUPPADD.PLAN_ID IS NULL THEN '' ELSE 'I' END, SPACE(1)), 1) AS [Members Covered Code - 10],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
RIGHT(CONCAT(space(8),''), 8) AS [Annual Benefit Amount - 10],
LEFT(CONCAT(CASE WHEN SUPPADD.PLAN_ID IS NULL THEN '' ELSE 'A' END, SPACE(1)), 1) AS [Salary Mode - 10],
RIGHT(CONCAT(space(8),''), 7) AS [Salary Amount - 10],

LEFT(CONCAT(CASE WHEN SPSUPPADD.PLAN_ID IS NULL THEN '' ELSE 'AE' END, SPACE(2)), 2) AS [Coverage Code - 11], --SPSUPPADD
LEFT(CONCAT(FORMAT(SPSUPPADD.PLAN_FROM_DATE,'MMddyyyy'), SPACE(8)), 8) AS [Coverage Start Date - 11],
LEFT(CONCAT(CASE WHEN SPSUPPADD.LAST_DAY_OF_COVERAGE < '9999-12-31' THEN FORMAT(SPSUPPADD.LAST_DAY_OF_COVERAGE, 'MMddyyyy') else '' end, SPACE(8)), 8) AS [Coverage Stop Date - 11],
LEFT(CONCAT(CASE WHEN SPSUPPADD.PLAN_ID IS NULL THEN '' ELSE '5393668' END, SPACE(7)), 7) AS [Group Number - 11],
LEFT(CONCAT(CASE WHEN SPSUPPADD.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Subcode - 11],
LEFT(CONCAT(CASE WHEN SPSUPPADD.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Branch - 11],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT(CASE WHEN SPSUPPADD.PLAN_ID IS NULL THEN '' ELSE 'A' END, SPACE(1)), 1) AS [Status Code - 11],
LEFT(CONCAT(CASE WHEN SPSUPPADD.PLAN_ID IS NULL THEN '' ELSE 'A' END, SPACE(1)), 1) AS [Members Covered Code - 11],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
RIGHT(CONCAT('0000000000',CAST(SPSUPPADD.FINAL_BENEFIT_AMOUNT AS INT), CASE WHEN SPSUPPADD.PLAN_ID IS NULL THEN '          ' ELSE '' END), 8) AS [Annual Benefit Amount - 11],
LEFT(CONCAT('', SPACE(8)), 8) AS [Filler],

LEFT(CONCAT(CASE WHEN CHILDADD.PLAN_ID IS NULL THEN '' ELSE 'AT' END, SPACE(2)), 2) AS [Coverage Code - 12], -- CHILDADD
LEFT(CONCAT(FORMAT(CHILDADD.PLAN_FROM_DATE,'MMddyyyy'), SPACE(8)), 8) AS [Coverage Start Date - 12],
LEFT(CONCAT(CASE WHEN CHILDADD.LAST_DAY_OF_COVERAGE < '9999-12-31' THEN FORMAT(CHILDADD.LAST_DAY_OF_COVERAGE, 'MMddyyyy') else '' end, SPACE(8)), 8) AS [Coverage Stop Date - 12],
LEFT(CONCAT(CASE WHEN CHILDADD.PLAN_ID IS NULL THEN '' ELSE '5393668' END, SPACE(7)), 7) AS [Group Number - 12],
LEFT(CONCAT(CASE WHEN CHILDADD.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Subcode - 12],
LEFT(CONCAT(CASE WHEN CHILDADD.PLAN_ID IS NULL THEN '' ELSE '0001' END, SPACE(4)), 4) AS [Branch - 12],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT(CASE WHEN CHILDADD.PLAN_ID IS NULL THEN '' ELSE 'A' END, SPACE(1)), 1) AS [Status Code - 12],
LEFT(CONCAT(CASE WHEN CHILDADD.PLAN_ID IS NULL THEN '' ELSE 'C' END, SPACE(1)), 1) AS [Members Covered Code - 12],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
RIGHT(CONCAT('0000000000',CAST(CHILDADD.FINAL_BENEFIT_AMOUNT AS INT), CASE WHEN CHILDADD.PLAN_ID IS NULL THEN '          ' ELSE '' END), 8) AS [Annual Benefit Amount - 12],
LEFT(CONCAT('', SPACE(8)), 8) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 13],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 13],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 13],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 13],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 13],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 13],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT('', SPACE(1)), 1) AS [Status Code - 13],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 13],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
LEFT(CONCAT('', SPACE(8)), 8) AS [Annual Benefit Amount - 13],
LEFT(CONCAT('', SPACE(8)), 8) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 14],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 14],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 14],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 14],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 14],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 14],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT('', SPACE(1)), 1) AS [Status Code - 14],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 14],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
LEFT(CONCAT('', SPACE(8)), 8) AS [Annual Benefit Amount - 14],
LEFT(CONCAT('', SPACE(11)), 11) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 15],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 15],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 15],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 15],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 15],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 15],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT('', SPACE(1)), 1) AS [Status Code - 15],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 15],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
LEFT(CONCAT('', SPACE(8)), 8) AS [Annual Benefit Amount - 15],
LEFT(CONCAT('', SPACE(8)), 8) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 16],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 16],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 16],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 16],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 16],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 16],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT('', SPACE(1)), 1) AS [Status Code - 16],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 16],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
LEFT(CONCAT('', SPACE(8)), 8) AS [Annual Benefit Amount - 16],
LEFT(CONCAT('', SPACE(8)), 8) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 17],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 17],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 17],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 17],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 17],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 17],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT('', SPACE(1)), 1) AS [Status Code - 17],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 17],
LEFT(CONCAT('', SPACE(2)), 2) AS [Cancel Reason - 17],
LEFT(CONCAT('', SPACE(23)), 23) AS [Filler],

LEFT(CONCAT('', SPACE(1)), 1) AS [Employee Status Code],
LEFT(CONCAT('', SPACE(8)), 8) AS [Status Code Effective Date],
LEFT(CONCAT('', SPACE(10)), 10) AS [Department Code],
LEFT(CONCAT('', SPACE(10)), 10) AS [Group ID],
LEFT(CONCAT('', SPACE(5)), 5) AS [Location ID],
LEFT(CONCAT('', SPACE(10)), 10) AS [Schedule ID],
LEFT(CONCAT('', SPACE(2)), 2) AS [Pay Frequency],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 18],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 18],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 18],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 18],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 18],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 18],
LEFT(CONCAT('', SPACE(1)), 1) AS [Status Code - 18],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 18],
LEFT(CONCAT('', SPACE(1)), 1) AS [Enrollment Status - 18],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 19],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 19],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 19],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 19],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 19],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 19],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 19],
LEFT(CONCAT('', SPACE(1)), 1) AS [Enrollment Status - 19],
LEFT(CONCAT('', SPACE(8)), 8) AS [Benefit Amount - 19],
LEFT(CONCAT('', SPACE(2)), 2) AS [Voluntary Cancellation Ind - 19],
LEFT(CONCAT('', SPACE(1)), 1) AS [Taveover Indicator - 19],
LEFT(CONCAT('', SPACE(9)), 9) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 20],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 20],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 20],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 20],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 20],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 20],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 20],
LEFT(CONCAT('', SPACE(1)), 1) AS [Enrollment Status - 20],
LEFT(CONCAT('', SPACE(8)), 8) AS [Benefit Amount - 20],
LEFT(CONCAT('', SPACE(2)), 2) AS [Voluntary Cancellation Ind - 20],
LEFT(CONCAT('', SPACE(8)), 8) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 21],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 21],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 21],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 21],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 21],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 21],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 21],
LEFT(CONCAT('', SPACE(1)), 1) AS [Enrollment Status - 21],
LEFT(CONCAT('', SPACE(3)), 3) AS [GPC Code],
LEFT(CONCAT('', SPACE(2)), 2) AS [Paypoint],
LEFT(CONCAT('', SPACE(3)), 3) AS [Payroll Deduction],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 22],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 22],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 22],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 22],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 22],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 22],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 22],
LEFT(CONCAT('', SPACE(1)), 1) AS [Enrollment Status - 22],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 23],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 23],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 23],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 23],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 23],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 23],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 23],
LEFT(CONCAT('', SPACE(1)), 1) AS [Enrollment Status - 23],
LEFT(CONCAT('', SPACE(2)), 2) AS [Voluntary Cancellation Ind - 23],
LEFT(CONCAT('', SPACE(1)), 1) AS [Takeover Indicator - 23],
LEFT(CONCAT('', SPACE(9)), 9) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 24],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 24],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 24],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 24],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 24],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 24],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 24],
LEFT(CONCAT('', SPACE(1)), 1) AS [Enrollment Status - 24],
LEFT(CONCAT('', SPACE(2)), 2) AS [Voluntary Cancellation Ind - 24],
LEFT(CONCAT('', SPACE(1)), 1) AS [Takeover Indicator - 24],
LEFT(CONCAT('', SPACE(9)), 9) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 25],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 25],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 25],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 25],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 25],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 25],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 25],
LEFT(CONCAT('', SPACE(1)), 1) AS [Enrollment Status - 25],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],

LEFT(CONCAT('', SPACE(95)), 95) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 27],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 27],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 27],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 27],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 27],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 27],
LEFT(CONCAT('', SPACE(1)), 1) AS [Status Code - 27],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 27],
LEFT(CONCAT('', SPACE(8)), 8) AS [Benefit Amount - 27],
LEFT(CONCAT('', SPACE(1)), 1) AS [Takeover Indicator - 27],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 28],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 28],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 28],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 28],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 28],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 28],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 28],
LEFT(CONCAT('', SPACE(1)), 1) AS [Enrollment Status - 28],
LEFT(CONCAT('', SPACE(8)), 8) AS [Benefit Amount - 28],
LEFT(CONCAT('', SPACE(2)), 2) AS [Voluntary Cancellation Ind - 28],
LEFT(CONCAT('', SPACE(1)), 1) AS [Takeover Indicator - 28],
LEFT(CONCAT('', SPACE(9)), 9) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 29],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 29],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 29],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 29],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 29],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 29],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 29],
LEFT(CONCAT('', SPACE(1)), 1) AS [Enrollment Status - 29],
LEFT(CONCAT('', SPACE(8)), 8) AS [Benefit Amount - 29],
LEFT(CONCAT('', SPACE(2)), 2) AS [Voluntary Cancellation Ind - 29],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 30],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 30],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 30],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 30],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 30],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 30],
LEFT(CONCAT('', SPACE(2)), 2) AS [Work State - 30],
LEFT(CONCAT('', SPACE(1)), 1) AS [Job Status Code (full time/part time indicator)],
LEFT(CONCAT('', SPACE(8)), 8) AS [Job Status (full time/part time) As of Date ]

FROM EMPLOYEE_VIEW EV
INNER JOIN EMPLOYEE_DEPENDENT_VIEW EDV
	ON EV.EMPLOYEE_UUID = EDV.EMPLOYEE_UUID
INNER JOIN EMPLOYEE_ADDRESS_DETAIL_VIEW AD
	ON AD.IS_PRIMARY = 'Y'
	AND AD.TO_DATE = '9999-12-31'
	AND AD.EMPLOYEE_UUID = EV.EMPLOYEE_UUID
LEFT JOIN EMPLOYEE_COVERAGE_DEPENDENT_COMBINED_VIEW DENTAL
	on ev.EMPLOYEE_UUID = DENTAL.EMPLOYEE_UUID
	AND DENTAL.EMPLOYEE_DEPENDENT_UUID = EDV.EMPLOYEE_DEPENDENT_UUID
	AND DENTAL.BENEFIT_ID = 'RETDENTAL'
	AND DENTAL.PLAN_ID NOT IN  ('WAIVE' , 'OPTOUT')
	AND (DENTAL.TO_DATE = '9999-12-31'
		OR (DENTAL.OPTION_CREATE_TRANSACTION_DATE > getdate() - @lookback
			AND (DENTAL.TO_DATE = (SELECT MAX(TO_DATE) FROM EMPLOYEE_COVERAGE_DEPENDENT_COMBINED_VIEW SUBCOV WHERE SUBCOV.EMPLOYEE_UUID = EV.EMPLOYEE_UUID AND SUBCOV.BENEFIT_UUID = DENTAL.BENEFIT_UUID))))
LEFT JOIN EMPLOYEE_COVERAGE_DEPENDENT_COMBINED_VIEW RETDENTAL
	on ev.EMPLOYEE_UUID = RETDENTAL.EMPLOYEE_UUID
	AND RETDENTAL.EMPLOYEE_DEPENDENT_UUID = EDV.EMPLOYEE_DEPENDENT_UUID
	AND RETDENTAL.BENEFIT_ID = 'RETDENTAL'
	AND RETDENTAL.PLAN_ID != 'WAIVE' 
	AND (RETDENTAL.TO_DATE = '1999-12-31'
		OR (RETDENTAL.OPTION_CREATE_TRANSACTION_DATE > getdate() - @lookback
			AND (RETDENTAL.TO_DATE = (SELECT MAX(TO_DATE) FROM EMPLOYEE_COVERAGE_DEPENDENT_COMBINED_VIEW SUBCOV WHERE SUBCOV.EMPLOYEE_UUID = EV.EMPLOYEE_UUID AND SUBCOV.BENEFIT_UUID = RETDENTAL.BENEFIT_UUID))))
LEFT JOIN EMPLOYEE_COVERAGE_DEPENDENT_COMBINED_VIEW BASICADD
	on ev.EMPLOYEE_UUID = BASICADD.EMPLOYEE_UUID
	AND BASICADD.EMPLOYEE_DEPENDENT_UUID = EDV.EMPLOYEE_DEPENDENT_UUID
	AND BASICADD.BENEFIT_ID = 'BASICADD'
	AND BASICADD.PLAN_ID != 'WAIVE' 
	AND (BASICADD.TO_DATE = '9999-12-31'
		OR (BASICADD.OPTION_CREATE_TRANSACTION_DATE > getdate() - @lookback
			AND (BASICADD.TO_DATE = (SELECT MAX(TO_DATE) FROM EMPLOYEE_COVERAGE_DEPENDENT_COMBINED_VIEW SUBCOV WHERE SUBCOV.EMPLOYEE_UUID = EV.EMPLOYEE_UUID AND SUBCOV.BENEFIT_UUID = BASICADD.BENEFIT_UUID))))
LEFT JOIN EMPLOYEE_COVERAGE_COMBINED_VIEW SPSUPPADD
	on ev.EMPLOYEE_UUID = SPSUPPADD.EMPLOYEE_UUID
	AND edv.DEPENDENT_RELATIONSHIP_ID IN ('S','DP')	AND 
	SPSUPPADD.BENEFIT_ID = 'SPSUPPADD'
	AND SPSUPPADD.PLAN_ID != 'WAIVE' 
	AND (SPSUPPADD.TO_DATE = '9999-12-31'
		OR (SPSUPPADD.OPTION_CREATE_TRANSACTION_DATE > getdate() - @lookback
			AND (SPSUPPADD.TO_DATE = (SELECT MAX(TO_DATE) FROM EMPLOYEE_COVERAGE_COMBINED_VIEW SUBCOV WHERE SUBCOV.EMPLOYEE_UUID = EV.EMPLOYEE_UUID AND SUBCOV.BENEFIT_UUID = SPSUPPADD.BENEFIT_UUID))))
LEFT JOIN EMPLOYEE_COVERAGE_COMBINED_VIEW CHILDADD
	on ev.EMPLOYEE_UUID = CHILDADD.EMPLOYEE_UUID
	AND edv.DEPENDENT_RELATIONSHIP_ID IN ('C','DPC')
	AND CHILDADD.BENEFIT_ID = 'CHILDADD'
	AND CHILDADD.PLAN_ID != 'WAIVE' 
	AND (CHILDADD.TO_DATE = '9999-12-31'
		OR (CHILDADD.OPTION_CREATE_TRANSACTION_DATE > getdate() - @lookback
			AND (CHILDADD.TO_DATE = (SELECT MAX(TO_DATE) FROM EMPLOYEE_COVERAGE_COMBINED_VIEW SUBCOV WHERE SUBCOV.EMPLOYEE_UUID = EV.EMPLOYEE_UUID AND SUBCOV.BENEFIT_UUID = CHILDADD.BENEFIT_UUID))))
LEFT JOIN EMPLOYEE_COVERAGE_DEPENDENT_COMBINED_VIEW SUPPADD
	on ev.EMPLOYEE_UUID = SUPPADD.EMPLOYEE_UUID
	AND SUPPADD.EMPLOYEE_DEPENDENT_UUID = EDV.EMPLOYEE_DEPENDENT_UUID
	AND SUPPADD.BENEFIT_ID = 'SUPPADD'
	AND SUPPADD.PLAN_ID != 'WAIVE' 
	AND (SUPPADD.TO_DATE = '9999-12-31'
		OR (SUPPADD.OPTION_CREATE_TRANSACTION_DATE > getdate() - @lookback
			AND (SUPPADD.TO_DATE = (SELECT MAX(TO_DATE) FROM EMPLOYEE_COVERAGE_DEPENDENT_COMBINED_VIEW SUBCOV WHERE SUBCOV.EMPLOYEE_UUID = EV.EMPLOYEE_UUID AND SUBCOV.BENEFIT_UUID = SUPPADD.BENEFIT_UUID))))
LEFT JOIN EMPLOYEE_COVERAGE_DEPENDENT_COMBINED_VIEW LTD
	on ev.EMPLOYEE_UUID = LTD.EMPLOYEE_UUID
	AND LTD.EMPLOYEE_DEPENDENT_UUID = EDV.EMPLOYEE_DEPENDENT_UUID
	AND LTD.BENEFIT_ID = 'LTD'
	AND LTD.PLAN_ID != 'WAIVE' 
	AND (LTD.TO_DATE = '9999-12-31'
		OR (LTD.OPTION_CREATE_TRANSACTION_DATE > getdate() - @lookback
			AND (LTD.TO_DATE = (SELECT MAX(TO_DATE) FROM EMPLOYEE_COVERAGE_DEPENDENT_COMBINED_VIEW SUBCOV WHERE SUBCOV.EMPLOYEE_UUID = EV.EMPLOYEE_UUID AND SUBCOV.BENEFIT_UUID = LTD.BENEFIT_UUID))))
LEFT JOIN EMPLOYEE_COVERAGE_DEPENDENT_COMBINED_VIEW BASICLIFE
	on ev.EMPLOYEE_UUID = BASICLIFE.EMPLOYEE_UUID
	AND BASICLIFE.EMPLOYEE_DEPENDENT_UUID = EDV.EMPLOYEE_DEPENDENT_UUID
	AND BASICLIFE.BENEFIT_ID = 'BASICLIFE'
	AND BASICLIFE.PLAN_ID != 'WAIVE' 
	AND (BASICLIFE.TO_DATE = '9999-12-31'
		OR (BASICLIFE.OPTION_CREATE_TRANSACTION_DATE > getdate() - @lookback
			AND (BASICLIFE.TO_DATE = (SELECT MAX(TO_DATE) FROM EMPLOYEE_COVERAGE_DEPENDENT_COMBINED_VIEW SUBCOV WHERE SUBCOV.EMPLOYEE_UUID = EV.EMPLOYEE_UUID AND SUBCOV.BENEFIT_UUID = BASICLIFE.BENEFIT_UUID))))
LEFT JOIN EMPLOYEE_COVERAGE_COMBINED_VIEW SPOUSELIFE
	on ev.EMPLOYEE_UUID = SPOUSELIFE.EMPLOYEE_UUID
	AND edv.DEPENDENT_RELATIONSHIP_ID IN ('S','DP')
	AND SPOUSELIFE.BENEFIT_ID = 'SPOUSELIFE'
	AND SPOUSELIFE.PLAN_ID != 'WAIVE' 
	AND (SPOUSELIFE.TO_DATE = '9999-12-31'
		OR (SPOUSELIFE.OPTION_CREATE_TRANSACTION_DATE > getdate() - @lookback
			AND (SPOUSELIFE.TO_DATE = (SELECT MAX(TO_DATE) FROM EMPLOYEE_COVERAGE_COMBINED_VIEW SUBCOV WHERE SUBCOV.EMPLOYEE_UUID = EV.EMPLOYEE_UUID AND SUBCOV.BENEFIT_UUID = SPOUSELIFE.BENEFIT_UUID))))
LEFT JOIN EMPLOYEE_COVERAGE_COMBINED_VIEW CHILDLIFE
	on ev.EMPLOYEE_UUID = CHILDLIFE.EMPLOYEE_UUID
	AND edv.DEPENDENT_RELATIONSHIP_ID IN ('C','DPC')
	AND CHILDLIFE.BENEFIT_ID = 'CHILDLIFE'
	AND CHILDLIFE.PLAN_ID != 'WAIVE' 
	AND (CHILDLIFE.TO_DATE = '9999-12-31'
		OR (CHILDLIFE.OPTION_CREATE_TRANSACTION_DATE > getdate() - @lookback
			AND (CHILDLIFE.TO_DATE = (SELECT MAX(TO_DATE) FROM EMPLOYEE_COVERAGE_COMBINED_VIEW SUBCOV WHERE SUBCOV.EMPLOYEE_UUID = EV.EMPLOYEE_UUID AND SUBCOV.BENEFIT_UUID = CHILDLIFE.BENEFIT_UUID))))
LEFT JOIN EMPLOYEE_COVERAGE_DEPENDENT_COMBINED_VIEW SUPPLIFE
	on ev.EMPLOYEE_UUID = SUPPLIFE.EMPLOYEE_UUID
	AND SUPPLIFE.EMPLOYEE_DEPENDENT_UUID = EDV.EMPLOYEE_DEPENDENT_UUID
	AND SUPPLIFE.BENEFIT_ID = 'SUPPLIFE'
	AND SUPPLIFE.PLAN_ID != 'WAIVE' 
	AND (SUPPLIFE.TO_DATE = '9999-12-31'
		OR (SUPPLIFE.OPTION_CREATE_TRANSACTION_DATE > getdate() - @lookback
			AND (SUPPLIFE.TO_DATE = (SELECT MAX(TO_DATE) FROM EMPLOYEE_COVERAGE_DEPENDENT_COMBINED_VIEW SUBCOV WHERE SUBCOV.EMPLOYEE_UUID = EV.EMPLOYEE_UUID AND SUBCOV.BENEFIT_UUID = SUPPLIFE.BENEFIT_UUID))))
LEFT JOIN EMPLOYEE_COVERAGE_DEPENDENT_COMBINED_VIEW STD
	on ev.EMPLOYEE_UUID = STD.EMPLOYEE_UUID
	AND STD.EMPLOYEE_DEPENDENT_UUID = EDV.EMPLOYEE_DEPENDENT_UUID
	AND STD.BENEFIT_ID = 'STD'
	AND STD.PLAN_ID != 'WAIVE' 
	AND (STD.TO_DATE = '9999-12-31'
		OR (STD.OPTION_CREATE_TRANSACTION_DATE > getdate() - @lookback
			AND (STD.TO_DATE = (SELECT MAX(TO_DATE) FROM EMPLOYEE_COVERAGE_DEPENDENT_COMBINED_VIEW SUBCOV WHERE SUBCOV.EMPLOYEE_UUID = EV.EMPLOYEE_UUID AND SUBCOV.BENEFIT_UUID = STD.BENEFIT_UUID))))

LEFT JOIN EMPLOYEE_ATTRIBUTE_PROCESSED_VALUE_DETAIL_VIEW ATT1
	ON ATT1.EMPLOYEE_UUID = EV.EMPLOYEE_UUID
	AND ATT1.EMPLOYEE_ATTRIBUTE_ID = 'latesthredate'
	AND ATT1.TO_DATE = '9999-12-31'

LEFT JOIN EMPLOYEE_ATTRIBUTE_PROCESSED_VALUE_DETAIL_VIEW ATT2
	ON ATT2.EMPLOYEE_UUID = EV.EMPLOYEE_UUID
	AND ATT2.EMPLOYEE_ATTRIBUTE_ID = 'CURRENTSALARY'
	AND ATT2.TO_DATE = '9999-12-31'

LEFT JOIN EMPLOYEE_ATTRIBUTE_PROCESSED_VALUE_DETAIL_VIEW ATT3
	ON ATT3.EMPLOYEE_UUID = EV.EMPLOYEE_UUID
	AND ATT3.EMPLOYEE_ATTRIBUTE_ID = ''
	AND ATT3.TO_DATE = '9999-12-31'

LEFT JOIN EMPLOYEE_ATTRIBUTE_PROCESSED_VALUE_DETAIL_VIEW ATT4
	ON ATT4.EMPLOYEE_UUID = EV.EMPLOYEE_UUID
	AND ATT4.EMPLOYEE_ATTRIBUTE_ID = ''
	AND ATT4.TO_DATE = '9999-12-31'

LEFT JOIN EMPLOYEE_ATTRIBUTE_PROCESSED_VALUE_DETAIL_VIEW ATT5
	ON ATT5.EMPLOYEE_UUID = EV.EMPLOYEE_UUID
	AND ATT5.EMPLOYEE_ATTRIBUTE_ID = ''
	AND ATT5.TO_DATE = '9999-12-31'

LEFT JOIN EMPLOYEE_ATTRIBUTE_PROCESSED_VALUE_DETAIL_VIEW ATT6
	ON ATT6.EMPLOYEE_UUID = EV.EMPLOYEE_UUID
	AND ATT6.EMPLOYEE_ATTRIBUTE_ID = ''
	AND ATT6.TO_DATE = '9999-12-31'

where 1=1
and (dental.ssn is not null
	or RETDENTAL.ssn is not null
	or SPSUPPADD.ssn is not null
	or basicadd.ssn is not null
	or childadd.ssn is not null
	or suppadd.SSN is not null
	or ltd.SSN is not null
	or basiclife.SSN is not null
	or spouselife.SSN is not null
	or childlife.SSN is not null
	or supplife.SSN is not null
	or std.SSN is not null
)
and ev.EMPLOYEE_UUID in (select EMPLOYEE_UUID from EMPLOYEE_ATTRIBUTE_PROCESSED_VALUE_DETAIL_VIEW where to_date = '9999-12-31' and EMPLOYEE_ATTRIBUTE_ID = 'retiree' and STRING_VALUE = 'y')

UNION ALL

--COBRA LOGIC

select top 10000
	
--EMPLOYEE RECORDS

LEFT(CONCAT('E', SPACE(1)), 1) AS [Transaction Code],
LEFT(CONCAT('5393668', SPACE(7)), 7) AS [Customer Number],
LEFT(CONCAT(ev.ssn, SPACE(11)), 11) AS [Employee Number],
LEFT(CONCAT('', SPACE(11)), 11) AS [Filler],
LEFT(CONCAT(ev.ssn, SPACE(9)), 9) AS [Member Social Security Number],
LEFT(CONCAT(ev.LastName, SPACE(20)), 20) AS [Member Last Name],
LEFT(CONCAT(ev.FirstName, SPACE(12)), 12) AS [Member First Name],
LEFT(CONCAT('', SPACE(1)), 1) AS [Member Middle Initial],
LEFT(CONCAT(format(ev.BIRTHDATE, 'MMddyyyy'), SPACE(8)), 8) AS [Member Date of Birth],
LEFT(CONCAT('U', SPACE(1)), 1) AS [Member Marital Status],
LEFT(CONCAT(ev.Gender, SPACE(1)), 1) AS [Member Gender],
LEFT(CONCAT('00', SPACE(2)), 2) AS [Relationship Code],
LEFT(CONCAT(FORMAT(ATT1.DATE_VALUE, 'MMddyyyy'), SPACE(8)), 8) AS [Employee's Date of Hire],
LEFT(CONCAT('', SPACE(11)), 11) AS [Personnel Identification],
LEFT(CONCAT('', SPACE(1)), 1) AS [Employee Smoker Code],
LEFT(CONCAT('', SPACE(1)), 1) AS [Spouse Smoker Code],
LEFT(CONCAT('', SPACE(10)), 10) AS [Phone Number],
LEFT(CONCAT('', SPACE(40)), 40) AS [Email Address],
LEFT(CONCAT('', SPACE(14)), 14) AS [Filler],
LEFT(CONCAT('D', SPACE(1)), 1) AS [Foreign Address Indicator],
LEFT(CONCAT('', SPACE(32)), 32) AS [Care of Address],
LEFT(CONCAT(ad.ADDRESS_1, SPACE(32)), 32) AS [Street Address],
LEFT(CONCAT(AD.CITY, SPACE(21)), 21) AS [City],
LEFT(CONCAT(AD.STATE, SPACE(2)), 2) AS [State],
LEFT(CONCAT(LEFT(AD.POSTAL_CODE,5), SPACE(9)), 9) AS [Zip Code],

LEFT(CONCAT(CASE WHEN DENTAL.PlanId IS NOT NULL THEN  'D' ELSE '' END, SPACE(2)), 2) AS [Coverage Code - 1],
LEFT(CONCAT(FORMAT(DENTAL.CoverageEffectiveDate, 'MMddyyyy'), SPACE(8)), 8) AS [Coverage Start Date - 1],
LEFT(CONCAT(CASE WHEN DENTAL.CoverageTerminationDate < '9999-12-31' THEN FORMAT(DENTAL.CoverageTerminationDate, 'MMddyyyy') else '' end, SPACE(8)), 8) AS [Coverage Stop Date - 1],
LEFT(CONCAT(CASE WHEN DENTAL.PlanId IS NOT NULL THEN  '5393668'  ELSE '' END, SPACE(7)), 7) AS [Group Number - 1],
LEFT(CONCAT(CASE WHEN DENTAL.PlanId IS  NULL THEN '' WHEN DENTAL.PlanId IS NOT NULL THEN  '0001' ELSE '' END, SPACE(4)), 4) AS [Subcode - 1],
LEFT(CONCAT(CASE WHEN DENTAL.PlanId IS  NULL THEN '' WHEN DENTAL.BenefitId = 'RETDENTAL' THEN '0002' ELSE '0001' END, SPACE(4)), 4) AS [Branch - 1],
LEFT(CONCAT('', SPACE(2)), 2) AS [Plan Code - 1],
LEFT(CONCAT(CASE WHEN DENTAL.PlanId IS  NULL THEN '' WHEN  DENTAL.BenefitId = 'RETDENTAL' THEN 'R' ELSE 'A' END, SPACE(1)), 1) AS [Status Code - 1],
LEFT(CONCAT(CASE WHEN DENTAL.TierOptionId = 'EE' THEN '1'
					WHEN DENTAL.TierOptionId = 'EE+CHILDREN' THEN '2'
					WHEN DENTAL.TierOptionId = 'EE+SPOUSE' THEN '3'
					WHEN DENTAL.TierOptionId = 'EE+FAMILY' THEN '4'
					ELSE DENTAL.TierOptionId
					END, SPACE(10)), 1) AS [Members Covered Code - 1],
LEFT(CONCAT('', SPACE(2)), 2) AS [Cancel Reason - 1],
LEFT(CONCAT('', SPACE(1)), 1) AS [Filler],
LEFT(CONCAT('', SPACE(8)), 8) AS [Facility ID],
LEFT(CONCAT('', SPACE(15)), 15) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 2],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 2],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 2],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 2],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 2],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 2],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT('', SPACE(1)), 1) AS [Status Code - 2],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 2],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
RIGHT(CONCAT('0000000000',''), 8) AS [Annual Benefit Amount - 2],
LEFT(CONCAT('', SPACE(1)), 1) AS [Salary Mode - 2],
RIGHT(CONCAT('0000000000',''), 7) AS [Salary Amount - 2],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 3],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 3],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 3],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 3],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 3],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 3],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT('', SPACE(1)), 1) AS [Status Code - 3],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 3],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
RIGHT(CONCAT('0000000000',''), 8) AS [Annual Benefit Amount - 3],
LEFT(CONCAT('', SPACE(1)), 1) AS [Salary Mode - 3],
RIGHT(CONCAT('0000000000',''), 7) AS [Salary Amount - 3],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 4], --LTD
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 4],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 4],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 4],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 4],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 4],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT('', SPACE(1)), 1) AS [Status Code - 4],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 4],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
RIGHT(CONCAT('0000000000',''), 8) AS [Monthly Benefit Amount - 4],
LEFT(CONCAT('', SPACE(1)), 1) AS [Salary Mode - 4],
RIGHT(CONCAT('0000000000',''), 7) AS [Salary Amount - 4],




LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 5], --STD
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 5],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 5],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 5],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 5],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 5],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT('', SPACE(1)), 1) AS [Status Code - 5],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 5],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
RIGHT(CONCAT('0000000000',''), 8) AS [Weekly Benefit Amount - 5],--#todo: std benefit amount
LEFT(CONCAT('', SPACE(1)), 1) AS [Salary Mode - 5],
RIGHT(CONCAT( '0000000000',''), 7) AS [Salary Amount - 5],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 6],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 6],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 6],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 6],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 6],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 6],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT('', SPACE(1)), 1) AS [Status Code - 6],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 6],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
LEFT(CONCAT('', SPACE(8)), 8) AS [Annual Benefit Amount - 6],
LEFT(CONCAT('', SPACE(8)), 8) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 7], --SUPPLIFE
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 7],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 7],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 7],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 7],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 7],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT('', SPACE(1)), 1) AS [Status Code - 7],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 7],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
RIGHT(CONCAT('0000000000',''), 8) AS [Annual Benefit Amount - 7],
LEFT(CONCAT('', SPACE(1)), 1) AS [Salary Mode - 7],
RIGHT(CONCAT('0000000000',''), 7) AS [Salary Amount - 7],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 8], --SPOUSELIFE
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 8],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 8],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 8],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 8],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 8],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT('', SPACE(1)), 1) AS [Status Code - 8],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 8],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
RIGHT(CONCAT('0000000000',''), 8) AS [Annual Benefit Amount - 8],
LEFT(CONCAT('', SPACE(8)), 8) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 9], --CHILDLIFE
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 9],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 9],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 9],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 9],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 9],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT('', SPACE(1)), 1) AS [Status Code - 9],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 9],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
RIGHT(CONCAT('0000000000',''), 8) AS [Annual Benefit Amount - 9],
LEFT(CONCAT('', SPACE(8)), 8) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 10], --SUPPADD
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 10],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 10],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 10],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 10],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 10],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT('', SPACE(1)), 1) AS [Status Code - 10],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 10],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
RIGHT(CONCAT('0000000000',''), 8) AS [Annual Benefit Amount - 10],
LEFT(CONCAT('', SPACE(1)), 1) AS [Salary Mode - 10],
RIGHT(CONCAT('0000000000',''), 7) AS [Salary Amount - 10],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 11], --SPSUPPADD
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 11],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 11],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 11],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 11],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 11],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT('', SPACE(1)), 1) AS [Status Code - 11],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 11],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
RIGHT(CONCAT('0000000000',''), 8) AS [Annual Benefit Amount - 11],
LEFT(CONCAT('', SPACE(8)), 8) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 12], -- CHILDADD
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 12],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 12],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 12],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 12],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 12],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT('', SPACE(1)), 1) AS [Status Code - 12],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 12],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
RIGHT(CONCAT('0000000000',''), 8) AS [Annual Benefit Amount - 12],
LEFT(CONCAT('', SPACE(8)), 8) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 13],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 13],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 13],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 13],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 13],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 13],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT('', SPACE(1)), 1) AS [Status Code - 13],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 13],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
LEFT(CONCAT('', SPACE(8)), 8) AS [Annual Benefit Amount - 13],
LEFT(CONCAT('', SPACE(8)), 8) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 14],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 14],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 14],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 14],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 14],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 14],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT('', SPACE(1)), 1) AS [Status Code - 14],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 14],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
LEFT(CONCAT('', SPACE(8)), 8) AS [Annual Benefit Amount - 14],
LEFT(CONCAT('', SPACE(11)), 11) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 15],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 15],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 15],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 15],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 15],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 15],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT('', SPACE(1)), 1) AS [Status Code - 15],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 15],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
LEFT(CONCAT('', SPACE(8)), 8) AS [Annual Benefit Amount - 15],
LEFT(CONCAT('', SPACE(8)), 8) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 16],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 16],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 16],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 16],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 16],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 16],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT('', SPACE(1)), 1) AS [Status Code - 16],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 16],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
LEFT(CONCAT('', SPACE(8)), 8) AS [Annual Benefit Amount - 16],
LEFT(CONCAT('', SPACE(8)), 8) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 17],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 17],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 17],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 17],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 17],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 17],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT('', SPACE(1)), 1) AS [Status Code - 17],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 17],
LEFT(CONCAT('', SPACE(2)), 2) AS [Cancel Reason - 17],
LEFT(CONCAT('', SPACE(23)), 23) AS [Filler],

LEFT(CONCAT('', SPACE(1)), 1) AS [Employee Status Code],
LEFT(CONCAT('', SPACE(8)), 8) AS [Status Code Effective Date],
LEFT(CONCAT('', SPACE(10)), 10) AS [Department Code],
LEFT(CONCAT('', SPACE(10)), 10) AS [Group ID],
LEFT(CONCAT('', SPACE(5)), 5) AS [Location ID],
LEFT(CONCAT('', SPACE(10)), 10) AS [Schedule ID],
LEFT(CONCAT('', SPACE(2)), 2) AS [Pay Frequency],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 18],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 18],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 18],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 18],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 18],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 18],
LEFT(CONCAT('', SPACE(1)), 1) AS [Status Code - 18],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 18],
LEFT(CONCAT('', SPACE(1)), 1) AS [Enrollment Status - 18],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 19],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 19],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 19],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 19],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 19],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 19],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 19],
LEFT(CONCAT('', SPACE(1)), 1) AS [Enrollment Status - 19],
LEFT(CONCAT('', SPACE(8)), 8) AS [Benefit Amount - 19],
LEFT(CONCAT('', SPACE(2)), 2) AS [Voluntary Cancellation Ind - 19],
LEFT(CONCAT('', SPACE(1)), 1) AS [Taveover Indicator - 19],
LEFT(CONCAT('', SPACE(9)), 9) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 20],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 20],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 20],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 20],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 20],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 20],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 20],
LEFT(CONCAT('', SPACE(1)), 1) AS [Enrollment Status - 20],
LEFT(CONCAT('', SPACE(8)), 8) AS [Benefit Amount - 20],
LEFT(CONCAT('', SPACE(2)), 2) AS [Voluntary Cancellation Ind - 20],
LEFT(CONCAT('', SPACE(8)), 8) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 21],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 21],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 21],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 21],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 21],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 21],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 21],
LEFT(CONCAT('', SPACE(1)), 1) AS [Enrollment Status - 21],
LEFT(CONCAT('', SPACE(3)), 3) AS [GPC Code],
LEFT(CONCAT('', SPACE(2)), 2) AS [Paypoint],
LEFT(CONCAT('', SPACE(3)), 3) AS [Payroll Deduction],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 22],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 22],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 22],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 22],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 22],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 22],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 22],
LEFT(CONCAT('', SPACE(1)), 1) AS [Enrollment Status - 22],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 23],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 23],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 23],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 23],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 23],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 23],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 23],
LEFT(CONCAT('', SPACE(1)), 1) AS [Enrollment Status - 23],
LEFT(CONCAT('', SPACE(2)), 2) AS [Voluntary Cancellation Ind - 23],
LEFT(CONCAT('', SPACE(1)), 1) AS [Takeover Indicator - 23],
LEFT(CONCAT('', SPACE(9)), 9) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 24],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 24],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 24],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 24],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 24],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 24],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 24],
LEFT(CONCAT('', SPACE(1)), 1) AS [Enrollment Status - 24],
LEFT(CONCAT('', SPACE(2)), 2) AS [Voluntary Cancellation Ind - 24],
LEFT(CONCAT('', SPACE(1)), 1) AS [Takeover Indicator - 24],
LEFT(CONCAT('', SPACE(9)), 9) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 25],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 25],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 25],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 25],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 25],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 25],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 25],
LEFT(CONCAT('', SPACE(1)), 1) AS [Enrollment Status - 25],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],

LEFT(CONCAT('', SPACE(95)), 95) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 27],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 27],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 27],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 27],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 27],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 27],
LEFT(CONCAT('', SPACE(1)), 1) AS [Status Code - 27],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 27],
LEFT(CONCAT('', SPACE(8)), 8) AS [Benefit Amount - 27],
LEFT(CONCAT('', SPACE(1)), 1) AS [Takeover Indicator - 27],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 28],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 28],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 28],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 28],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 28],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 28],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 28],
LEFT(CONCAT('', SPACE(1)), 1) AS [Enrollment Status - 28],
LEFT(CONCAT('', SPACE(8)), 8) AS [Benefit Amount - 28],
LEFT(CONCAT('', SPACE(2)), 2) AS [Voluntary Cancellation Ind - 28],
LEFT(CONCAT('', SPACE(1)), 1) AS [Takeover Indicator - 28],
LEFT(CONCAT('', SPACE(9)), 9) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 29],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 29],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 29],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 29],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 29],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 29],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 29],
LEFT(CONCAT('', SPACE(1)), 1) AS [Enrollment Status - 29],
LEFT(CONCAT('', SPACE(8)), 8) AS [Benefit Amount - 29],
LEFT(CONCAT('', SPACE(2)), 2) AS [Voluntary Cancellation Ind - 29],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 30],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 30],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 30],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 30],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 30],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 30],
LEFT(CONCAT('', SPACE(2)), 2) AS [Work State - 30],
LEFT(CONCAT('', SPACE(1)), 1) AS [Job Status Code (full time/part time indicator)],
LEFT(CONCAT('', SPACE(8)), 8) AS [Job Status (full time/part time) As of Date ]

FROM [reporting_prodbhpmin].Cobra.vEmployeeCobraDemographics EV

LEFT JOIN EMPLOYEE_ADDRESS_DETAIL_VIEW AD
	ON AD.IS_PRIMARY = 'Y'
	AND AD.TO_DATE = '9999-12-31'
	AND AD.SSN = EV.SSN

LEFT JOIN [reporting_prodbhpmin].Cobra.vEmployeeCobraElections DENTAL
	on ev.SSN = DENTAL.SSN
	AND DENTAL.BenefitId = 'DENTAL'
	AND DENTAL.PlanId NOT IN  ('WAIVE' , 'OPTOUT')
	AND (DENTAL.EndDate IS NULL
		OR (DENTAL.EndDate > getdate() - @lookback
			AND (DENTAL.EndDate = (SELECT MAX(EndDate) FROM [reporting_prodbhpmin].Cobra.vEmployeeCobraElections SUBCOV WHERE SUBCOV.SSN = EV.SSN AND SUBCOV.BenefitId = DENTAL.BenefitId))))

LEFT JOIN EMPLOYEE_ATTRIBUTE_PROCESSED_VALUE_DETAIL_VIEW ATT1
	ON ATT1.SSN = EV.SSN
	AND ATT1.EMPLOYEE_ATTRIBUTE_ID = 'latesthiredate'
	AND ATT1.TO_DATE = '9999-12-31'

LEFT JOIN EMPLOYEE_ATTRIBUTE_PROCESSED_VALUE_DETAIL_VIEW ATT2
	ON ATT2.SSN = EV.SSN
	AND ATT2.EMPLOYEE_ATTRIBUTE_ID = 'CURRENTSALARY'
	AND ATT2.TO_DATE = '9999-12-31'

LEFT JOIN EMPLOYEE_ATTRIBUTE_PROCESSED_VALUE_DETAIL_VIEW ATT3
	ON ATT3.SSN = EV.SSN
	AND ATT3.EMPLOYEE_ATTRIBUTE_ID = ''
	AND ATT3.TO_DATE = '9999-12-31'

LEFT JOIN EMPLOYEE_ATTRIBUTE_PROCESSED_VALUE_DETAIL_VIEW ATT4
	ON ATT4.SSN = EV.SSN
	AND ATT4.EMPLOYEE_ATTRIBUTE_ID = ''
	AND ATT4.TO_DATE = '9999-12-31'

LEFT JOIN EMPLOYEE_ATTRIBUTE_PROCESSED_VALUE_DETAIL_VIEW ATT5
	ON ATT5.SSN = EV.SSN
	AND ATT5.EMPLOYEE_ATTRIBUTE_ID = ''
	AND ATT5.TO_DATE = '9999-12-31'

LEFT JOIN EMPLOYEE_ATTRIBUTE_PROCESSED_VALUE_DETAIL_VIEW ATT6
	ON ATT6.SSN = EV.SSN
	AND ATT6.EMPLOYEE_ATTRIBUTE_ID = ''
	AND ATT6.TO_DATE = '9999-12-31'

where 1=1
and (dental.ssn is not null
)

union all

select DISTINCT top 10000
	
--DEPENDENT RECORDS

LEFT(CONCAT('D', SPACE(1)), 1) AS [Transaction Code],
LEFT(CONCAT('5393668', SPACE(7)), 7) AS [Customer Number],
LEFT(CONCAT(ev.ssn, SPACE(11)), 11) AS [Employee Number],
LEFT(CONCAT('', SPACE(11)), 11) AS [Filler],
LEFT(CONCAT(edv.DepSSN, SPACE(9)), 9) AS [Member Social Security Number],
LEFT(CONCAT(edv.LastName, SPACE(20)), 20) AS [Member Last Name],
LEFT(CONCAT(edv.FirstName, SPACE(12)), 12) AS [Member First Name],
LEFT(CONCAT('', SPACE(1)), 1) AS [Member Middle Initial],
LEFT(CONCAT(format(edv.BIRTHDATE, 'MMddyyyy'), SPACE(8)), 8) AS [Member Date of Birth],
LEFT(CONCAT('U', SPACE(1)), 1) AS [Member Marital Status],
LEFT(CONCAT(edv.Gender, SPACE(1)), 1) AS [Member Gender],
LEFT(CONCAT(CASE WHEN EDV.Relation IN ('S','DP') THEN '01' ELSE '02' END, SPACE(2)), 2) AS [Relationship Code],
LEFT(CONCAT(FORMAT(ATT1.DATE_VALUE, 'MMddyyyy'), SPACE(8)), 8) AS [Employee's Date of Hire],
LEFT(CONCAT('', SPACE(11)), 11) AS [Personnel Identification],
LEFT(CONCAT('', SPACE(1)), 1) AS [Employee Smoker Code],
LEFT(CONCAT('', SPACE(1)), 1) AS [Spouse Smoker Code],
LEFT(CONCAT('', SPACE(10)), 10) AS [Phone Number],
LEFT(CONCAT('', SPACE(40)), 40) AS [Email Address],
LEFT(CONCAT('', SPACE(14)), 14) AS [Filler],
LEFT(CONCAT('D', SPACE(1)), 1) AS [Foreign Address Indicator],
LEFT(CONCAT('', SPACE(32)), 32) AS [Care of Address],
LEFT(CONCAT(ad.ADDRESS_1, SPACE(32)), 32) AS [Street Address],
LEFT(CONCAT(AD.CITY, SPACE(21)), 21) AS [City],
LEFT(CONCAT(AD.STATE, SPACE(2)), 2) AS [State],
LEFT(CONCAT(LEFT(AD.POSTAL_CODE,5), SPACE(9)), 9) AS [Zip Code],

LEFT(CONCAT(CASE WHEN DENTAL.PlanId IS NOT NULL THEN  'D' ELSE '' END, SPACE(2)), 2) AS [Coverage Code - 1],
LEFT(CONCAT(FORMAT(DENTAL.CoverageEffectiveDate, 'MMddyyyy'), SPACE(8)), 8) AS [Coverage Start Date - 1],
LEFT(CONCAT(CASE WHEN DENTAL.CoverageTerminationDate < '9999-12-31' THEN FORMAT(DENTAL.CoverageTerminationDate, 'MMddyyyy') else '' end, SPACE(8)), 8) AS [Coverage Stop Date - 1],
LEFT(CONCAT(CASE WHEN DENTAL.PlanId IS NOT NULL THEN  '5393668'  ELSE '' END, SPACE(7)), 7) AS [Group Number - 1],
LEFT(CONCAT(CASE WHEN DENTAL.PlanId IS  NULL THEN '' WHEN DENTAL.PlanId IS NOT NULL THEN  '0001' ELSE '' END, SPACE(4)), 4) AS [Subcode - 1],
LEFT(CONCAT(CASE WHEN DENTAL.PlanId IS  NULL THEN '' WHEN DENTAL.BenefitId = 'RETDENTAL' THEN '0002' ELSE '0001' END, SPACE(4)), 4) AS [Branch - 1],
LEFT(CONCAT('', SPACE(2)), 2) AS [Plan Code - 1],
LEFT(CONCAT(CASE WHEN DENTAL.PlanId IS  NULL THEN '' WHEN  DENTAL.BenefitId = 'RETDENTAL' THEN 'R' ELSE 'A' END, SPACE(1)), 1) AS [Status Code - 1],
LEFT(CONCAT(CASE WHEN DENTAL.TierOptionId = 'EE' THEN '1'
					WHEN DENTAL.TierOptionId = 'EE+CHILDREN' THEN '2'
					WHEN DENTAL.TierOptionId = 'EE+SPOUSE' THEN '3'
					WHEN DENTAL.TierOptionId = 'EE+FAMILY' THEN '4'
					ELSE DENTAL.TierOptionId
					END, SPACE(10)), 1) AS [Members Covered Code - 1],
LEFT(CONCAT('', SPACE(2)), 2) AS [Cancel Reason - 1],
LEFT(CONCAT('', SPACE(1)), 1) AS [Filler],
LEFT(CONCAT('', SPACE(8)), 8) AS [Facility ID],
LEFT(CONCAT('', SPACE(15)), 15) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 2],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 2],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 2],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 2],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 2],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 2],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT('', SPACE(1)), 1) AS [Status Code - 2],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 2],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
RIGHT(CONCAT('0000000000',''), 8) AS [Annual Benefit Amount - 2],
LEFT(CONCAT('', SPACE(1)), 1) AS [Salary Mode - 2],
RIGHT(CONCAT('0000000000',''), 7) AS [Salary Amount - 2],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 3],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 3],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 3],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 3],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 3],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 3],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT('', SPACE(1)), 1) AS [Status Code - 3],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 3],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
RIGHT(CONCAT('0000000000',''), 8) AS [Annual Benefit Amount - 3],
LEFT(CONCAT('', SPACE(1)), 1) AS [Salary Mode - 3],
RIGHT(CONCAT('0000000000',''), 7) AS [Salary Amount - 3],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 4], --LTD
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 4],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 4],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 4],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 4],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 4],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT('', SPACE(1)), 1) AS [Status Code - 4],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 4],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
RIGHT(CONCAT('0000000000',''), 8) AS [Monthly Benefit Amount - 4],
LEFT(CONCAT('', SPACE(1)), 1) AS [Salary Mode - 4],
RIGHT(CONCAT('0000000000',''), 7) AS [Salary Amount - 4],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 5], --STD
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 5],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 5],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 5],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 5],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 5],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT('', SPACE(1)), 1) AS [Status Code - 5],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 5],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
RIGHT(CONCAT('0000000000',''), 8) AS [Weekly Benefit Amount - 5],--#todo: std benefit amount
LEFT(CONCAT('', SPACE(1)), 1) AS [Salary Mode - 5],
RIGHT(CONCAT( '0000000000',''), 7) AS [Salary Amount - 5],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 6],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 6],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 6],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 6],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 6],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 6],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT('', SPACE(1)), 1) AS [Status Code - 6],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 6],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
LEFT(CONCAT('', SPACE(8)), 8) AS [Annual Benefit Amount - 6],
LEFT(CONCAT('', SPACE(8)), 8) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 7], --SUPPLIFE
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 7],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 7],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 7],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 7],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 7],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT('', SPACE(1)), 1) AS [Status Code - 7],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 7],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
RIGHT(CONCAT('0000000000',''), 8) AS [Annual Benefit Amount - 7],
LEFT(CONCAT('', SPACE(1)), 1) AS [Salary Mode - 7],
RIGHT(CONCAT('0000000000',''), 7) AS [Salary Amount - 7],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 8], --SPOUSELIFE
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 8],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 8],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 8],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 8],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 8],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT('', SPACE(1)), 1) AS [Status Code - 8],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 8],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
RIGHT(CONCAT('0000000000',''), 8) AS [Annual Benefit Amount - 8],
LEFT(CONCAT('', SPACE(8)), 8) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 9], --CHILDLIFE
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 9],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 9],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 9],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 9],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 9],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT('', SPACE(1)), 1) AS [Status Code - 9],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 9],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
RIGHT(CONCAT('0000000000',''), 8) AS [Annual Benefit Amount - 9],
LEFT(CONCAT('', SPACE(8)), 8) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 10], --SUPPADD
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 10],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 10],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 10],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 10],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 10],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT('', SPACE(1)), 1) AS [Status Code - 10],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 10],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
RIGHT(CONCAT('0000000000',''), 8) AS [Annual Benefit Amount - 10],
LEFT(CONCAT('', SPACE(1)), 1) AS [Salary Mode - 10],
RIGHT(CONCAT('0000000000',''), 7) AS [Salary Amount - 10],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 11], --SPSUPPADD
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 11],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 11],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 11],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 11],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 11],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT('', SPACE(1)), 1) AS [Status Code - 11],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 11],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
RIGHT(CONCAT('0000000000',''), 8) AS [Annual Benefit Amount - 11],
LEFT(CONCAT('', SPACE(8)), 8) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 12], -- CHILDADD
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 12],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 12],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 12],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 12],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 12],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT('', SPACE(1)), 1) AS [Status Code - 12],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 12],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
RIGHT(CONCAT('0000000000',''), 8) AS [Annual Benefit Amount - 12],
LEFT(CONCAT('', SPACE(8)), 8) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 13],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 13],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 13],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 13],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 13],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 13],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT('', SPACE(1)), 1) AS [Status Code - 13],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 13],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
LEFT(CONCAT('', SPACE(8)), 8) AS [Annual Benefit Amount - 13],
LEFT(CONCAT('', SPACE(8)), 8) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 14],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 14],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 14],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 14],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 14],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 14],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT('', SPACE(1)), 1) AS [Status Code - 14],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 14],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
LEFT(CONCAT('', SPACE(8)), 8) AS [Annual Benefit Amount - 14],
LEFT(CONCAT('', SPACE(11)), 11) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 15],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 15],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 15],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 15],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 15],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 15],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT('', SPACE(1)), 1) AS [Status Code - 15],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 15],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
LEFT(CONCAT('', SPACE(8)), 8) AS [Annual Benefit Amount - 15],
LEFT(CONCAT('', SPACE(8)), 8) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 16],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 16],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 16],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 16],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 16],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 16],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT('', SPACE(1)), 1) AS [Status Code - 16],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 16],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],
LEFT(CONCAT('', SPACE(8)), 8) AS [Annual Benefit Amount - 16],
LEFT(CONCAT('', SPACE(8)), 8) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 17],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 17],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 17],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 17],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 17],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 17],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],
LEFT(CONCAT('', SPACE(1)), 1) AS [Status Code - 17],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 17],
LEFT(CONCAT('', SPACE(2)), 2) AS [Cancel Reason - 17],
LEFT(CONCAT('', SPACE(23)), 23) AS [Filler],

LEFT(CONCAT('', SPACE(1)), 1) AS [Employee Status Code],
LEFT(CONCAT('', SPACE(8)), 8) AS [Status Code Effective Date],
LEFT(CONCAT('', SPACE(10)), 10) AS [Department Code],
LEFT(CONCAT('', SPACE(10)), 10) AS [Group ID],
LEFT(CONCAT('', SPACE(5)), 5) AS [Location ID],
LEFT(CONCAT('', SPACE(10)), 10) AS [Schedule ID],
LEFT(CONCAT('', SPACE(2)), 2) AS [Pay Frequency],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 18],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 18],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 18],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 18],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 18],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 18],
LEFT(CONCAT('', SPACE(1)), 1) AS [Status Code - 18],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 18],
LEFT(CONCAT('', SPACE(1)), 1) AS [Enrollment Status - 18],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 19],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 19],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 19],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 19],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 19],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 19],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 19],
LEFT(CONCAT('', SPACE(1)), 1) AS [Enrollment Status - 19],
LEFT(CONCAT('', SPACE(8)), 8) AS [Benefit Amount - 19],
LEFT(CONCAT('', SPACE(2)), 2) AS [Voluntary Cancellation Ind - 19],
LEFT(CONCAT('', SPACE(1)), 1) AS [Taveover Indicator - 19],
LEFT(CONCAT('', SPACE(9)), 9) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 20],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 20],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 20],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 20],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 20],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 20],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 20],
LEFT(CONCAT('', SPACE(1)), 1) AS [Enrollment Status - 20],
LEFT(CONCAT('', SPACE(8)), 8) AS [Benefit Amount - 20],
LEFT(CONCAT('', SPACE(2)), 2) AS [Voluntary Cancellation Ind - 20],
LEFT(CONCAT('', SPACE(8)), 8) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 21],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 21],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 21],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 21],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 21],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 21],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 21],
LEFT(CONCAT('', SPACE(1)), 1) AS [Enrollment Status - 21],
LEFT(CONCAT('', SPACE(3)), 3) AS [GPC Code],
LEFT(CONCAT('', SPACE(2)), 2) AS [Paypoint],
LEFT(CONCAT('', SPACE(3)), 3) AS [Payroll Deduction],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 22],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 22],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 22],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 22],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 22],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 22],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 22],
LEFT(CONCAT('', SPACE(1)), 1) AS [Enrollment Status - 22],
LEFT(CONCAT('', SPACE(2)), 2) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 23],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 23],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 23],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 23],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 23],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 23],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 23],
LEFT(CONCAT('', SPACE(1)), 1) AS [Enrollment Status - 23],
LEFT(CONCAT('', SPACE(2)), 2) AS [Voluntary Cancellation Ind - 23],
LEFT(CONCAT('', SPACE(1)), 1) AS [Takeover Indicator - 23],
LEFT(CONCAT('', SPACE(9)), 9) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 24],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 24],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 24],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 24],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 24],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 24],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 24],
LEFT(CONCAT('', SPACE(1)), 1) AS [Enrollment Status - 24],
LEFT(CONCAT('', SPACE(2)), 2) AS [Voluntary Cancellation Ind - 24],
LEFT(CONCAT('', SPACE(1)), 1) AS [Takeover Indicator - 24],
LEFT(CONCAT('', SPACE(9)), 9) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 25],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 25],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 25],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 25],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 25],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 25],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 25],
LEFT(CONCAT('', SPACE(1)), 1) AS [Enrollment Status - 25],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],

LEFT(CONCAT('', SPACE(95)), 95) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 27],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 27],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 27],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 27],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 27],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 27],
LEFT(CONCAT('', SPACE(1)), 1) AS [Status Code - 27],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 27],
LEFT(CONCAT('', SPACE(8)), 8) AS [Benefit Amount - 27],
LEFT(CONCAT('', SPACE(1)), 1) AS [Takeover Indicator - 27],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 28],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 28],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 28],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 28],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 28],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 28],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 28],
LEFT(CONCAT('', SPACE(1)), 1) AS [Enrollment Status - 28],
LEFT(CONCAT('', SPACE(8)), 8) AS [Benefit Amount - 28],
LEFT(CONCAT('', SPACE(2)), 2) AS [Voluntary Cancellation Ind - 28],
LEFT(CONCAT('', SPACE(1)), 1) AS [Takeover Indicator - 28],
LEFT(CONCAT('', SPACE(9)), 9) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 29],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 29],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 29],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 29],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 29],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 29],
LEFT(CONCAT('', SPACE(1)), 1) AS [Members Covered Code - 29],
LEFT(CONCAT('', SPACE(1)), 1) AS [Enrollment Status - 29],
LEFT(CONCAT('', SPACE(8)), 8) AS [Benefit Amount - 29],
LEFT(CONCAT('', SPACE(2)), 2) AS [Voluntary Cancellation Ind - 29],
LEFT(CONCAT('', SPACE(10)), 10) AS [Filler],

LEFT(CONCAT('', SPACE(2)), 2) AS [Coverage Code - 30],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Start Date - 30],
LEFT(CONCAT('', SPACE(8)), 8) AS [Coverage Stop Date - 30],
LEFT(CONCAT('', SPACE(7)), 7) AS [Group Number - 30],
LEFT(CONCAT('', SPACE(4)), 4) AS [Subcode - 30],
LEFT(CONCAT('', SPACE(4)), 4) AS [Branch - 30],
LEFT(CONCAT('', SPACE(2)), 2) AS [Work State - 30],
LEFT(CONCAT('', SPACE(1)), 1) AS [Job Status Code (full time/part time indicator)],
LEFT(CONCAT('', SPACE(8)), 8) AS [Job Status (full time/part time) As of Date ]

FROM [reporting_prodbhpmin].Cobra.vDependentCobraDemographics EDV

INNER JOIN [reporting_prodbhpmin].Cobra.vEmployeeCobraDemographics EV
 ON ev.SSN = edv.SSN

LEFT JOIN EMPLOYEE_ADDRESS_DETAIL_VIEW AD
	ON AD.IS_PRIMARY = 'Y'
	AND AD.TO_DATE = '9999-12-31'
	AND AD.SSN = EV.SSN

LEFT JOIN [reporting_prodbhpmin].Cobra.vDependentCobraElections DENTAL
	on ev.SSN = DENTAL.SSN
	AND DENTAL.BenefitId = 'DENTAL'
	AND DENTAL.PlanId NOT IN  ('WAIVE' , 'OPTOUT')
	AND (DENTAL.EndDate IS NULL
		OR (DENTAL.EndDate > getdate() - @lookback
			AND (DENTAL.EndDate = (SELECT MAX(EndDate) FROM [reporting_prodbhpmin].Cobra.vDependentCobraElections SUBCOV WHERE SUBCOV.DepSSN = EDV.DepSSN AND SUBCOV.BenefitId = DENTAL.BenefitId))))

LEFT JOIN EMPLOYEE_ATTRIBUTE_PROCESSED_VALUE_DETAIL_VIEW ATT1
	ON ATT1.SSN = EV.SSN
	AND ATT1.EMPLOYEE_ATTRIBUTE_ID = 'latesthiredate'
	AND ATT1.TO_DATE = '9999-12-31'

LEFT JOIN EMPLOYEE_ATTRIBUTE_PROCESSED_VALUE_DETAIL_VIEW ATT2
	ON ATT2.SSN = EV.SSN
	AND ATT2.EMPLOYEE_ATTRIBUTE_ID = 'CURRENTSALARY'
	AND ATT2.TO_DATE = '9999-12-31'

LEFT JOIN EMPLOYEE_ATTRIBUTE_PROCESSED_VALUE_DETAIL_VIEW ATT3
	ON ATT3.SSN = EV.SSN
	AND ATT3.EMPLOYEE_ATTRIBUTE_ID = ''
	AND ATT3.TO_DATE = '9999-12-31'

LEFT JOIN EMPLOYEE_ATTRIBUTE_PROCESSED_VALUE_DETAIL_VIEW ATT4
	ON ATT4.SSN = EV.SSN
	AND ATT4.EMPLOYEE_ATTRIBUTE_ID = ''
	AND ATT4.TO_DATE = '9999-12-31'

LEFT JOIN EMPLOYEE_ATTRIBUTE_PROCESSED_VALUE_DETAIL_VIEW ATT5
	ON ATT5.SSN = EV.SSN
	AND ATT5.EMPLOYEE_ATTRIBUTE_ID = ''
	AND ATT5.TO_DATE = '9999-12-31'

LEFT JOIN EMPLOYEE_ATTRIBUTE_PROCESSED_VALUE_DETAIL_VIEW ATT6
	ON ATT6.SSN = EV.SSN
	AND ATT6.EMPLOYEE_ATTRIBUTE_ID = ''
	AND ATT6.TO_DATE = '9999-12-31'

where 1=1
and (dental.ssn is not null
)
order by 3 asc, 1 desc, 4 asc </pre>`,

      essay: `<h3>Law School Writing Samples</h3><p>Essay examining the ethical implications of administrative discretion in correctional settings.</p>`+
	      `<iframe src="https://docs.google.com/gview?url=https://john-witt-portfolio.netlify.app/Reforming the Filibuster.pdf&embedded=true" width="100%" height="600px" style="border:none;"></iframe>`,

      nocturne: `<h3>Nocturne Verse</h3>
<p>
Nocturne Verse is a digital literary journal I created in 2025 to give voice to the quiet, brooding, and beautiful corners of creative writing. As someone drawn to both structure and story, I built the site from the ground up—designing its layout, writing its content, and publishing it independently.
</p>
<p>
The journal serves as a home for poetry and fiction that explore themes of loss, memory, transformation, and liminality. I wanted to create a space that welcomes both emerging and experienced writers who aren’t afraid to dwell in the moody, the mysterious, or the introspective.
</p>
<p>
Submissions are open, and the journal is still young. If you're a writer looking for a home for work that leans dark, philosophical, or emotionally resonant, I invite you to visit the site and contribute:
<br />
<a href="https://nocturne-verse.netlify.app" target="_blank">https://nocturne-verse.netlify.app</a>
</p>`,

      gallery_sample_1: `<h3>Movie Case Report - The Father</h3><iframe src="https://docs.google.com/gview?url=https://john-witt-portfolio.netlify.app/Movie Case Report - The Father.pdf&embedded=true" width="100%" height="600px" style="border:none;"></iframe>`,

      gallery_sample_2: `<h3>Case Study - Anxiety</h3><iframe src="https://docs.google.com/gview?url=https://john-witt-portfolio.netlify.app/Case Study - Anxiety.pdf&embedded=true" width="100%" height="600px" style="border:none;"></iframe>`,
      gallery_sample_3: `<h3>Case Study - Mood Disorders</h3><iframe src="https://docs.google.com/gview?url=https://john-witt-portfolio.netlify.app/Case Study - Mood Disorders.pdf&embedded=true" width="100%" height="600px" style="border:none;"></iframe>`,
       gallery_sample_4: `<h3>Reforming the Filibuster</h3><iframe src="https://docs.google.com/gview?url=https://john-witt-portfolio.netlify.app/Reforming the Filibuster.pdf&embedded=true" width="100%" height="600px" style="border:none;"></iframe>`,
       gallery_sample_5: `<h3>A Brief Analysis of Partisan Polarization</h3><iframe src="https://docs.google.com/gview?url=https://john-witt-portfolio.netlify.app/A Brief Analysis of Partisan Polarization.pdf&embedded=true" width="100%" height="600px" style="border:none;"></iframe>`,
       gallery_sample_6: `<h3>Case Brief - Johnson v SPC</h3><iframe src="https://docs.google.com/gview?url=https://john-witt-portfolio.netlify.app/Case Brief - Johnson v SPC.pdf&embedded=true" width="100%" height="600px" style="border:none;"></iframe>`,
       gallery_sample_7: `<h3>Case Brief - Johnson v SPC</h3><iframe src="https://docs.google.com/gview?url=https://john-witt-portfolio.netlify.app/Case Study - Mood Disorders.pdf&embedded=true" width="100%" height="600px" style="border:none;"></iframe>`
    };

    function openModal(key) {
      modalBody.innerHTML = content[key];
      modal.style.display = 'block';
    }

    function closeModal() {
      modal.style.display = 'none';
    }

    function showSection(id) {
      document.querySelectorAll('main section').forEach(s => s.classList.remove('active'));
      document.getElementById(id).classList.add('active');
    }

    window.onclick = function(event) {
      if (event.target === modal) {
        closeModal();
      }
    };
  </script>
</body>
</html>
